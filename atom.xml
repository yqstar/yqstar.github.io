<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>AndrewYq</title>
  
  
  <link href="https://yqstar.github.io/atom.xml" rel="self"/>
  
  <link href="https://yqstar.github.io/"/>
  <updated>2022-06-05T12:25:11.082Z</updated>
  <id>https://yqstar.github.io/</id>
  
  <author>
    <name>AndrewYq</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Pytorchç³»åˆ—è‡ªå­¦æ•™ç¨‹(4):æ·±åº¦å­¦ä¹ ä¹‹åºåˆ—æ¨¡å‹</title>
    <link href="https://yqstar.github.io/2022/06/01/Pytorch%E7%B3%BB%E5%88%97%E8%87%AA%E5%AD%A6%E6%95%99%E7%A8%8B-4-%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E4%B9%8B%E5%BA%8F%E5%88%97%E6%A8%A1%E5%9E%8B/"/>
    <id>https://yqstar.github.io/2022/06/01/Pytorch%E7%B3%BB%E5%88%97%E8%87%AA%E5%AD%A6%E6%95%99%E7%A8%8B-4-%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E4%B9%8B%E5%BA%8F%E5%88%97%E6%A8%A1%E5%9E%8B/</id>
    <published>2022-06-01T13:00:17.000Z</published>
    <updated>2022-06-05T12:25:11.082Z</updated>
    
    <content type="html"><![CDATA[<h2 id="åºåˆ—æ¨¡å‹ä»‹ç»"><a href="#åºåˆ—æ¨¡å‹ä»‹ç»" class="headerlink" title="åºåˆ—æ¨¡å‹ä»‹ç»"></a>åºåˆ—æ¨¡å‹ä»‹ç»</h2><p>å¾ªç¯ç¥ç»ç½‘ç»œï¼ˆRecurrent Neural Networkï¼ŒRNNï¼‰æ˜¯ä¸€ç§ç”¨äºå¤„ç†åºåˆ—æ•°æ®çš„ç¥ç»ç½‘ç»œã€‚ç›¸æ¯”ä¸€èˆ¬çš„ç¥ç»ç½‘ç»œæ¥è¯´ï¼Œä»–èƒ½å¤Ÿå¤„ç†åºåˆ—å˜åŒ–çš„æ•°æ®ã€‚æ¯”å¦‚æŸä¸ªå•è¯çš„æ„æ€ä¼šå› ä¸ºä¸Šæ–‡æåˆ°çš„å†…å®¹ä¸åŒè€Œæœ‰ä¸åŒçš„å«ä¹‰ï¼ŒRNNå°±èƒ½å¤Ÿå¾ˆå¥½åœ°è§£å†³è¿™ç±»é—®é¢˜ã€‚<br>RNNä¹Ÿå¯ä»¥å †å åœ¨ä¸€èµ·ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå †ä¸­çš„æ¯ä¸ªRNNéƒ½æœ‰è‡ªå·±çš„æƒé‡çŸ©é˜µã€‚å› æ­¤ï¼Œæƒé‡çŸ©é˜µåœ¨æ°´å¹³è½´ï¼ˆæ—¶é—´è½´ï¼‰ä¸Šå…±äº«ï¼Œè€Œä¸æ˜¯åœ¨å‚ç›´è½´ï¼ˆRNNçš„æ•°é‡ï¼‰ä¸Šå…±äº«ã€‚</p><p><img src="/2022/06/01/Pytorch%E7%B3%BB%E5%88%97%E8%87%AA%E5%AD%A6%E6%95%99%E7%A8%8B-4-%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E4%B9%8B%E5%BA%8F%E5%88%97%E6%A8%A1%E5%9E%8B/_posts/Pytorchç³»åˆ—è‡ªå­¦æ•™ç¨‹-4-æ·±åº¦å­¦ä¹ ä¹‹åºåˆ—æ¨¡å‹/rnn.jpg" alt="rnn"></p><p>å› RNNæ¨¡å‹è®­ç»ƒé‡‡ç”¨BPTTç®—æ³•(BackPropagation Through Time)ï¼Œå¯¼è‡´RNNæœ‰ä¸€ä¸ªä¸»è¦çš„ç¼ºç‚¹ï¼Œå³æ‰€è°“çš„æ¢¯åº¦æ¶ˆå¤±å’Œæ¢¯åº¦çˆ†ç‚¸ï¼Œè€Œæ¢¯åº¦çˆ†ç‚¸é—®é¢˜å¯ä»¥é€šè¿‡æ¢¯åº¦è£å‰ªï¼Œå»æŠ‘åˆ¶ï¼Œæ¢¯åº¦æ¶ˆå¤±çš„é—®é¢˜æ˜¯éšç€åå‘ä¼ æ’­ï¼Œæ¢¯åº¦è¶Šæ¥è¶Šå°ï¼Œåœ¨è¿™äº›ç½‘ç»œä¸­ï¼Œéšç€æ—¶é—´æ­¥é•¿çš„å¢åŠ ï¼Œåå‘ä¼ æ’­ä½¿æ¢¯åº¦å˜å¾—è¶Šæ¥è¶Šå°ï¼Œå¯¼è‡´æ¢¯åº¦æ¶ˆå¤±ã€‚è¿›è€Œå¯¼è‡´RNNé•¿æœŸä¾èµ–é—®é¢˜ã€‚<br>æ³¨æ„ï¼Œè£å‰ªä»…é™åˆ¶æ¢¯åº¦çš„å¤§å°ï¼Œè€Œä¸é™åˆ¶å…¶æ–¹å‘ã€‚æ‰€ä»¥ï¼Œå­¦ä¹ ä»ç„¶æœç€æ­£ç¡®çš„æ–¹å‘å‰è¿›ã€‚</p><p><a class="link" href="https://www.zhihu.com/question/279046805/answer/1153623199">https://www.zhihu.com/question/279046805/answer/1153623199<i class="fas fa-external-link-alt"></i></a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;åºåˆ—æ¨¡å‹ä»‹ç»&quot;&gt;&lt;a href=&quot;#åºåˆ—æ¨¡å‹ä»‹ç»&quot; class=&quot;headerlink&quot; title=&quot;åºåˆ—æ¨¡å‹ä»‹ç»&quot;&gt;&lt;/a&gt;åºåˆ—æ¨¡å‹ä»‹ç»&lt;/h2&gt;&lt;p&gt;å¾ªç¯ç¥ç»ç½‘ç»œï¼ˆRecurrent Neural Networkï¼ŒRNNï¼‰æ˜¯ä¸€ç§ç”¨äºå¤„ç†åºåˆ—æ•°æ®çš„ç¥ç»ç½‘ç»œã€‚ç›¸</summary>
      
    
    
    
    
    <category term="Pytorch_Tutorial" scheme="https://yqstar.github.io/tags/Pytorch-Tutorial/"/>
    
  </entry>
  
  <entry>
    <title>Pytorchç³»åˆ—è‡ªå­¦æ•™ç¨‹(3):æ·±åº¦å­¦ä¹ ä¹‹Mnistå›¾åƒåˆ†ç±»TorchServeéƒ¨ç½²</title>
    <link href="https://yqstar.github.io/2022/05/15/Pytorch%E7%B3%BB%E5%88%97%E8%87%AA%E5%AD%A6%E6%95%99%E7%A8%8B-3-%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E4%B9%8BMnist%E5%9B%BE%E5%83%8F%E5%88%86%E7%B1%BBTorchServe%E9%83%A8%E7%BD%B2/"/>
    <id>https://yqstar.github.io/2022/05/15/Pytorch%E7%B3%BB%E5%88%97%E8%87%AA%E5%AD%A6%E6%95%99%E7%A8%8B-3-%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E4%B9%8BMnist%E5%9B%BE%E5%83%8F%E5%88%86%E7%B1%BBTorchServe%E9%83%A8%E7%BD%B2/</id>
    <published>2022-05-15T10:05:23.000Z</published>
    <updated>2022-06-07T15:46:55.085Z</updated>
    
    <content type="html"><![CDATA[<h2 id="éƒ¨ç½²ç®€ä»‹"><a href="#éƒ¨ç½²ç®€ä»‹" class="headerlink" title="éƒ¨ç½²ç®€ä»‹"></a>éƒ¨ç½²ç®€ä»‹</h2><p>å­¦ä¹ åº”è¯¥èƒ½å¤Ÿç»ˆç«¯è½åœ°ï¼Œè¿™æ ·å¯¹äºä¸ªäººå¸¦æ¥çš„æ»¡è¶³æ‰æ˜¯å·¨å¤§çš„ï¼Œæ‰ä¼šæ˜¯æœ‰ä»·å€¼çš„ã€‚æ‰€ä»¥å•çº¯åœ°è·‘äº†Demoæ¨¡å‹ï¼Œå¯¹è‡ªå·±çš„æŠ€æœ¯æå‡è¿˜æ˜¯å¾ˆå¤§çš„ï¼Œä½†æ˜¯å¦‚ä½•æŠŠæŠ€æœ¯è¾“å‡ºä¹Ÿæ˜¯å¿…è¦çš„ã€‚</p><p>é‚£ä¹ˆä½¿ç”¨ <em>PyTorch</em> è®­ç»ƒå¥½ Demo æ¨¡å‹ï¼Œå¦‚ä½•éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒæä¾›ç”¨äºæä¾›æ¨¡å‹æœåŠ¡å‘¢ï¼Ÿéƒ¨ç½²å½¢å¼æ˜¯éå¸¸å¤šæ ·çš„ï¼Œæœ¬ç« å†…å®¹ä¸»è¦ä»‹ç»çš„æ˜¯æ˜¯å¤§å‚å‡ºå“çš„TorchServeç”¨äºéƒ¨ç½²Pytorchçš„æ¨¡å‹ã€‚</p><p>æ¨¡å‹æœåŠ¡æ˜¯åœ¨ç³»ç»Ÿä¸­æ”¾ç½®ç»è¿‡è®­ç»ƒçš„æœºå™¨å­¦ä¹ æ¨¡å‹çš„è¿‡ç¨‹ï¼Œä»¥ä¾¿å®ƒå¯ä»¥æ¥å—æ–°çš„è¾“å…¥å¹¶å°†æ¨ç†è¿”å›ç»™ç³»ç»Ÿã€‚</p><h2 id="TorchServeç®€ä»‹"><a href="#TorchServeç®€ä»‹" class="headerlink" title="TorchServeç®€ä»‹"></a>TorchServeç®€ä»‹</h2><p>Torchserve æ˜¯ PyTorch çš„é¦–é€‰æ¨¡å‹æœåŠ¡è§£å†³æ–¹æ¡ˆã€‚å®ƒå…è®¸æ‚¨ä¸ºæ‚¨çš„æ¨¡å‹å…¬å¼€ä¸€ä¸ª Web APIï¼Œå¯ä»¥ç›´æ¥è®¿é—®æˆ–é€šè¿‡æ‚¨çš„åº”ç”¨ç¨‹åºè®¿é—®ã€‚</p><blockquote><p>TorchServe is a performant, flexible and easy to use tool for serving PyTorch eager mode and torschripted models.</p></blockquote><p>ä»ä¸Šé¢çš„å®˜ç½‘ä»‹ç»çš„å†…å®¹å¯ä»¥çœ‹å‡ºï¼šTorchServeçš„ç‰¹ç‚¹æ˜¯æ€§èƒ½å¥½ã€çµæ´»æ€§å¥½ã€æ˜“ä½¿ç”¨çš„å·¥å…·ï¼Œå…¶æ¬¡é¢å‘éƒ¨ç½²çš„æ¨¡å‹æ˜¯Pytorchçš„Eageræ¨¡å¼å’ŒScriptæ¨¡å¼çš„æ¨¡å‹ã€‚</p><p>TorchServeæ˜¯ç”±AWSå’ŒFacebookåˆä½œå¼€å‘çš„PyTorchæ¨¡å‹æœåŠ¡åº“ï¼Œæ˜¯ <a class="link" href="https://pytorch.org/serve/index.html">PyTorchå¼€æºé¡¹ç›®<i class="fas fa-external-link-alt"></i></a> éƒ¨åˆ†ã€‚</p><p>å€ŸåŠ©TorchServeï¼ŒPyTorchç”¨æˆ·å¯ä»¥æ›´å¿«åœ°å°†å…¶æ¨¡å‹åº”ç”¨äºç”Ÿäº§ï¼Œè€Œæ— éœ€ç¼–å†™è‡ªå®šä¹‰ä»£ç ï¼šé™¤äº†æä¾›ä½å»¶è¿Ÿé¢„æµ‹APIä¹‹å¤–ï¼ŒTorchServeè¿˜ä¸ºä¸€äº›æœ€å¸¸è§çš„åº”ç”¨ç¨‹åºåµŒå…¥äº†é»˜è®¤å¤„ç†ç¨‹åºï¼Œä¾‹å¦‚ç›®æ ‡æ£€æµ‹å’Œæ–‡æœ¬åˆ†ç±»ã€‚æ­¤å¤–ï¼ŒTorchServeåŒ…æ‹¬å¤šæ¨¡å‹æœåŠ¡ã€ç”¨äºA/B æµ‹è¯•çš„æ¨¡å‹ç‰ˆæœ¬æ§åˆ¶ã€ç›‘è§†æŒ‡æ ‡ä»¥åŠç”¨äºåº”ç”¨ç¨‹åºé›†æˆçš„RESTfulç«¯ç‚¹ã€‚å¦‚ä½ æ‰€æ–™ï¼ŒTorchServeæ”¯æŒä»»ä½•æœºå™¨å­¦ä¹ ç¯å¢ƒï¼ŒåŒ…æ‹¬Amazon SageMakerã€å®¹å™¨æœåŠ¡å’ŒAmazon Elastic Compute Cloudã€‚</p><p>TorchServeæ¡†æ¶ä¸»è¦åˆ†ä¸ºå››ä¸ªéƒ¨åˆ†ï¼šFrontendæ˜¯TorchServeçš„è¯·æ±‚å’Œå“åº”çš„å¤„ç†éƒ¨åˆ†ï¼›Worker Process æŒ‡çš„æ˜¯ä¸€ç»„è¿è¡Œçš„æ¨¡å‹å®ä¾‹ï¼Œå¯ä»¥ç”±ç®¡ç†APIè®¾å®šè¿è¡Œçš„æ•°é‡ï¼›Model Storeæ˜¯æ¨¡å‹å­˜å‚¨åŠ è½½çš„åœ°æ–¹ï¼›Backendç”¨äºç®¡ç†Worker Processã€‚</p><p><img src="/2022/05/15/Pytorch%E7%B3%BB%E5%88%97%E8%87%AA%E5%AD%A6%E6%95%99%E7%A8%8B-3-%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E4%B9%8BMnist%E5%9B%BE%E5%83%8F%E5%88%86%E7%B1%BBTorchServe%E9%83%A8%E7%BD%B2/_posts/Pytorchç³»åˆ—è‡ªå­¦æ•™ç¨‹-3-æ·±åº¦å­¦ä¹ ä¹‹Mnistå›¾åƒåˆ†ç±»TorchServeéƒ¨ç½²/ts_frame.png" alt="ts_frame"></p><h2 id="ç¯å¢ƒå®‰è£…"><a href="#ç¯å¢ƒå®‰è£…" class="headerlink" title="ç¯å¢ƒå®‰è£…"></a>ç¯å¢ƒå®‰è£…</h2><p>æˆ‘è¿™è¾¹ä½¿ç”¨çš„æ˜¯Windows11ï¼ŒWSL2ç¯å¢ƒç³»ç»Ÿè¿›è¡Œéƒ¨ç½²ä½œä¸šã€‚</p><ul><li>å®‰è£… JDK11</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install openjdk-11-jdk</span><br></pre></td></tr></table></figure><ul><li>å®‰è£…ä¾èµ–</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pip install torch torchtext torchvision sentencepiece psutil future</span><br><span class="line">pip install torchserve torch-model-archiver</span><br></pre></td></tr></table></figure><p>TorchServeæºå®‰è£…</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/pytorch/serve.git</span><br><span class="line"><span class="built_in">cd</span> serve</span><br><span class="line"></span><br><span class="line">./ts_scripts/setup_wsl_ubuntu</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$HOME</span>/.local/bin:<span class="variable">$PATH</span></span><br><span class="line">python ./ts_scripts/install_from_src.py</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;export PATH=$HOME/.local/bin:$PATH&#x27;</span> &gt;&gt; ~/.bashrc</span><br><span class="line"><span class="built_in">source</span> ~/.bashrc</span><br></pre></td></tr></table></figure><h2 id="æ¨¡å‹æ‰“åŒ…"><a href="#æ¨¡å‹æ‰“åŒ…" class="headerlink" title="æ¨¡å‹æ‰“åŒ…"></a>æ¨¡å‹æ‰“åŒ…</h2><p>TorchServe çš„ä¸€ä¸ªå…³é”®ç‰¹æ€§æ˜¯èƒ½å¤Ÿå°†æ‰€æœ‰æ¨¡å‹å·¥ä»¶æ‰“åŒ…åˆ°å•ä¸ªæ¨¡å‹å­˜æ¡£æ–‡ä»¶ä¸­ã€‚å®ƒæ˜¯ä¸€ä¸ªå•ç‹¬çš„å‘½ä»¤è¡Œç•Œé¢ (CLI)ï¼Œtorch-model-archiverï¼Œå¯ä»¥ä½¿ç”¨ state_dict è·å–æ¨¡å‹æ£€æŸ¥ç‚¹æˆ–æ¨¡å‹å®šä¹‰æ–‡ä»¶ï¼Œå¹¶å°†å®ƒä»¬æ‰“åŒ…æˆ .mar æ–‡ä»¶ã€‚ ç„¶åï¼Œä»»ä½•ä½¿ç”¨ TorchServe çš„äººéƒ½å¯ä»¥é‡æ–°åˆ†å‘å’Œæä¾›è¯¥æ–‡ä»¶ã€‚å®ƒåŒ…å«ä»¥ä¸‹æ¨¡å‹å·¥ä»¶ï¼šåœ¨ torchscript æˆ–æ¨¡å‹å®šä¹‰æ–‡ä»¶çš„æƒ…å†µä¸‹çš„æ¨¡å‹æ£€æŸ¥ç‚¹æ–‡ä»¶å’Œåœ¨æ€¥åˆ‡æ¨¡å¼çš„æƒ…å†µä¸‹çš„ state_dict æ–‡ä»¶ï¼Œä»¥åŠæœåŠ¡æ¨¡å‹å¯èƒ½éœ€è¦çš„å…¶ä»–å¯é€‰èµ„äº§ã€‚ CLI åˆ›å»ºä¸€ä¸ª .mar æ–‡ä»¶ï¼ŒTorchServe çš„æœåŠ¡å™¨ CLI ä½¿ç”¨è¯¥æ–‡ä»¶ä¸ºæ¨¡å‹æä¾›æœåŠ¡ã€‚</p><p>torch-model-archiver å‘½ä»¤æ¥æ‰“åŒ…æ¨¡å‹ï¼Œéœ€è¦æä¾›ä»¥ä¸‹ä¸‰ä¸ªæ–‡ä»¶ã€‚</p><p>ç¬¬ 1 æ­¥ï¼šåˆ›å»ºä¸€ä¸ªæ–°çš„æ¨¡å‹æ¶æ„æ–‡ä»¶ï¼Œå…¶ä¸­åŒ…å«ä» torch.nn.modules æ‰©å±•çš„æ¨¡å‹ç±»ã€‚ åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº† mnist æ¨¡å‹æ–‡ä»¶ mnist_model.py æ–‡ä»¶ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">from</span> torch <span class="keyword">import</span> nn</span><br><span class="line"><span class="keyword">import</span> torch.nn.functional <span class="keyword">as</span> F</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ„å»ºç½‘ç»œ</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MnistClassificationNet</span>(nn.Module):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">super</span>().__init__()</span><br><span class="line">        self.conv1 = nn.Conv2d(in_channels=<span class="number">1</span>, out_channels=<span class="number">32</span>, kernel_size=<span class="number">3</span>)</span><br><span class="line">        self.conv2 = nn.Conv2d(in_channels=<span class="number">32</span>, out_channels=<span class="number">64</span>, kernel_size=<span class="number">3</span>)</span><br><span class="line">        self.max_pool2d = nn.MaxPool2d(kernel_size=<span class="number">2</span>)</span><br><span class="line">        self.dropout = nn.Dropout2d(p=<span class="number">0.25</span>)</span><br><span class="line">        <span class="comment"># self.relu = nn.ReLU()</span></span><br><span class="line">        self.fc1 = nn.Linear(in_features=<span class="number">9216</span>, out_features=<span class="number">128</span>)</span><br><span class="line">        self.fc2 = nn.Linear(in_features=<span class="number">128</span>, out_features=<span class="number">10</span>)</span><br><span class="line">        self.log_softmax = nn.LogSoftmax(dim=<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, x</span>):</span><br><span class="line">        x = self.conv1(x)</span><br><span class="line">        x = F.relu(x)</span><br><span class="line">        x = self.conv2(x)</span><br><span class="line">        x = F.relu(x)</span><br><span class="line">        x= self.max_pool2d(x)</span><br><span class="line">        x = self.dropout(x)</span><br><span class="line">        x = x.view(-<span class="number">1</span>, <span class="number">9216</span>)</span><br><span class="line">        x = self.fc1(x)</span><br><span class="line">        x = F.relu(x)</span><br><span class="line">        x = self.fc2(x)</span><br><span class="line">        x= self.log_softmax(x)</span><br><span class="line">        <span class="keyword">return</span> x</span><br></pre></td></tr></table></figure><p>ç¬¬ 2 æ­¥ï¼šä½¿ç”¨ <a href="https://yqstar.github.io/2022/05/11/Pytorchç³»åˆ—è‡ªå­¦æ•™ç¨‹-2-æ·±åº¦å­¦ä¹ â€œHello-Worldâ€ä¹‹Mnistå›¾åƒåˆ†ç±»/">mnist_sd</a> è®­ç»ƒ MNIST æ•°å­—è¯†åˆ«æ¨¡å‹å¹¶ä¿å­˜æ¨¡å‹çš„çŠ¶æ€å­—å…¸ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">torch.save(model.state_dict(), <span class="string">&quot;./checkpoints/model_pth/mnist_sd.pt&quot;</span>)</span><br></pre></td></tr></table></figure><p>ç¬¬ 3 æ­¥ï¼šç¼–å†™è‡ªå®šä¹‰å¤„ç†ç¨‹åºä»¥åœ¨æ‚¨çš„æ¨¡å‹ä¸Šè¿è¡Œæ¨ç†ã€‚ åœ¨æ­¤ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬æ·»åŠ äº†ä¸€ä¸ª mnist_handler.py æ–‡ä»¶ï¼Œå®ƒä½¿ç”¨ä¸Šè¿°æ¨¡å‹å¯¹è¾“å…¥ç°åº¦å›¾åƒè¿›è¡Œæ¨ç†å¹¶è¯†åˆ«å›¾åƒä¸­çš„æ•°å­—ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> torchvision <span class="keyword">import</span> transforms</span><br><span class="line"><span class="keyword">from</span> ts.torch_handler.image_classifier <span class="keyword">import</span> ImageClassifier</span><br><span class="line"><span class="keyword">from</span> torch.profiler <span class="keyword">import</span> ProfilerActivity</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MNISTDigitClassifier</span>(<span class="title class_ inherited__">ImageClassifier</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    MNISTDigitClassifier handler class. This handler extends class ImageClassifier from image_classifier.py, a</span></span><br><span class="line"><span class="string">    default handler. This handler takes an image and returns the number in that image.</span></span><br><span class="line"><span class="string">    Here method postprocess() has been overridden while others are reused from parent class.</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    image_processing = transforms.Compose([</span><br><span class="line">        transforms.ToTensor()</span><br><span class="line">        <span class="comment"># transforms.Normalize((0.1307,), (0.3081,))</span></span><br><span class="line">    ])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">super</span>(MNISTDigitClassifier, self).__init__()</span><br><span class="line">        self.profiler_args = &#123;</span><br><span class="line">            <span class="string">&quot;activities&quot;</span> : [ProfilerActivity.CPU],</span><br><span class="line">            <span class="string">&quot;record_shapes&quot;</span>: <span class="literal">True</span>,</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">postprocess</span>(<span class="params">self, data</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;The post process of MNIST converts the predicted output response to a label.</span></span><br><span class="line"><span class="string">        Args:</span></span><br><span class="line"><span class="string">            data (list): The predicted output from the Inference with probabilities is passed</span></span><br><span class="line"><span class="string">            to the post-process function</span></span><br><span class="line"><span class="string">        Returns:</span></span><br><span class="line"><span class="string">            list : A list of dictionaries with predictions and explanations is returned</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">return</span> data.argmax(<span class="number">1</span>).tolist()</span><br><span class="line">        <span class="comment"># return data.tolist()</span></span><br></pre></td></tr></table></figure><p>ç¬¬ 4 æ­¥ï¼šä½¿ç”¨ torch-model-archiver ç¨‹åºåˆ›å»ºä¸€ä¸ª Torch æ¨¡å‹å­˜æ¡£ä»¥å­˜æ¡£ä¸Šè¿°æ–‡ä»¶ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">$ torch-model-archiver -h</span><br><span class="line">usage: torch-model-archiver [-h] --model-name MODEL_NAME  --version MODEL_VERSION_NUMBER</span><br><span class="line">                      --model-file MODEL_FILE_PATH --serialized-file MODEL_SERIALIZED_PATH</span><br><span class="line">                      --handler HANDLER [--runtime &#123;python,python2,python3&#125;]</span><br><span class="line">                      [--export-path EXPORT_PATH] [-f] [--requirements-file]</span><br><span class="line"></span><br><span class="line">Model Archiver Tool</span><br><span class="line"></span><br><span class="line">optional arguments:</span><br><span class="line">  -h, --<span class="built_in">help</span>            show this <span class="built_in">help</span> message and <span class="built_in">exit</span></span><br><span class="line">  --model-name MODEL_NAME</span><br><span class="line">                        Exported model name. Exported file will be named as</span><br><span class="line">                        model-name.mar and saved <span class="keyword">in</span> current working directory</span><br><span class="line">                        <span class="keyword">if</span> no --export-path is specified, <span class="keyword">else</span> it will be</span><br><span class="line">                        saved under the <span class="built_in">export</span> path</span><br><span class="line">  --serialized-file SERIALIZED_FILE</span><br><span class="line">                        Path to .pt or .pth file containing state_dict <span class="keyword">in</span></span><br><span class="line">                        <span class="keyword">case</span> of eager mode or an executable ScriptModule</span><br><span class="line">                        <span class="keyword">in</span> <span class="keyword">case</span> of TorchScript.</span><br><span class="line">  --model-file MODEL_FILE</span><br><span class="line">                        Path to python file containing model architecture.</span><br><span class="line">                        This parameter is mandatory <span class="keyword">for</span> eager mode models.</span><br><span class="line">                        The model architecture file must contain only one</span><br><span class="line">                        class definition extended from torch.nn.modules.</span><br><span class="line">  --handler HANDLER     TorchServe<span class="string">&#x27;s default handler name  or handler python</span></span><br><span class="line"><span class="string">                        file path to handle custom TorchServe inference logic.</span></span><br><span class="line"><span class="string">  --extra-files EXTRA_FILES</span></span><br><span class="line"><span class="string">                        Comma separated path to extra dependency files.</span></span><br><span class="line"><span class="string">  --runtime &#123;python,python2,python3&#125;</span></span><br><span class="line"><span class="string">                        The runtime specifies which language to run your</span></span><br><span class="line"><span class="string">                        inference code on. The default runtime is</span></span><br><span class="line"><span class="string">                        RuntimeType.PYTHON. At the present moment we support</span></span><br><span class="line"><span class="string">                        the following runtimes python, python2, python3</span></span><br><span class="line"><span class="string">  --export-path EXPORT_PATH</span></span><br><span class="line"><span class="string">                        Path where the exported .mar file will be saved. This</span></span><br><span class="line"><span class="string">                        is an optional parameter. If --export-path is not</span></span><br><span class="line"><span class="string">                        specified, the file will be saved in the current</span></span><br><span class="line"><span class="string">                        working directory.</span></span><br><span class="line"><span class="string">  --archive-format &#123;tgz,default&#125;</span></span><br><span class="line"><span class="string">                        The format in which the model artifacts are archived.</span></span><br><span class="line"><span class="string">                        &quot;tgz&quot;: This creates the model-archive in &lt;model-name&gt;.tar.gz format.</span></span><br><span class="line"><span class="string">                        If platform hosting requires model-artifacts to be in &quot;.tar.gz&quot;</span></span><br><span class="line"><span class="string">                        use this option.</span></span><br><span class="line"><span class="string">                        &quot;no-archive&quot;: This option creates an non-archived version of model artifacts</span></span><br><span class="line"><span class="string">                        at &quot;export-path/&#123;model-name&#125;&quot; location. As a result of this choice,</span></span><br><span class="line"><span class="string">                        MANIFEST file will be created at &quot;export-path/&#123;model-name&#125;&quot; location</span></span><br><span class="line"><span class="string">                        without archiving these model files</span></span><br><span class="line"><span class="string">                        &quot;default&quot;: This creates the model-archive in &lt;model-name&gt;.mar format.</span></span><br><span class="line"><span class="string">                        This is the default archiving format. Models archived in this format</span></span><br><span class="line"><span class="string">                        will be readily hostable on TorchServe.</span></span><br><span class="line"><span class="string">  -f, --force           When the -f or --force flag is specified, an existing</span></span><br><span class="line"><span class="string">                        .mar file with same name as that provided in --model-</span></span><br><span class="line"><span class="string">                        name in the path specified by --export-path will</span></span><br><span class="line"><span class="string">                        overwritten</span></span><br><span class="line"><span class="string">  -v, --version         Model&#x27;</span>s version.</span><br><span class="line">  -r, --requirements-file</span><br><span class="line">                        Path to requirements.txt file containing a list of model specific python</span><br><span class="line">                        packages to be installed by TorchServe <span class="keyword">for</span> seamless model serving.</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">torch-model-archiver --model-name mnist --version 1.0 --model-file mnist_model.py --serialized-file mnist_sd.pt --export-path ./model_store --handler mnist_handler.py -f</span><br></pre></td></tr></table></figure><h2 id="æ¨¡å‹éƒ¨ç½²"><a href="#æ¨¡å‹éƒ¨ç½²" class="headerlink" title="æ¨¡å‹éƒ¨ç½²"></a>æ¨¡å‹éƒ¨ç½²</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">$ torchserve --<span class="built_in">help</span></span><br><span class="line">usage: torchserve [-h] [-v | --version]</span><br><span class="line">                          [--start]</span><br><span class="line">                          [--stop]</span><br><span class="line">                          [--ts-config TS_CONFIG]</span><br><span class="line">                          [--model-store MODEL_STORE]</span><br><span class="line">                          [--workflow-store WORKFLOW_STORE]</span><br><span class="line">                          [--models MODEL_PATH1 MODEL_NAME=MODEL_PATH2... [MODEL_PATH1 MODEL_NAME=MODEL_PATH2... ...]]</span><br><span class="line">                          [--log-config LOG_CONFIG]</span><br><span class="line"></span><br><span class="line">torchserve</span><br><span class="line"></span><br><span class="line">mandatory arguments:</span><br><span class="line">  --model-store MODEL_STORE</span><br><span class="line">                        Model store location <span class="built_in">where</span> models can be loaded</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">optional arguments:</span><br><span class="line">  -h, --<span class="built_in">help</span>            show this <span class="built_in">help</span> message and <span class="built_in">exit</span></span><br><span class="line">  -v, --version         Return TorchServe Version</span><br><span class="line">  --start               Start the model-server</span><br><span class="line">  --stop                Stop the model-server</span><br><span class="line">  --ts-config TS_CONFIG</span><br><span class="line">                        Configuration file <span class="keyword">for</span> TorchServe</span><br><span class="line"></span><br><span class="line">  --models MODEL_PATH1 MODEL_NAME=MODEL_PATH2... [MODEL_PATH1 MODEL_NAME=MODEL_PATH2... ...]</span><br><span class="line">                        Models to be loaded using [model_name=]model_location</span><br><span class="line">                        format. Location can be a HTTP URL, a model archive</span><br><span class="line">                        file or directory contains model archive files <span class="keyword">in</span></span><br><span class="line">                        MODEL_STORE.</span><br><span class="line">  --log-config LOG_CONFIG</span><br><span class="line">                        Log4j configuration file <span class="keyword">for</span> TorchServe</span><br><span class="line">  --ncs, --no-config-snapshots         </span><br><span class="line">                        Disable snapshot feature</span><br><span class="line">  --workflow-store WORKFLOW_STORE</span><br><span class="line">                        Workflow store location <span class="built_in">where</span> workflow can be loaded. Defaults to model-store</span><br></pre></td></tr></table></figure><h3 id="å¯åŠ¨torchserveæœåŠ¡"><a href="#å¯åŠ¨torchserveæœåŠ¡" class="headerlink" title="å¯åŠ¨torchserveæœåŠ¡"></a>å¯åŠ¨torchserveæœåŠ¡</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">torchserve --start --ncs --model-store model_store --models mnist.mar</span><br></pre></td></tr></table></figure><p>æ¨¡å‹å¯åŠ¨æ—¥å¿—å¦‚ä¸‹æˆªå›¾ï¼š</p><p><img src="/2022/05/15/Pytorch%E7%B3%BB%E5%88%97%E8%87%AA%E5%AD%A6%E6%95%99%E7%A8%8B-3-%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E4%B9%8BMnist%E5%9B%BE%E5%83%8F%E5%88%86%E7%B1%BBTorchServe%E9%83%A8%E7%BD%B2/_posts/Pytorchç³»åˆ—è‡ªå­¦æ•™ç¨‹-3-æ·±åº¦å­¦ä¹ ä¹‹Mnistå›¾åƒåˆ†ç±»TorchServeéƒ¨ç½²/ts_start.png" alt="ts_start"></p><h3 id="æ¨ç†å¥åº·æ£€æŸ¥API"><a href="#æ¨ç†å¥åº·æ£€æŸ¥API" class="headerlink" title="æ¨ç†å¥åº·æ£€æŸ¥API"></a>æ¨ç†å¥åº·æ£€æŸ¥API</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl http://localhost:8080/ping</span><br></pre></td></tr></table></figure><p>å¦‚æœserveræ­£å¸¸è¿è¡Œ, å“åº”ä¼šå¦‚æˆªå›¾æ‰€ç¤ºï¼š</p><p><img src="/2022/05/15/Pytorch%E7%B3%BB%E5%88%97%E8%87%AA%E5%AD%A6%E6%95%99%E7%A8%8B-3-%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E4%B9%8BMnist%E5%9B%BE%E5%83%8F%E5%88%86%E7%B1%BBTorchServe%E9%83%A8%E7%BD%B2/_posts/Pytorchç³»åˆ—è‡ªå­¦æ•™ç¨‹-3-æ·±åº¦å­¦ä¹ ä¹‹Mnistå›¾åƒåˆ†ç±»TorchServeéƒ¨ç½²/ts_ping.png" alt="ts_ping"></p><h3 id="æ¨ç†"><a href="#æ¨ç†" class="headerlink" title="æ¨ç†"></a>æ¨ç†</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl http://127.0.0.1:8080/predictions/mnist -T ./data/test.png</span><br></pre></td></tr></table></figure><p>test.pngä¸ºæ•°å­—ä¸º0çš„å›¾ç‰‡ï¼Œé€šè¿‡ä¸Šè¿°çš„è°ƒç”¨æ¨ç†ï¼Œå¯ä»¥çœ‹å‡ºç»“æœæ˜¯èƒ½æ­£å¸¸è¿”å›çš„ï¼Œæ˜¯å¯ä»¥ä½œä¸ºä¸‹æ¸¸åº”ç”¨è°ƒç”¨ã€‚</p><p><img src="/2022/05/15/Pytorch%E7%B3%BB%E5%88%97%E8%87%AA%E5%AD%A6%E6%95%99%E7%A8%8B-3-%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E4%B9%8BMnist%E5%9B%BE%E5%83%8F%E5%88%86%E7%B1%BBTorchServe%E9%83%A8%E7%BD%B2/_posts/Pytorchç³»åˆ—è‡ªå­¦æ•™ç¨‹-3-æ·±åº¦å­¦ä¹ ä¹‹Mnistå›¾åƒåˆ†ç±»TorchServeéƒ¨ç½²/ts_infer.png" alt="ts_infer"></p><h3 id="åœæ­¢torchserveæœåŠ¡"><a href="#åœæ­¢torchserveæœåŠ¡" class="headerlink" title="åœæ­¢torchserveæœåŠ¡"></a>åœæ­¢torchserveæœåŠ¡</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">torchserve --start</span><br></pre></td></tr></table></figure><h2 id="æ¢ç´¢"><a href="#æ¢ç´¢" class="headerlink" title="æ¢ç´¢"></a>æ¢ç´¢</h2><p><a class="link" href="https://github.com/yqstar/Awesome_Pytorch_Tutorial/tree/master/Pytorch_Lesson3">å®Œæ•´ä»£ç <i class="fas fa-external-link-alt"></i></a>å·²ä¸Šä¼ Githubï¼Œæœ‰éœ€è¦çš„å¯ä»¥è‡ªè¡Œä¸‹è½½ä»£ç ï¼Œå¦‚æœå¯¹ä½ æœ‰å¸®åŠ©ï¼Œè¯·Starï¼Œå“ˆå“ˆå“ˆå“ˆï¼</p><p>åˆ°æ­¤ä¸ºæ­¢ï¼Œå·²ç»å¯ä»¥ä½¿ç”¨è‡ªå·±æ•°æ®ç©è€å„ç§Demoï¼Œå¿«ï¼ˆè‹¦ï¼‰ä¹ï¼ˆé€¼ï¼‰åœ°è¿›è¡Œç‚¼ä¸¹ä¹‹è·¯ã€‚é“è·¯é˜»ä¸”é•¿ï¼Œè¡Œåˆ™å°†è‡³ï¼Œä½†è¡Œå¥½äº‹è«é—®å‰ç¨‹ã€‚</p><ul><li>é™¤äº†ä½¿ç”¨TorchServeéƒ¨ç½²æ¨¡å‹ï¼Œè¿˜æœ‰å…¶ä»–çš„è§£å†³æ–¹æ¡ˆå—ï¼Ÿ</li><li>é™¤äº†ä½¿ç”¨æä¾›è¿™ç§Web APIçš„å½¢å¼ï¼Œæ˜¯å¦å¯ä»¥æ„å»ºä¸€ä¸ªGUIçš„å½¢å¼æä¾›å‘¢ï¼Ÿä¾‹å¦‚ PYQT5 ï¼Ÿè¿™é‡Œæ”¾ä¸€å¼ PYQT5çš„å›¾ï¼Œåé¢ä¼šå¡«å‘ã€‚</li></ul><p><img src="/2022/05/15/Pytorch%E7%B3%BB%E5%88%97%E8%87%AA%E5%AD%A6%E6%95%99%E7%A8%8B-3-%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E4%B9%8BMnist%E5%9B%BE%E5%83%8F%E5%88%86%E7%B1%BBTorchServe%E9%83%A8%E7%BD%B2/_posts/Pytorchç³»åˆ—è‡ªå­¦æ•™ç¨‹-3-æ·±åº¦å­¦ä¹ ä¹‹Mnistå›¾åƒåˆ†ç±»TorchServeéƒ¨ç½²/pyqt_demo.png" alt="pyqt_demo"></p><p>æ­£å¦‚ï¼Œäººå¾€å¾€ä¼šå¯¹æœªçŸ¥çš„äº‹æƒ…äº§ç”Ÿææƒ§ï¼Œå› ä¸ºç»“å±€æ˜¯æœªçŸ¥çš„ã€‚æ‰€ä»¥å½“ä¸€åˆ‡ä¸å†æœªçŸ¥çš„æ—¶å€™ï¼Œé‚£ä¹ˆæ˜¯ä¸æ˜¯å°±ä¸ä¼šäº§ç”Ÿææƒ§å‘¢ï¼Ÿ</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p>More info: <a class="link" href="https://zhuanlan.zhihu.com/p/344364948">Chengluï¼šå¦‚ä½•éƒ¨ç½²PyTorchæ¨¡å‹<i class="fas fa-external-link-alt"></i></a><br>More info: <a class="link" href="https://github.com/pytorch/serve">TorchServe<i class="fas fa-external-link-alt"></i></a><br>More info: <a class="link" href="https://github.com/pytorch/serve/tree/master/examples/image_classifier/mnist">TorchServe_Mnist Example<i class="fas fa-external-link-alt"></i></a><br>More info: <a class="link" href="https://blog.csdn.net/weixin_41977938/article/details/122258595">éšä¾¿å†™ç‚¹ç¬”è®°<i class="fas fa-external-link-alt"></i></a><br>More info: <a class="link" href="https://blog.csdn.net/Chris_zhangrx/article/details/117380516">PyTorch Eager mode and Script mode<i class="fas fa-external-link-alt"></i></a><br>More info: <a class="link" href="https://cceyda.github.io/blog/huggingface/torchserve/streamlit/ner/2020/10/09/huggingface_streamlit_serve.html">Self-host your ğŸ¤—HuggingFace Transformer NER model with Torchserve + Streamlit<i class="fas fa-external-link-alt"></i></a><br>More info: <a class="link" href="https://ceshiren.com/t/topic/20770">TorchServeæ­å»ºcodeBERTåˆ†ç±»æ¨¡å‹æœåŠ¡<i class="fas fa-external-link-alt"></i></a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;éƒ¨ç½²ç®€ä»‹&quot;&gt;&lt;a href=&quot;#éƒ¨ç½²ç®€ä»‹&quot; class=&quot;headerlink&quot; title=&quot;éƒ¨ç½²ç®€ä»‹&quot;&gt;&lt;/a&gt;éƒ¨ç½²ç®€ä»‹&lt;/h2&gt;&lt;p&gt;å­¦ä¹ åº”è¯¥èƒ½å¤Ÿç»ˆç«¯è½åœ°ï¼Œè¿™æ ·å¯¹äºä¸ªäººå¸¦æ¥çš„æ»¡è¶³æ‰æ˜¯å·¨å¤§çš„ï¼Œæ‰ä¼šæ˜¯æœ‰ä»·å€¼çš„ã€‚æ‰€ä»¥å•çº¯åœ°è·‘äº†Demoæ¨¡å‹ï¼Œå¯¹è‡ªå·±çš„æŠ€æœ¯æå‡è¿˜æ˜¯å¾ˆå¤§</summary>
      
    
    
    
    
    <category term="Pytorch_Tutorial" scheme="https://yqstar.github.io/tags/Pytorch-Tutorial/"/>
    
  </entry>
  
  <entry>
    <title>Pytorchç³»åˆ—è‡ªå­¦æ•™ç¨‹(2):æ·±åº¦å­¦ä¹ â€œHello Worldâ€ä¹‹Mnistå›¾åƒåˆ†ç±»</title>
    <link href="https://yqstar.github.io/2022/05/11/Pytorch%E7%B3%BB%E5%88%97%E8%87%AA%E5%AD%A6%E6%95%99%E7%A8%8B-2-%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E2%80%9CHello-World%E2%80%9D%E4%B9%8BMnist%E5%9B%BE%E5%83%8F%E5%88%86%E7%B1%BB/"/>
    <id>https://yqstar.github.io/2022/05/11/Pytorch%E7%B3%BB%E5%88%97%E8%87%AA%E5%AD%A6%E6%95%99%E7%A8%8B-2-%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E2%80%9CHello-World%E2%80%9D%E4%B9%8BMnist%E5%9B%BE%E5%83%8F%E5%88%86%E7%B1%BB/</id>
    <published>2022-05-11T15:37:29.000Z</published>
    <updated>2022-06-07T15:28:22.885Z</updated>
    
    <content type="html"><![CDATA[<p>æœ¬ç« èŠ‚ä¸»è¦é€šè¿‡æ·±åº¦å­¦ä¹ â€œHello Worldâ€ä¹‹Mnistå›¾åƒåˆ†ç±»ï¼Œå­¦ä¼šæ·±åº¦å­¦ä¹ çš„åŸºæœ¬é“¾è·¯ï¼Œå¿«é€Ÿæ­å»ºä¸ªäººçš„Baselineæ¨¡å‹ï¼ŒåŒ…æ‹¬æ•°æ®åŠ è½½ã€æ•°æ®å¯è§†åŒ–ã€æ¨¡å‹æ„å»ºã€æ¨¡å‹è®­ç»ƒè¯„ä¼°å’Œæ¨¡å‹ç»“æœæŒ‡æ ‡å±•ç¤ºã€‚</p><p>Mnistæ•°æ®é›†æ˜¯æ‰‹å†™æ•°å­—0~9çš„MNISTæ•°æ®é›†ï¼ŒåŒ…å«60,000ä¸ªç”¨äºè®­ç»ƒçš„è®­ç»ƒé›†å’Œ10,000ä¸ªç”¨äºæµ‹è¯•çš„æµ‹è¯•é›†ã€‚è¿™äº›æ•°å­—å·²è¢«å¤§å°å½’ä¸€åŒ–ï¼Œå¹¶ä»¥å›ºå®šå°ºå¯¸çš„å›¾åƒä¸ºä¸­å¿ƒã€‚å¯¹äºå°è¯•å­¦ä¹ æ·±åº¦å­¦ä¹ æŠ€æœ¯çš„äººæ¥è¯´ï¼Œè¿™æ˜¯ä¸€ä¸ªéå¸¸æ£’çš„æ•°æ®é›†ï¼ŒåŒæ—¶å¯ä»¥èŠ±è´¹æœ€å°‘æ—¶é—´æ¥è¿›è¡Œé¢„å¤„ç†å’Œæ ¼å¼åŒ–ã€‚è¯¦ç»†ï¼š<a class="link" href="http://yann.lecun.com/exdb/mnist/">Mnistå®˜ç½‘<i class="fas fa-external-link-alt"></i></a></p><h2 id="ç¯å¢ƒé…ç½®"><a href="#ç¯å¢ƒé…ç½®" class="headerlink" title="ç¯å¢ƒé…ç½®"></a>ç¯å¢ƒé…ç½®</h2><p>ç¯å¢ƒé…ç½®ä¸»è¦åŒ…æ‹¬ï¼šæ“ä½œç³»ç»Ÿï¼Œæ˜¾å¡ï¼Œæ·±åº¦å­¦ä¹ Pytorchç­‰é…ç½®å¦‚ä¸‹ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ç³»ç»Ÿï¼šWindows <span class="number">11</span> - WSL2 ç³»ç»Ÿ</span><br><span class="line">æ˜¾å¡ï¼šNVIDIA GeForce RTX <span class="number">3060</span></span><br><span class="line">python: <span class="number">3.6</span><span class="number">.13</span></span><br><span class="line">pytorch: <span class="number">1.7</span><span class="number">.1</span></span><br><span class="line">cudatoolkit: <span class="number">11.0</span><span class="number">.221</span></span><br><span class="line">torchvision: <span class="number">0.8</span><span class="number">.2</span></span><br></pre></td></tr></table></figure><h3 id="å¯¼å…¥åŒ…ç¯å¢ƒ"><a href="#å¯¼å…¥åŒ…ç¯å¢ƒ" class="headerlink" title="å¯¼å…¥åŒ…ç¯å¢ƒ"></a>å¯¼å…¥åŒ…ç¯å¢ƒ</h3><p>æœ¬æ–‡ä½¿ç”¨çš„Python Package ä¸»è¦æœ‰Pytorchçš„æ·±åº¦å­¦ä¹ æ¡†æ¶ï¼Œtorchvisionç”¨äºåŠ è½½Mnistæ•°æ®é›†ï¼Œmatplotlibç”¨äºå¯è§†åŒ–å±•ç¤ºæ•°æ®é›†å’Œå±•ç¤ºè®­ç»ƒç»“æœç­‰ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> torchvision <span class="keyword">import</span> datasets, transforms</span><br><span class="line"><span class="keyword">from</span> torch.utils.data <span class="keyword">import</span> DataLoader</span><br><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">import</span> torch.optim <span class="keyword">as</span> optim</span><br><span class="line"><span class="keyword">import</span> torch.nn <span class="keyword">as</span> nn</span><br><span class="line"><span class="keyword">import</span> torch.nn.functional <span class="keyword">as</span> F</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">from</span> torchinfo <span class="keyword">import</span> summary</span><br></pre></td></tr></table></figure><p>æ„å»ºbaselineæ¨¡å‹æ ¸å¿ƒæ˜¯å¿«é€Ÿè·‘é€šå®Œæ•´é“¾è·¯ï¼ŒåŒæ—¶åœ¨Baselineçš„åŸºç¡€ä¸Šè¿­ä»£æ›´æ–°æœ‰åˆé€‚çš„å¯¹æ¯”æ ‡å‡†ï¼Œæ–¹ä¾¿éªŒè¯ç®—æ³•æ¨¡å‹çš„ç¨³å®šæ€§å’Œæ­£ç¡®æ€§ã€‚ä¸ºä¿è¯è®­ç»ƒæ¨¡å‹çš„å¯é‡å¤æ€§ï¼Œæˆ‘ä»¬éœ€è¦è¿›è¡Œä¸€äº›é…ç½®ã€‚å…¨éƒ¨é…ç½®ä¸»è¦åˆ†ä¸ºä¸‰éƒ¨åˆ†ï¼Œå…·ä½“å¦‚ä¸‹ï¼š</p><ul><li>CUDNNé…ç½®ï¼ŒCUDNNä¸­å¯¹å·ç§¯æ“ä½œè¿›è¡Œä¼˜åŒ–ï¼Œç‰ºç‰²ç²¾åº¦æ¥æ¢å–è®¡ç®—æ•ˆç‡ã€‚</li><li>Pytorchåœ¨è¿è¡Œä¸­ä¼šæœ‰å¾ˆå¤šéšæœºåˆå§‹åŒ–æ“ä½œï¼Œæ‰€ä»¥éœ€è¦å›ºå®šéšæœºç§å­ã€‚</li><li>Python &amp; Numpyä¹Ÿéœ€è¦å›ºå®šå¯¹åº”çš„éšæœºç§å­ã€‚</li><li>æ³¨æ„ï¼Œå¦‚æœDataloaderé‡‡ç”¨äº†å¤šçº¿ç¨‹(num_workers &gt; 1), é‚£ä¹ˆç”±äºè¯»å–æ•°æ®çš„é¡ºåºä¸åŒï¼Œæœ€ç»ˆè¿è¡Œç»“æœä¹Ÿä¼šæœ‰å·®å¼‚ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæ”¹å˜num_workerså‚æ•°ï¼Œä¹Ÿä¼šå¯¹å®éªŒç»“æœäº§ç”Ÿå½±å“ã€‚</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä¿è¯è¯•éªŒç»“æœçš„ç¨³å®šæ€§</span></span><br><span class="line">seed = <span class="number">0</span></span><br><span class="line">random.seed(seed)</span><br><span class="line">np.random.seed(seed)</span><br><span class="line">torch.manual_seed(seed)</span><br><span class="line">torch.cuda.manual_seed_all(seed)</span><br><span class="line">torch.backends.cudnn.benchmark = <span class="literal">False</span></span><br><span class="line">torch.backends.cudnn.deterministic = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># é…ç½®Cudaå‚æ•°</span></span><br><span class="line">is_cuda = <span class="literal">False</span></span><br><span class="line"><span class="keyword">if</span> torch.cuda.is_available():</span><br><span class="line">    is_cuda = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¨¡å‹å‚æ•°</span></span><br><span class="line">batch_size = <span class="number">32</span></span><br><span class="line">num_epochs = <span class="number">2</span></span><br></pre></td></tr></table></figure><h2 id="æ¨¡å‹æ•°æ®"><a href="#æ¨¡å‹æ•°æ®" class="headerlink" title="æ¨¡å‹æ•°æ®"></a>æ¨¡å‹æ•°æ®</h2><p>æœ¬ç« èŠ‚å°±ä¸è¯¦ç»†è®²è§£ï¼Œå¤§å®¶å¯ä»¥æŸ¥çœ‹å‰ä¸€ç« çš„è®²è§£ã€‚More Info: <a href="https://yqstar.github.io/2022/05/05/Pytorch%E7%B3%BB%E5%88%97%E8%87%AA%E5%AD%A6%E6%95%99%E7%A8%8B-1-%E6%95%B0%E6%8D%AE%E5%8A%A0%E8%BD%BD%E4%B9%8BDataset%E5%92%8CDataLoader%E4%BD%BF%E7%94%A8/">æ•°æ®åŠ è½½</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ„å»ºDataset</span></span><br><span class="line">mnist_train_dataset = datasets.MNIST(root=<span class="string">r&#x27;./data&#x27;</span>,</span><br><span class="line">                              transform=transforms.ToTensor(),</span><br><span class="line">                              train=<span class="literal">True</span>,</span><br><span class="line">                              download=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">mnist_test_dataset = datasets.MNIST(root=<span class="string">r&#x27;./data&#x27;</span>,</span><br><span class="line">                              transform=transforms.ToTensor(),</span><br><span class="line">                              train=<span class="literal">False</span>,</span><br><span class="line">                              download=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ„å»ºDataloader</span></span><br><span class="line">mnist_train_loader = DataLoader(mnist_train_dataset,batch_size=<span class="number">32</span>,shuffle=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">mnist_test_loader = DataLoader(mnist_test_dataset,batch_size=<span class="number">32</span>,shuffle=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure><p>ä¸ºæ›´å¥½åœ°çœ‹åˆ°æˆ‘ä»¬éœ€è¦å¤„ç†ä»€ä¹ˆæ ·çš„æ•°æ®ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ä¸€äº›å¯è§†åŒ–çš„æ‰‹æ®µå±•ç¤ºæˆ‘ä»¬çš„æ•°æ®ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å›¾ç‰‡æŸ¥çœ‹</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">plot_image</span>(<span class="params">image,batch_size=<span class="number">32</span></span>):</span><br><span class="line">    x_batch,y_batch = image[<span class="number">0</span>],image[<span class="number">1</span>]</span><br><span class="line">    f = plt.figure(figsize=(<span class="number">300</span>,<span class="number">300</span>))</span><br><span class="line">    <span class="comment"># mean = 0.1307</span></span><br><span class="line">    <span class="comment"># std = 0.3081</span></span><br><span class="line">    <span class="comment"># image = ((image * mean) + std)</span></span><br><span class="line">    <span class="comment"># plt.imshow(image, cmap=&#x27;gray&#x27;)</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(batch_size):</span><br><span class="line">        image_tx = x_batch.numpy()[i]</span><br><span class="line">        <span class="comment"># image_ty = y_batch.numpy()[i]</span></span><br><span class="line">        np.math.sqrt(<span class="number">32</span>)</span><br><span class="line">        <span class="comment"># Debug, plot figure</span></span><br><span class="line">        sub_size = <span class="built_in">int</span>(np.math.sqrt(<span class="number">32</span>))+<span class="number">1</span></span><br><span class="line">        f.add_subplot(sub_size,sub_size, i + <span class="number">1</span>)</span><br><span class="line">        <span class="comment"># plt.subplot_mosaic</span></span><br><span class="line">        plt.imshow(image_tx[<span class="number">0</span>], cmap=<span class="string">&#x27;gray&#x27;</span>)</span><br><span class="line">    plt.show()</span><br><span class="line"></span><br><span class="line">sample_image_batch = <span class="built_in">next</span>(<span class="built_in">iter</span>(mnist_train_loader))</span><br><span class="line">plot_image(sample_image_batch)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å›¾ç‰‡å±•ç¤ºç»“æœå¦‚ä¸‹ï¼š</p><p><img src="/2022/05/11/Pytorch%E7%B3%BB%E5%88%97%E8%87%AA%E5%AD%A6%E6%95%99%E7%A8%8B-2-%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E2%80%9CHello-World%E2%80%9D%E4%B9%8BMnist%E5%9B%BE%E5%83%8F%E5%88%86%E7%B1%BB/sample_vis.png" alt="æ ·æœ¬å›¾ç‰‡"></p><h2 id="æ¨¡å‹æ„å»º"><a href="#æ¨¡å‹æ„å»º" class="headerlink" title="æ¨¡å‹æ„å»º"></a>æ¨¡å‹æ„å»º</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ„å»ºç½‘ç»œ</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MnistNet</span>(nn.Module):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">super</span>().__init__()</span><br><span class="line">        self.conv1 = nn.Conv2d(in_channels=<span class="number">1</span>,out_channels=<span class="number">32</span>,kernel_size= <span class="number">3</span>)</span><br><span class="line">        self.conv2 = nn.Conv2d(in_channels= <span class="number">32</span>,out_channels= <span class="number">64</span>,kernel_size= <span class="number">3</span>)</span><br><span class="line">        self.dropout = nn.Dropout2d(<span class="number">0.25</span>)</span><br><span class="line">        self.fc1 = nn.Linear(<span class="number">9216</span>, <span class="number">128</span>)</span><br><span class="line">        self.fc2 = nn.Linear(<span class="number">128</span>, <span class="number">10</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, x</span>):</span><br><span class="line">        x = self.conv1(x)</span><br><span class="line">        x = F.relu(x)</span><br><span class="line">        x = self.conv2(x)</span><br><span class="line">        x = F.relu(x)</span><br><span class="line">        x = F.max_pool2d(x, <span class="number">2</span>)</span><br><span class="line">        x = self.dropout(x)</span><br><span class="line">        x = x.view(-<span class="number">1</span>, <span class="number">9216</span>)</span><br><span class="line">        x = self.fc1(x)</span><br><span class="line">        x = F.relu(x)</span><br><span class="line">        x = self.fc2(x)</span><br><span class="line">        x = F.log_softmax(x, dim=<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span> x</span><br></pre></td></tr></table></figure><p>åœ¨è¿›è¡Œæ¨¡å‹è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä»¥ä¸‹ä»£ç ï¼ŒæŸ¥çœ‹æ„å»ºçš„æ¨¡å‹ç»“æ„ï¼Œç›®å‰torchinfoä»…èƒ½å±•ç¤º <em>torch.nn</em> æ¨¡å—ä¸‹çš„æ¨¡å‹ç»“æ„ï¼Œé‡‡ç”¨ <em>torch.nn.functional</em> æ„é€ çš„å‡½æ•°æ˜¯æ— æ³•æ˜¾ç¤ºçš„ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">summary(model, input_size=(batch_size, <span class="number">1</span>, <span class="number">28</span>, <span class="number">28</span>),depth=<span class="number">4</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="/2022/05/11/Pytorch%E7%B3%BB%E5%88%97%E8%87%AA%E5%AD%A6%E6%95%99%E7%A8%8B-2-%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E2%80%9CHello-World%E2%80%9D%E4%B9%8BMnist%E5%9B%BE%E5%83%8F%E5%88%86%E7%B1%BB/model_vis.png" alt="æ ·æœ¬å›¾ç‰‡"></p><h2 id="æ¨¡å‹è®­ç»ƒ"><a href="#æ¨¡å‹è®­ç»ƒ" class="headerlink" title="æ¨¡å‹è®­ç»ƒ"></a>æ¨¡å‹è®­ç»ƒ</h2><h3 id="æ¨¡å‹è®­ç»ƒå‡½æ•°"><a href="#æ¨¡å‹è®­ç»ƒå‡½æ•°" class="headerlink" title="æ¨¡å‹è®­ç»ƒå‡½æ•°"></a>æ¨¡å‹è®­ç»ƒå‡½æ•°</h3><p>å¦‚æœæ¨¡å‹ä¸­æœ‰BNå±‚(Batch Normalizationï¼‰å’ŒDropoutï¼Œéœ€è¦åœ¨è®­ç»ƒæ—¶æ·»åŠ model.train()ï¼Œåœ¨æµ‹è¯•æ—¶æ·»åŠ model.eval()ã€‚å…¶ä¸­model.train()æ˜¯ä¿è¯BNå±‚ç”¨æ¯ä¸€æ‰¹æ•°æ®çš„å‡å€¼å’Œæ–¹å·®ï¼Œè€Œmodel.eval()æ˜¯ä¿è¯BNç”¨å…¨éƒ¨è®­ç»ƒæ•°æ®çš„å‡å€¼å’Œæ–¹å·®ï¼›è€Œå¯¹äºDropoutï¼Œmodel.train()æ˜¯éšæœºå–ä¸€éƒ¨åˆ†ç½‘ç»œè¿æ¥æ¥è®­ç»ƒæ›´æ–°å‚æ•°ï¼Œè€Œmodel.eval()æ˜¯åˆ©ç”¨åˆ°äº†æ‰€æœ‰ç½‘ç»œè¿æ¥ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ¨¡å‹è®­ç»ƒå‡½æ•°</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">fit_train</span>(<span class="params">model,data_loader</span>):</span><br><span class="line">    model.train()</span><br><span class="line">    running_loss = <span class="number">0</span></span><br><span class="line">    running_correct = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> batch_idx, (data, target) <span class="keyword">in</span> <span class="built_in">enumerate</span>(data_loader):</span><br><span class="line">        <span class="keyword">if</span> is_cuda:</span><br><span class="line">            data, target = data.cuda(), target.cuda()</span><br><span class="line">        optimizer.zero_grad()</span><br><span class="line">        output = model(data)</span><br><span class="line">        loss = F.nll_loss(output, target)</span><br><span class="line">        running_loss += F.nll_loss(output ,target ,reduction=<span class="string">&#x27;sum&#x27;</span>).item()</span><br><span class="line">        preds = output.data.<span class="built_in">max</span>(<span class="number">1</span>, keepdim=<span class="literal">True</span>)[<span class="number">1</span>]</span><br><span class="line">        running_correct += preds.eq(target.data.view_as(preds)).cpu().<span class="built_in">sum</span>()</span><br><span class="line">        loss.backward()</span><br><span class="line">        optimizer.step()</span><br><span class="line">    loss = running_loss/<span class="built_in">len</span>(data_loader.dataset)</span><br><span class="line">    accuracy = <span class="number">100.</span> * running_correct/<span class="built_in">len</span>(data_loader.dataset)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;Train loss is <span class="subst">&#123;loss:&#123;<span class="number">5</span>&#125;</span>.<span class="subst">&#123;<span class="number">2</span>&#125;</span>&#125; and Train accuracy is <span class="subst">&#123;accuracy:&#123;<span class="number">10</span>&#125;</span>.<span class="subst">&#123;<span class="number">4</span>&#125;</span>&#125; %&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> loss, accuracy</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¨¡å‹è¯„ä¼°å‡½æ•°</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">fit_eval</span>(<span class="params">model,data_loader</span>):</span><br><span class="line">    model.<span class="built_in">eval</span>()</span><br><span class="line">    running_loss = <span class="number">0</span></span><br><span class="line">    running_correct = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> batch_idx, (data, target) <span class="keyword">in</span> <span class="built_in">enumerate</span>(data_loader):</span><br><span class="line">        <span class="keyword">if</span> is_cuda:</span><br><span class="line">            data, target = data.cuda(), target.cuda()</span><br><span class="line">        output = model(data)</span><br><span class="line">        loss = F.nll_loss(output, target)</span><br><span class="line">        running_loss += F.nll_loss(output ,target ,reduction=<span class="string">&#x27;sum&#x27;</span>).item()</span><br><span class="line">        preds = output.data.<span class="built_in">max</span>(<span class="number">1</span>, keepdim=<span class="literal">True</span>)[<span class="number">1</span>]</span><br><span class="line">        running_correct += preds.eq(target.data.view_as(preds)).cpu().<span class="built_in">sum</span>()</span><br><span class="line">    loss = running_loss/<span class="built_in">len</span>(data_loader.dataset)</span><br><span class="line">    accuracy = <span class="number">100.</span> * running_correct/<span class="built_in">len</span>(data_loader.dataset)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;Eval loss is <span class="subst">&#123;loss:&#123;<span class="number">5</span>&#125;</span>.<span class="subst">&#123;<span class="number">2</span>&#125;</span>&#125; and Eval accuracy is <span class="subst">&#123;accuracy:&#123;<span class="number">10</span>&#125;</span>.<span class="subst">&#123;<span class="number">4</span>&#125;</span>&#125; %&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> loss, accuracy</span><br></pre></td></tr></table></figure><p>åˆå§‹åŒ–æ¨¡å‹å’Œé…ç½®ä¼˜åŒ–å‡½æ•°ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">model = MnistNet()</span><br><span class="line"><span class="keyword">if</span> is_cuda:</span><br><span class="line">    model.cuda()</span><br><span class="line">optimizer = optim.SGD(model.parameters(),lr=<span class="number">0.01</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="æ¨¡å‹è¯„ä¼°"><a href="#æ¨¡å‹è¯„ä¼°" class="headerlink" title="æ¨¡å‹è¯„ä¼°"></a>æ¨¡å‹è¯„ä¼°</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">train_losses, train_accuracy = [], []</span><br><span class="line">val_losses, val_accuracy = [], []</span><br><span class="line"><span class="keyword">for</span> epoch <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">20</span>):</span><br><span class="line">    epoch_loss, epoch_accuracy = fit_train(model, mnist_train_loader)</span><br><span class="line">    val_epoch_loss, val_epoch_accuracy = fit_eval(model, mnist_test_loader)</span><br><span class="line">    train_losses.append(epoch_loss)</span><br><span class="line">    train_accuracy.append(epoch_accuracy)</span><br><span class="line">    val_losses.append(val_epoch_loss)</span><br><span class="line">    val_accuracy.append(val_epoch_accuracy)</span><br></pre></td></tr></table></figure><p><img src="/2022/05/11/Pytorch%E7%B3%BB%E5%88%97%E8%87%AA%E5%AD%A6%E6%95%99%E7%A8%8B-2-%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E2%80%9CHello-World%E2%80%9D%E4%B9%8BMnist%E5%9B%BE%E5%83%8F%E5%88%86%E7%B1%BB/train_eval_vis.png" alt="æ ·æœ¬å›¾ç‰‡"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">plt.plot(<span class="built_in">range</span>(<span class="number">1</span>,<span class="built_in">len</span>(train_losses)+<span class="number">1</span>),train_losses,<span class="string">&#x27;bo&#x27;</span>,label = <span class="string">&#x27;training loss&#x27;</span>)</span><br><span class="line">plt.plot(<span class="built_in">range</span>(<span class="number">1</span>,<span class="built_in">len</span>(val_losses)+<span class="number">1</span>),val_losses,<span class="string">&#x27;r&#x27;</span>,label = <span class="string">&#x27;validation loss&#x27;</span>)</span><br><span class="line">plt.legend()</span><br><span class="line">plt.show()</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="/2022/05/11/Pytorch%E7%B3%BB%E5%88%97%E8%87%AA%E5%AD%A6%E6%95%99%E7%A8%8B-2-%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E2%80%9CHello-World%E2%80%9D%E4%B9%8BMnist%E5%9B%BE%E5%83%8F%E5%88%86%E7%B1%BB/loss_vis.png" alt="æ ·æœ¬å›¾ç‰‡"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">plt.plot(<span class="built_in">range</span>(<span class="number">1</span>,<span class="built_in">len</span>(train_accuracy)+<span class="number">1</span>),train_accuracy,<span class="string">&#x27;bo&#x27;</span>,label = <span class="string">&#x27;train accuracy&#x27;</span>)</span><br><span class="line">plt.plot(<span class="built_in">range</span>(<span class="number">1</span>,<span class="built_in">len</span>(val_accuracy)+<span class="number">1</span>),val_accuracy,<span class="string">&#x27;r&#x27;</span>,label = <span class="string">&#x27;val accuracy&#x27;</span>)</span><br><span class="line">plt.legend()</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure><p><img src="/2022/05/11/Pytorch%E7%B3%BB%E5%88%97%E8%87%AA%E5%AD%A6%E6%95%99%E7%A8%8B-2-%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E2%80%9CHello-World%E2%80%9D%E4%B9%8BMnist%E5%9B%BE%E5%83%8F%E5%88%86%E7%B1%BB/accuracy_vis.png" alt="æ ·æœ¬å›¾ç‰‡"></p><h2 id="æ¢ç´¢"><a href="#æ¢ç´¢" class="headerlink" title="æ¢ç´¢"></a>æ¢ç´¢</h2><p><img src="https://github.com/yqstar/Awesome_Pytorch_Tutorial/tree/master/Pytorch_Lesson2" alt="å®Œæ•´ä»£ç ">å·²ä¸Šä¼ Githubï¼Œæœ‰éœ€è¦çš„å¯ä»¥è‡ªè¡Œä¸‹è½½ä»£ç ï¼Œå¦‚æœå¯¹ä½ æœ‰å¸®åŠ©ï¼Œè¯·Starï¼Œå“ˆå“ˆå“ˆå“ˆï¼</p><p>åˆ°æ­¤ä¸ºæ­¢ï¼Œå·²ç»å¯ä»¥ä½¿ç”¨è‡ªå·±æ•°æ®ç©è€å„ç§Demoï¼Œå¿«ï¼ˆè‹¦ï¼‰ä¹ï¼ˆé€¼ï¼‰åœ°è¿›è¡Œç‚¼ä¸¹ä¹‹è·¯ã€‚é“è·¯é˜»ä¸”é•¿ï¼Œè¡Œåˆ™å°†è‡³ï¼Œä½†è¡Œå¥½äº‹è«é—®å‰ç¨‹ã€‚</p><ul><li>Demoæ¨¡å‹è¿˜å¯ä»¥ä¿®æ”¹Losså‡½æ•°ï¼Œä¼˜åŒ–å‡½æ•°å’Œæ¨¡å‹ç»“æ„ï¼Ÿ</li><li>é™¤äº†Torchinfoï¼Œæ˜¯å¦å¯ä»¥ä½¿ç”¨Tensorboardç­‰å¯è§†åŒ–å·¥å…·ç®¡ç†æ¨¡å‹æ•°æ®çš„å¯è§†åŒ–æ•°æ®å‘¢ï¼Ÿ</li><li>Demoæ¨¡å‹ç¦»ç”Ÿäº§ä¸Šçº¿è¿˜æœ‰å¤šè¿œè·ç¦»ï¼Ÿå¦‚ä½•ä¸Šçº¿éƒ¨ç½²æ¨¡å‹å‘¢ï¼Ÿå¦‚ä½•å®ç°ä»Mysqlç­‰æ•°æ®åº“åˆ°çº¿ä¸Šæ¨¡å‹è°ƒç”¨å‘¢ï¼Ÿä»»ä½•çš„ä»£ç æ˜¯å¦éƒ½åº”è¯¥ä»¥èƒ½å¤Ÿç»ˆç«¯ä½¿ç”¨ä¸ºç›®çš„ï¼Ÿ</li></ul><p>æ­£å¦‚ï¼Œäººå¾€å¾€ä¼šå¯¹æœªçŸ¥çš„äº‹æƒ…äº§ç”Ÿææƒ§ï¼Œå› ä¸ºç»“å±€æ˜¯æœªçŸ¥çš„ã€‚æ‰€ä»¥å½“ä¸€åˆ‡ä¸å†æœªçŸ¥çš„æ—¶å€™ï¼Œé‚£ä¹ˆæ˜¯ä¸æ˜¯å°±ä¸ä¼šäº§ç”Ÿææƒ§å‘¢ï¼Ÿ</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;æœ¬ç« èŠ‚ä¸»è¦é€šè¿‡æ·±åº¦å­¦ä¹ â€œHello Worldâ€ä¹‹Mnistå›¾åƒåˆ†ç±»ï¼Œå­¦ä¼šæ·±åº¦å­¦ä¹ çš„åŸºæœ¬é“¾è·¯ï¼Œå¿«é€Ÿæ­å»ºä¸ªäººçš„Baselineæ¨¡å‹ï¼ŒåŒ…æ‹¬æ•°æ®åŠ è½½ã€æ•°æ®å¯è§†åŒ–ã€æ¨¡å‹æ„å»ºã€æ¨¡å‹è®­ç»ƒè¯„ä¼°å’Œæ¨¡å‹ç»“æœæŒ‡æ ‡å±•ç¤ºã€‚&lt;/p&gt;
&lt;p&gt;Mnistæ•°æ®é›†æ˜¯æ‰‹å†™æ•°å­—0~9çš„MNISTæ•°æ®é›†ï¼ŒåŒ…å«60</summary>
      
    
    
    
    <category term="æ·±åº¦å­¦ä¹ " scheme="https://yqstar.github.io/categories/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/"/>
    
    
    <category term="Pytorch_Tutorial" scheme="https://yqstar.github.io/tags/Pytorch-Tutorial/"/>
    
  </entry>
  
  <entry>
    <title>Pytorchç³»åˆ—è‡ªå­¦æ•™ç¨‹(1):æ•°æ®åŠ è½½ä¹‹Datasetå’ŒDataLoaderä½¿ç”¨</title>
    <link href="https://yqstar.github.io/2022/05/05/Pytorch%E7%B3%BB%E5%88%97%E8%87%AA%E5%AD%A6%E6%95%99%E7%A8%8B-1-%E6%95%B0%E6%8D%AE%E5%8A%A0%E8%BD%BD%E4%B9%8BDataset%E5%92%8CDataLoader%E4%BD%BF%E7%94%A8/"/>
    <id>https://yqstar.github.io/2022/05/05/Pytorch%E7%B3%BB%E5%88%97%E8%87%AA%E5%AD%A6%E6%95%99%E7%A8%8B-1-%E6%95%B0%E6%8D%AE%E5%8A%A0%E8%BD%BD%E4%B9%8BDataset%E5%92%8CDataLoader%E4%BD%BF%E7%94%A8/</id>
    <published>2022-05-05T15:03:19.000Z</published>
    <updated>2022-06-07T15:28:25.355Z</updated>
    
    <content type="html"><![CDATA[<p>æ·±åº¦å­¦ä¹ æ¨¡å‹ï¼ŒåŒºåˆ«äºå…¶ä»–çš„æœºå™¨å­¦ä¹ æ¨¡å‹ï¼Œä¸€æ–¹é¢ï¼Œæ¨¡å‹è®­ç»ƒæ‰€éœ€çš„æ•°æ®é‡é€šå¸¸æ˜¯éå¸¸å¤§çš„ï¼Œæ˜¯æ— æ³•ä¸€æ¬¡æ€§åŠ è½½åˆ°å†…å­˜ä¸­ï¼›å¦ä¸€æ–¹é¢ï¼Œæ¨¡å‹è®­ç»ƒå¤šé‡‡ç”¨åŸºäºæ¢¯åº¦ä¸‹é™çš„ä¼˜åŒ–æ–¹æ³•å¯¹æ¨¡å‹çš„æƒé‡å’Œåç½®è¿›è¡Œé€æ­¥è°ƒæ•´çš„ï¼Œä¸å¯èƒ½ä¸€æ¬¡æ€§åœ°åœ¨æ¨¡å‹ä¸­è¿›è¡Œæ­£å‘ä¼ æ’­å’Œåå‘ä¼ æ’­ã€‚é€šå¸¸ï¼Œæˆ‘ä»¬éœ€è¦è¿›è¡Œæ•°æ®åŠ è½½å’Œé¢„å¤„ç†å¤„ç†ï¼Œå°†å…¶å°è£…æˆé€‚åˆè¿­ä»£è®­ç»ƒçš„å½¢å¼ï¼Œå…·ä½“ä¼šå¯¹æ•´ä¸ªæ•°æ®è¿›è¡Œéšæœºæ‰“ä¹±ï¼Œç„¶åå°†åŸå§‹æ•°æ®å¤„ç†æˆä¸€ä¸ªä¸€ä¸ªçš„Batchï¼Œç„¶åé€åˆ°æ¨¡å‹ä¸­è¿›è¡Œè®­ç»ƒã€‚</p><p>æ·±åº¦å­¦ä¹ æ¨¡å‹æµç¨‹ä¸­ä¸€èˆ¬éƒ½æ˜¯å…ˆè§£å†³æ•°æ®åŠ è½½é—®é¢˜ï¼ŒåŒ…æ‹¬æ•°æ®çš„<strong>è¾“å…¥é—®é¢˜</strong>å’Œ<strong>é¢„å¤„ç†é—®é¢˜</strong>ï¼Œæ•°æ®åŠ è½½å¤„ç†åœ¨æ·±åº¦å­¦ä¹ é“¾è·¯ä¸­èµ·ç€éå¸¸é‡è¦çš„åŸºç¡€ä½œç”¨ã€‚è¿™ç¯‡æ–‡ç« å°†ä»‹ç»Pytorchå¯¹è‡ªå®šä¹‰æ•°æ®é›†è¿›è¡Œå°è£…çš„æ–¹æ³•ã€‚</p><h2 id="Datasetã€Batchã€Iterationå’ŒEpochçš„å…³ç³»"><a href="#Datasetã€Batchã€Iterationå’ŒEpochçš„å…³ç³»" class="headerlink" title="Datasetã€Batchã€Iterationå’ŒEpochçš„å…³ç³»"></a>Datasetã€Batchã€Iterationå’ŒEpochçš„å…³ç³»</h2><p>åœ¨ä»‹ç»å¦‚ä½•ä½¿ç”¨PytorchåŠ è½½æ•°æ®å‰ï¼Œç®€å•ä»‹ç»ä¸‹ï¼Œ<strong>Dataset</strong>ï¼Œ<strong>Batch</strong>ï¼Œ<strong>Iteration</strong> å’Œ <strong>Epoch</strong> çš„åŒºåˆ«å’Œå…³ç³»ã€‚</p><div class="table-container"><table><thead><tr><th style="text-align:center">åè¯</th><th style="text-align:center">è§£é‡Š</th></tr></thead><tbody><tr><td style="text-align:center">  Dataset</td><td style="text-align:center">å¾…è®­ç»ƒçš„å…¨é‡æ•°æ®é›†</td></tr><tr><td style="text-align:center">   Batch</td><td style="text-align:center">å¾…è®­ç»ƒå…¨é‡æ•°æ®é›†çš„ä¸€å°éƒ¨åˆ†æ ·æœ¬å¯¹æ¨¡å‹è¿›è¡Œä¸€æ¬¡åå‘ä¼ æ’­å‚æ•°æ›´æ–°ï¼Œè¿™ä¸€å°éƒ¨åˆ†æ ·æœ¬ç§°ä¸ºâ€œä¸€ä¸ªBatchâ€</td></tr><tr><td style="text-align:center"> Iteration</td><td style="text-align:center">ä½¿ç”¨ä¸€ä¸ªBatchæ•°æ®å¯¹æ¨¡å‹è¿›è¡Œä¸€æ¬¡å‚æ•°æ›´æ–°çš„è¿‡ç¨‹ï¼Œç§°ä¹‹ä¸ºâ€œä¸€æ¬¡Iterationâ€</td></tr><tr><td style="text-align:center">   Epoch</td><td style="text-align:center">å¾…è®­ç»ƒå…¨é‡æ•°æ®é›†å¯¹æ¨¡å‹è¿›è¡Œä¸€æ¬¡å®Œæ•´çš„å‚æ•°æ›´æ–°ï¼Œç§°ä¹‹ä¸ºâ€œä¸€ä¸ªEpochâ€</td></tr></tbody></table></div><p>å‡è®¾DatasetSize=10ï¼ŒBatchSize=3ï¼Œé‚£ä¹ˆæ¯ä¸ªEpochä¼šæ‰§è¡Œ4ä¸ªIterationï¼Œå¯¹åº”å››ä¸ªBatchï¼Œæ¯ä¸ªBatchSizeå¤§å°åˆ†åˆ«åŒ…æ‹¬3ï¼Œ3ï¼Œ3å’Œ1ä¸ªæ ·æœ¬ã€‚</p><p><img src="/2022/05/05/Pytorch%E7%B3%BB%E5%88%97%E8%87%AA%E5%AD%A6%E6%95%99%E7%A8%8B-1-%E6%95%B0%E6%8D%AE%E5%8A%A0%E8%BD%BD%E4%B9%8BDataset%E5%92%8CDataLoader%E4%BD%BF%E7%94%A8/dataset.jpg" alt="data"></p><h2 id="Pytochæ•°æ®å¤„ç†ï¼šDataSetå’ŒDataLoader"><a href="#Pytochæ•°æ®å¤„ç†ï¼šDataSetå’ŒDataLoader" class="headerlink" title="Pytochæ•°æ®å¤„ç†ï¼šDataSetå’ŒDataLoader"></a>Pytochæ•°æ®å¤„ç†ï¼šDataSetå’ŒDataLoader</h2><p>Pytorchæä¾›äº†å‡ ä¸ªæœ‰ç”¨çš„å·¥å…·ï¼š<strong>torch.utils.data.Datasetç±»</strong>å’Œ<strong>torch.utils.data.DataLoaderç±»</strong>ï¼Œç”¨äºæ•°æ®è¯»å–å’Œé¢„å¤„ç†ã€‚<br>åŸºæœ¬æµç¨‹æ˜¯å…ˆæŠŠåŸå§‹æ•°æ®è½¬å˜æˆtorch.utils.data.Datasetç±»ï¼ŒéšåæŠŠå¾—åˆ°çš„torch.utils.data.Datasetç±»å½“ä½œä¸€ä¸ªå‚æ•°ä¼ é€’ç»™torch.utils.data.DataLoaderç±»ï¼Œå¾—åˆ°ä¸€ä¸ªæ•°æ®åŠ è½½å™¨ï¼Œè¿™ä¸ªæ•°æ®åŠ è½½å™¨æ¯æ¬¡å¯ä»¥è¿”å›ä¸€ä¸ªBatchçš„æ•°æ®ä¾›æ¨¡å‹è®­ç»ƒä½¿ç”¨ã€‚</p><h3 id="torch-utils-data-Datasetç±»"><a href="#torch-utils-data-Datasetç±»" class="headerlink" title="torch.utils.data.Datasetç±»"></a>torch.utils.data.Datasetç±»</h3><p><em>torch.utils.data.Dataset</em>æ˜¯ä»£è¡¨è¿™ä¸€æ•°æ®çš„æŠ½è±¡ç±»ï¼Œä½ å¯ä»¥è‡ªå·±å®šä¹‰æ•°æ®ç±»ï¼Œç»§æ‰¿å’Œé‡å†™è¿™ä¸ªæŠ½è±¡ç±»ï¼Œåªéœ€è¦å®šä¹‰<strong>init</strong>ï¼Œ<strong>len</strong>å’Œ<strong>getitem</strong>è¿™ä¸‰ä¸ªé­”æ³•å‡½æ•°,å…¶ä¸­ï¼š</p><ul><li>_<em>init_</em>()ï¼šç”¨äºåˆå§‹åŒ–åŸå§‹æ•°æ®çš„è·¯å¾„å’Œæ–‡ä»¶åç­‰ã€‚</li><li>_<em>len_</em>()ï¼šç”¨äºè¿”å›æ•°æ®é›†ä¸­çš„æ ·æœ¬æ€»ä¸ªæ•°ã€‚</li><li>_<em>getitem_</em>()ï¼šç”¨äºè¿”å›æŒ‡å®šç´¢å¼•çš„æ ·æœ¬æ‰€å¯¹åº”çš„è¾“å…¥å˜é‡ä¸è¾“å‡ºå˜é‡ã€‚</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># class CustomDataset(torch.utils.data.Dataset):#éœ€è¦ç»§æ‰¿data.Dataset</span></span><br><span class="line"><span class="comment">#     def __init__(self):</span></span><br><span class="line"><span class="comment">#         # TODO</span></span><br><span class="line"><span class="comment">#         # 1. Initialize file path or list of file names.</span></span><br><span class="line"><span class="comment">#         pass</span></span><br><span class="line"><span class="comment">#     def __getitem__(self, index):</span></span><br><span class="line"><span class="comment">#         # TODO</span></span><br><span class="line"><span class="comment">#         # 1. Read one data from file (e.g. using numpy.fromfile, PIL.Image.open).</span></span><br><span class="line"><span class="comment">#         # 2. Preprocess the data (e.g. torchvision.Transform).</span></span><br><span class="line"><span class="comment">#         # 3. Return a data pair (e.g. image and label).</span></span><br><span class="line"><span class="comment">#         #è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç¬¬ä¸€æ­¥ï¼šread one dataï¼Œæ˜¯ä¸€ä¸ªdata</span></span><br><span class="line"><span class="comment">#         pass</span></span><br><span class="line"><span class="comment">#     def __len__(self):</span></span><br><span class="line"><span class="comment">#         # You should change 0 to the total size of your dataset.</span></span><br><span class="line"><span class="comment">#         pass</span></span><br></pre></td></tr></table></figure><p>ç”¨åŸå§‹æ•°æ®æ„é€ å‡ºæ¥çš„<em>Datasetå­ç±»</em>å¯ä»¥ç†è§£æˆä¸€ä¸ªé™æ€æ•°æ®æ± ï¼Œè¿™ä¸ªæ•°æ®æ± ä½¿å¾—æˆ‘ä»¬å¯ä»¥ç”¨<em>ç´¢å¼•</em>å¾—åˆ°æŸä¸ªæ ·æœ¬æ•°æ®ï¼Œè€Œæƒ³è¦è¯¥æ•°æ®æ± æµåŠ¨èµ·æ¥ï¼Œæºæºä¸æ–­åœ°è¾“å‡º<em>Batch</em>ä¾›ç»™ç»™æ¨¡å‹è®­ç»ƒï¼Œè¿˜éœ€è¦ä¸‹ä¸€ä¸ªå·¥å…·<em>DataLoaderç±»</em>ã€‚æ‰€ä»¥æˆ‘ä»¬æŠŠåˆ›å»ºçš„<em>Datasetå­ç±»</em>å½“å‚æ•°ä¼ å…¥å³å°†æ„å»ºçš„<em>DataLoaderç±»</em>æ‰æ˜¯ä½¿ç”¨<em>Datasetå­ç±»</em>æœ€ç»ˆç›®çš„ã€‚</p><h3 id="torch-utils-data-DataLoaderç±»"><a href="#torch-utils-data-DataLoaderç±»" class="headerlink" title="torch.utils.data.DataLoaderç±»"></a>torch.utils.data.DataLoaderç±»</h3><p>DataLoader(object)å¯ç”¨å‚æ•°:</p><ul><li>dataset(Dataset): ä¼ å…¥çš„æ•°æ®é›†ã€‚</li><li>batch_size(int, optional): æ¯ä¸ªbatchæœ‰å¤šå°‘æ ·æœ¬ã€‚</li><li>shuffle(bool, optional): åœ¨æ¯ä¸ªepochå¼€å§‹æ—¶ï¼Œå¯¹æ•°æ®è¿›è¡Œæ‰“ä¹±æ’åºã€‚</li><li>sampler(Sampler, optional): è‡ªå®šä¹‰ä»æ•°æ®é›†ä¸­å–æ ·æœ¬çš„ç­–ç•¥ï¼Œå¦‚æœæŒ‡å®šè¿™ä¸ªå‚æ•°ï¼Œé‚£ä¹ˆshuffleå¿…é¡»ä¸ºFalseã€‚</li><li>batch_sampler(Sampler, optional): ä¸samplerç±»ä¼¼ï¼Œä½†æ˜¯ä¸€æ¬¡åªè¿”å›ä¸€ä¸ªbatchçš„indicesï¼ˆç´¢å¼•ï¼‰ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä¸€æ—¦æŒ‡å®šäº†è¿™ä¸ªå‚æ•°ï¼Œé‚£ä¹ˆbatch_size,shuffle,sampler,drop_lastå°±ä¸èƒ½å†é…ç½®ï¼ˆäº’æ–¥ï¼‰ã€‚</li><li>num_workers (int, optional): å†³å®šäº†æœ‰å‡ ä¸ªè¿›ç¨‹æ¥å¤„ç†data loadingã€‚0æ„å‘³ç€æ‰€æœ‰çš„æ•°æ®éƒ½ä¼šè¢«loadè¿›ä¸»è¿›ç¨‹ã€‚ï¼ˆé»˜è®¤ä¸º0ï¼‰</li><li>collate_fn (callable, optional): å°†ä¸€ä¸ªlistçš„sampleç»„æˆä¸€ä¸ªmini-batchçš„å‡½æ•°ã€‚</li><li>pin_memory (bool, optional)ï¼š å¦‚æœè®¾ç½®ä¸ºTrueï¼Œé‚£ä¹ˆdata loaderå°†ä¼šåœ¨è¿”å›å®ƒä»¬ä¹‹å‰ï¼Œå°†tensorsæ‹·è´åˆ°CUDAä¸­çš„å›ºå®šå†…å­˜ä¸­ã€‚</li><li>drop_last (bool, optional):å¦‚æœè®¾ç½®ä¸ºTrueï¼šè¿™ä¸ªæ˜¯å¯¹æœ€åçš„æœªå®Œæˆçš„batchæ¥è¯´çš„ï¼Œæ¯”å¦‚batch_sizeè®¾ç½®ä¸º64ï¼Œè€Œä¸€ä¸ªepochåªæœ‰100ä¸ªæ ·æœ¬ï¼Œé‚£ä¹ˆè®­ç»ƒæ—¶åé¢36ä¸ªæ ·æœ¬ä¼šè¢«ä¸¢å¼ƒã€‚ å¦‚æœä¸ºFalseï¼ˆé»˜è®¤ï¼‰ï¼Œé‚£ä¹ˆä¼šç»§ç»­æ­£å¸¸æ‰§è¡Œï¼Œåªæ˜¯æœ€åçš„batch_sizeä¼šå°ä¸€ç‚¹ã€‚</li><li>timeout(numeric, optional):å¦‚æœæ˜¯æ­£æ•°ï¼Œè¡¨æ˜ç­‰å¾…ä»workerè¿›ç¨‹ä¸­æ”¶é›†ä¸€ä¸ªbatchç­‰å¾…æ—¶é—´ï¼Œè‹¥è¶…å‡ºè®¾å®šæ—¶é—´è¿˜æ²¡æœ‰æ”¶é›†åˆ°ï¼Œé‚£å°±ä¸æ”¶é›†è¿™ä¸ªå†…å®¹ã€‚è¿™ä¸ªnumericåº”æ€»æ˜¯å¤§äºç­‰äº0ã€‚é»˜è®¤ä¸º0</li><li>worker_init_fn (callable, optional): æ¯ä¸ªworkeråˆå§‹åŒ–å‡½æ•°ã€‚</li></ul><h2 id="å®ä¾‹"><a href="#å®ä¾‹" class="headerlink" title="å®ä¾‹"></a>å®ä¾‹</h2><h3 id="txtæ•°æ®è¯»å–"><a href="#txtæ•°æ®è¯»å–" class="headerlink" title="txtæ•°æ®è¯»å–"></a>txtæ•°æ®è¯»å–</h3><p>ä½¿ç”¨ä¸ªäººåˆ›å»ºçš„txtæ–‡ä»¶æ•°æ®ï¼Œè¿›è¡Œæ•°æ®è¯»å–æ“ä½œã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> torch.utils.data <span class="keyword">import</span> Dataset, DataLoader</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">SampleTxtDataset</span>(<span class="title class_ inherited__">Dataset</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="comment"># æ•°æ®æ–‡ä»¶åœ°å€</span></span><br><span class="line">        self.txt_file_path = <span class="string">&quot;./sample_easy_data.txt&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__getitem__</span>(<span class="params">self, item</span>):</span><br><span class="line">        txt_data = np.loadtxt(self.txt_file_path, delimiter=<span class="string">&quot;,&quot;</span>)</span><br><span class="line">        self._x = torch.from_numpy(txt_data[:, :<span class="number">2</span>])</span><br><span class="line">        self._y = torch.from_numpy(txt_data[:, <span class="number">2</span>])</span><br><span class="line">        <span class="keyword">return</span> self._x[item], self._y[item]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__len__</span>(<span class="params">self</span>):</span><br><span class="line">        txt_data = np.loadtxt(self.txt_file_path, delimiter=<span class="string">&quot;,&quot;</span>)</span><br><span class="line">        self._<span class="built_in">len</span> = <span class="built_in">len</span>(txt_data)</span><br><span class="line">        <span class="keyword">return</span> self._<span class="built_in">len</span></span><br><span class="line"></span><br><span class="line">sample_txt_dataset = SampleTxtDataset()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Data Size:&quot;</span>,<span class="built_in">len</span>(sample_txt_dataset))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;First Sample:&quot;</span>,<span class="built_in">next</span>(<span class="built_in">iter</span>(sample_txt_dataset)))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;First Sample&#x27;s Type:&quot;</span>,<span class="built_in">type</span>(<span class="built_in">next</span>(<span class="built_in">iter</span>(sample_txt_dataset))[<span class="number">0</span>]))</span><br><span class="line"></span><br><span class="line">sample_dataloader = DataLoader(dataset=sample_txt_dataset, batch_size=<span class="number">3</span>, shuffle=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">num_epochs = <span class="number">4</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> epoch <span class="keyword">in</span> <span class="built_in">range</span>(num_epochs):</span><br><span class="line">    <span class="keyword">for</span> iteration, (batch_x, batch_y) <span class="keyword">in</span> <span class="built_in">enumerate</span>(sample_dataloader):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;Epoch: &#x27;</span>, epoch, <span class="string">&#x27;| Iteration: &#x27;</span>, iteration, <span class="string">&#x27;| batch x: &#x27;</span>, batch_x.numpy(), <span class="string">&#x27;| batch y: &#x27;</span>, batch_y.numpy())</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>Datasetçš„ç¤ºä¾‹ç»“æœï¼š</p><p><img src="/2022/05/05/Pytorch%E7%B3%BB%E5%88%97%E8%87%AA%E5%AD%A6%E6%95%99%E7%A8%8B-1-%E6%95%B0%E6%8D%AE%E5%8A%A0%E8%BD%BD%E4%B9%8BDataset%E5%92%8CDataLoader%E4%BD%BF%E7%94%A8/dataset_tutorial.jpg" alt="dataset"></p><p>DataLoaderçš„ç¤ºä¾‹ç»“æœï¼š</p><p><img src="/2022/05/05/Pytorch%E7%B3%BB%E5%88%97%E8%87%AA%E5%AD%A6%E6%95%99%E7%A8%8B-1-%E6%95%B0%E6%8D%AE%E5%8A%A0%E8%BD%BD%E4%B9%8BDataset%E5%92%8CDataLoader%E4%BD%BF%E7%94%A8/dataloader_tutorial.jpg" alt="dataloader"></p><h3 id="csvæ–‡ä»¶è¯»å–"><a href="#csvæ–‡ä»¶è¯»å–" class="headerlink" title="csvæ–‡ä»¶è¯»å–"></a>csvæ–‡ä»¶è¯»å–</h3><p>ä½¿ç”¨å¸¸è§ç¦»çº¿æ•°æ®csvæ–‡ä»¶è¿›è¡Œæ•°æ®åŠ è½½å’Œé¢„å¤„ç†ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">from</span> torch.utils.data <span class="keyword">import</span> Dataset, DataLoader</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">SampleCsvDataset</span>(<span class="title class_ inherited__">Dataset</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        self.csv_file_path = <span class="string">&quot;./sample_boston.csv&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__getitem__</span>(<span class="params">self, item</span>):</span><br><span class="line">        raw_data = pd.read_csv(self.csv_file_path)</span><br><span class="line">        raw_data_shape = raw_data.shape</span><br><span class="line">        self._x  = torch.from_numpy(raw_data.iloc[:,:raw_data_shape[<span class="number">1</span>]-<span class="number">1</span>].values)</span><br><span class="line">        self._y  = torch.from_numpy(raw_data.iloc[:,raw_data_shape[<span class="number">1</span>]-<span class="number">1</span>].values)</span><br><span class="line">        <span class="keyword">return</span> self._x[item], self._y[item]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__len__</span>(<span class="params">self</span>):</span><br><span class="line">        raw_data = pd.read_csv(self.csv_file_path)</span><br><span class="line">        raw_data_shape = raw_data.shape</span><br><span class="line">        self._<span class="built_in">len</span> = raw_data_shape[<span class="number">0</span>]</span><br><span class="line">        <span class="keyword">return</span> self._<span class="built_in">len</span></span><br><span class="line"></span><br><span class="line">sample_csv_dataset = SampleCsvDataset()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Data Size:&quot;</span>,<span class="built_in">len</span>(sample_csv_dataset))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;First Sample:&quot;</span>,<span class="built_in">next</span>(<span class="built_in">iter</span>(sample_csv_dataset)))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;First Sample&#x27;s Type:&quot;</span>,<span class="built_in">type</span>(<span class="built_in">next</span>(<span class="built_in">iter</span>(sample_csv_dataset))[<span class="number">0</span>]))</span><br><span class="line"></span><br><span class="line">sample_dataloader = DataLoader(dataset=sample_csv_dataset, batch_size=<span class="number">3</span>, shuffle=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">num_epochs = <span class="number">4</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> epoch <span class="keyword">in</span> <span class="built_in">range</span>(num_epochs):</span><br><span class="line">    <span class="keyword">for</span> iteration, (batch_x, batch_y) <span class="keyword">in</span> <span class="built_in">enumerate</span>(sample_dataloader):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;Epoch: &#x27;</span>, epoch, <span class="string">&#x27;| Iteration: &#x27;</span>, iteration, <span class="string">&#x27;| batch x: &#x27;</span>, batch_x.numpy(), <span class="string">&#x27;| batch y: &#x27;</span>, batch_y.numpy())</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="mysqlæ•°æ®è¯»å–"><a href="#mysqlæ•°æ®è¯»å–" class="headerlink" title="mysqlæ•°æ®è¯»å–"></a>mysqlæ•°æ®è¯»å–</h3><p>ç”Ÿäº§è½åœ°æ•°æ®å¤šä¸ºæ•°æ®åº“ï¼Œæœ¬æ–‡ä¹Ÿé’ˆå¯¹å¸¸è§Mysqlæ•°æ®åº“è¿›è¡Œäº†æ•°æ®åŠ è½½ï¼Œä½¿ç”¨çš„æ˜¯MYSQL8.0æ•°æ®åº“çš„ç¤ºä¾‹æ•°æ®åº“sakila.paymentè¡¨è¿›è¡Œæ•°æ®è¯»å–æ¼”ç¤ºã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> pymysql</span><br><span class="line"><span class="keyword">from</span> torch.utils.data <span class="keyword">import</span> Dataset, DataLoader</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">SampleMysqlDataset</span>(<span class="title class_ inherited__">Dataset</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="comment"># åˆå§‹åŒ–MySQLæ•°æ®åº“è¿æ¥é…ç½®å‚æ•°</span></span><br><span class="line">        self.mysql_host = <span class="string">&quot;localhost&quot;</span></span><br><span class="line">        self.mysql_port = <span class="number">3307</span></span><br><span class="line">        self.mysql_user = <span class="string">&quot;utest&quot;</span></span><br><span class="line">        self.mysql_password = <span class="string">&quot;123456xyq&quot;</span></span><br><span class="line">        self.mysql_db = <span class="string">&quot;sakila&quot;</span></span><br><span class="line">        self.mysql_table = <span class="string">&quot;payment&quot;</span></span><br><span class="line">        self.mysql_charset = <span class="string">&quot;utf8&quot;</span></span><br><span class="line">        self.mysql_sql_data = <span class="string">&quot;select payment_id, customer_id, staff_id, rental_id, amount from sakila.payment&quot;</span></span><br><span class="line">        self.mysql_sql_cnt = <span class="string">&quot;select count(*) from sakila.payment&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__getitem__</span>(<span class="params">self, item</span>):</span><br><span class="line">        <span class="comment"># åˆ›å»ºæ•°æ®åº“è¿æ¥</span></span><br><span class="line">        conn = pymysql.connect(host=self.mysql_host,</span><br><span class="line">                        port=self.mysql_port,</span><br><span class="line">                        user=self.mysql_user,</span><br><span class="line">                        password=self.mysql_password,</span><br><span class="line">                        db=self.mysql_db,</span><br><span class="line">                        charset=self.mysql_charset)</span><br><span class="line">        raw_dataframe = pd.read_sql(self.mysql_sql_data, conn)</span><br><span class="line">        raw_dataframe_shape = raw_dataframe.shape</span><br><span class="line">        self._x  = torch.from_numpy(raw_dataframe.iloc[:,:raw_dataframe_shape[<span class="number">1</span>]-<span class="number">1</span>].values)</span><br><span class="line">        self._y  = torch.from_numpy(raw_dataframe.iloc[:,raw_dataframe_shape[<span class="number">1</span>]-<span class="number">1</span>].values)</span><br><span class="line">        <span class="keyword">return</span> self._x[item], self._y[item]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__len__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="comment"># åˆ›å»ºæ•°æ®åº“è¿æ¥</span></span><br><span class="line">        conn = pymysql.connect(host=self.mysql_host,</span><br><span class="line">                        port=self.mysql_port,</span><br><span class="line">                        user=self.mysql_user,</span><br><span class="line">                        password=self.mysql_password,</span><br><span class="line">                        db=self.mysql_db,</span><br><span class="line">                        charset=self.mysql_charset)</span><br><span class="line">        raw_dataframe = pd.read_sql(self.mysql_sql_data, conn)</span><br><span class="line">        raw_dataframe_shape = raw_dataframe.shape</span><br><span class="line">        self._<span class="built_in">len</span> = raw_dataframe_shape[<span class="number">0</span>]</span><br><span class="line">        <span class="keyword">return</span> self._<span class="built_in">len</span></span><br><span class="line"></span><br><span class="line">sample_mysql_dataset = SampleMysqlDataset()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Data Size:&quot;</span>,<span class="built_in">len</span>(sample_mysql_dataset))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;First Sample:&quot;</span>,<span class="built_in">next</span>(<span class="built_in">iter</span>(sample_mysql_dataset)))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;First Sample&#x27;s Type:&quot;</span>,<span class="built_in">type</span>(<span class="built_in">next</span>(<span class="built_in">iter</span>(sample_mysql_dataset))[<span class="number">0</span>]))</span><br><span class="line"></span><br><span class="line">sample_dataloader = DataLoader(dataset=sample_mysql_dataset, batch_size=<span class="number">3</span>, shuffle=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">num_epochs = <span class="number">4</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> epoch <span class="keyword">in</span> <span class="built_in">range</span>(num_epochs):</span><br><span class="line">    <span class="keyword">for</span> iteration, (batch_x, batch_y) <span class="keyword">in</span> <span class="built_in">enumerate</span>(sample_dataloader):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;Epoch: &#x27;</span>, epoch, <span class="string">&#x27;| Iteration: &#x27;</span>, iteration, <span class="string">&#x27;| batch x: &#x27;</span>, batch_x.numpy(), <span class="string">&#x27;| batch y: &#x27;</span>, batch_y.numpy())</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="ä½¿ç”¨pytorchè‡ªå¸¦æ•°æ®é›†"><a href="#ä½¿ç”¨pytorchè‡ªå¸¦æ•°æ®é›†" class="headerlink" title="ä½¿ç”¨pytorchè‡ªå¸¦æ•°æ®é›†"></a>ä½¿ç”¨pytorchè‡ªå¸¦æ•°æ®é›†</h3><p>ä¸ºæ–¹ä¾¿å¿«é€Ÿè¯•éªŒï¼ŒPytorchä¹Ÿé›†æˆäº†å¸¸è§çš„æ•°æ®é›†åœ¨torchaudioï¼Œtorchtextå’Œtorchvisionä¸­ï¼Œæœ¬ä»£ç ä½¿ç”¨torchvisionè¯»å–å¸¸ç”¨çš„å›¾åƒç®—æ³•æ•°æ®é›†MNISTï¼Œå…·ä½“ä»£ç å¦‚ä¸‹ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> torchvision <span class="keyword">import</span> datasets, transforms</span><br><span class="line"><span class="keyword">from</span> torch.utils.data <span class="keyword">import</span> DataLoader</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯¼å…¥è®­ç»ƒé›†</span></span><br><span class="line">sample_mnist_dataset = datasets.MNIST(root=<span class="string">r&#x27;./data&#x27;</span>,</span><br><span class="line">                              transform=transforms.ToTensor(),</span><br><span class="line">                              train=<span class="literal">True</span>,</span><br><span class="line">                              download=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Data Size:&quot;</span>,<span class="built_in">len</span>(sample_mnist_dataset))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;First Sample:&quot;</span>,<span class="built_in">next</span>(<span class="built_in">iter</span>(sample_mnist_dataset)))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;First Sample&#x27;s Type:&quot;</span>,<span class="built_in">type</span>(<span class="built_in">next</span>(<span class="built_in">iter</span>(sample_mnist_dataset))[<span class="number">0</span>]))</span><br><span class="line"></span><br><span class="line">sample_dataloader = DataLoader(dataset=sample_mnist_dataset, batch_size=<span class="number">3</span>, shuffle=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">num_epochs = <span class="number">4</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> epoch <span class="keyword">in</span> <span class="built_in">range</span>(num_epochs):</span><br><span class="line">    <span class="keyword">for</span> <span class="built_in">iter</span>, (batch_x, batch_y) <span class="keyword">in</span> <span class="built_in">enumerate</span>(sample_dataloader):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;Epoch: &#x27;</span>, epoch, <span class="string">&#x27;| Iteration: &#x27;</span>, <span class="built_in">iter</span>, <span class="string">&#x27;| batch x: &#x27;</span>, batch_x.numpy(), <span class="string">&#x27;| batch y: &#x27;</span>, batch_y.numpy())</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="æ¢ç´¢"><a href="#æ¢ç´¢" class="headerlink" title="æ¢ç´¢"></a>æ¢ç´¢</h2><p><img src="https://github.com/yqstar/Awesome_Pytorch_Tutorial/tree/master/Pytorch_Lesson1" alt="å®Œæ•´ä»£ç ">å·²ä¸Šä¼ Githubï¼Œæœ‰éœ€è¦çš„å¯ä»¥è‡ªè¡Œä¸‹è½½ä»£ç ï¼Œå¦‚æœå¯¹ä½ æœ‰å¸®åŠ©ï¼Œè¯·Starï¼Œå“ˆå“ˆå“ˆå“ˆï¼</p><ul><li><p>ç”Ÿäº§è¯»å–å¤§é‡æ•°æ®æ— æ³•ä¸€æ¬¡åŠ è½½åˆ°å†…å­˜è¯¥å¦‚ä½•æ“ä½œå‘¢ï¼Ÿ</p></li><li><p>å¦‚ä½•ä½¿ç”¨TorchDataè¿›è¡Œæ•°æ®è¯»å–å’Œé¢„å¤„ç†ï¼Ÿ</p></li></ul><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p>More info: <a class="link" href="https://blog.csdn.net/guyuealian/article/details/88343924">pan_jinquanï¼šDataset, DataLoaderäº§ç”Ÿè‡ªå®šä¹‰çš„è®­ç»ƒæ•°æ®<i class="fas fa-external-link-alt"></i></a></p><p>More info: <a class="link" href="https://www.jianshu.com/p/4818a1a4b5bd">å¤œå’Œå¤§å¸ï¼šDatasetç±»çš„ä½¿ç”¨<i class="fas fa-external-link-alt"></i></a></p><p>More info: <a class="link" href="https://github.com/setail/pytorch_tutorial">setailï¼špytorch_tutorial<i class="fas fa-external-link-alt"></i></a></p><p>More info: <a class="link" href="https://blog.csdn.net/xjm850552586/article/details/109137914">Ericam_ï¼šååˆ†é’Ÿææ‡‚Pytorchå¦‚ä½•è¯»å–MNISTæ•°æ®é›†<i class="fas fa-external-link-alt"></i></a></p><p>More info: <a class="link" href="https://zhuanlan.zhihu.com/p/105507334">Chenllliangï¼šä¸¤æ–‡è¯»æ‡‚PyTorchä¸­Datasetä¸DataLoaderï¼ˆä¸€ï¼‰æ‰“é€ è‡ªå·±çš„æ•°æ®é›†<i class="fas fa-external-link-alt"></i></a></p><p>More Info: <a class="link" href="https://blog.csdn.net/weixin_37913042/article/details/122129030">cici_iiiï¼šå¤§æ•°æ®é‡ä¸‹å¦‚ä½•ä½¿ç”¨Datasetå’ŒIterDatasetæ„å»ºæ•°æ®é›†<i class="fas fa-external-link-alt"></i></a></p><p>More Info: <a class="link" href="https://blog.csdn.net/sdnuwjw/article/details/111227327">csdn-WJW: å¦‚ä½•åˆ’åˆ†è®­ç»ƒé›†ï¼Œæµ‹è¯•é›†å’ŒéªŒè¯é›†<i class="fas fa-external-link-alt"></i></a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;æ·±åº¦å­¦ä¹ æ¨¡å‹ï¼ŒåŒºåˆ«äºå…¶ä»–çš„æœºå™¨å­¦ä¹ æ¨¡å‹ï¼Œä¸€æ–¹é¢ï¼Œæ¨¡å‹è®­ç»ƒæ‰€éœ€çš„æ•°æ®é‡é€šå¸¸æ˜¯éå¸¸å¤§çš„ï¼Œæ˜¯æ— æ³•ä¸€æ¬¡æ€§åŠ è½½åˆ°å†…å­˜ä¸­ï¼›å¦ä¸€æ–¹é¢ï¼Œæ¨¡å‹è®­ç»ƒå¤šé‡‡ç”¨åŸºäºæ¢¯åº¦ä¸‹é™çš„ä¼˜åŒ–æ–¹æ³•å¯¹æ¨¡å‹çš„æƒé‡å’Œåç½®è¿›è¡Œé€æ­¥è°ƒæ•´çš„ï¼Œä¸å¯èƒ½ä¸€æ¬¡æ€§åœ°åœ¨æ¨¡å‹ä¸­è¿›è¡Œæ­£å‘ä¼ æ’­å’Œåå‘ä¼ æ’­ã€‚é€šå¸¸ï¼Œæˆ‘ä»¬éœ€è¦è¿›è¡Œæ•°æ®åŠ è½½å’Œé¢„å¤„ç†å¤„ç†</summary>
      
    
    
    
    <category term="æ·±åº¦å­¦ä¹ " scheme="https://yqstar.github.io/categories/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/"/>
    
    
    <category term="Pytorch_Tutorial" scheme="https://yqstar.github.io/tags/Pytorch-Tutorial/"/>
    
  </entry>
  
  <entry>
    <title>snippets</title>
    <link href="https://yqstar.github.io/2022/05/01/snippets/"/>
    <id>https://yqstar.github.io/2022/05/01/snippets/</id>
    <published>2022-05-01T14:45:18.000Z</published>
    <updated>2022-06-04T06:50:27.778Z</updated>
    
    <content type="html"><![CDATA[<p>æœ¬åšå®¢çš„ç›®çš„ä¸»è¦æ˜¯ä¸ºäº†æ”¶é›†ä¸€äº›å¸¸ç”¨ä»£ç ï¼Œæˆ–è€…ä¸€äº›æœ‰æ„æ€çš„ä»£ç ï¼Œæ–¹ä¾¿åç»­çš„å·¥ä½œå­¦ä¹ ä½¿ç”¨ã€‚</p><p>Sklearnçš„datasetè½¬ä¸ºdataframe</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> datasets</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sklearn_to_df</span>(<span class="params">sklearn_dataset</span>):</span><br><span class="line">    df = pd.DataFrame(sklearn_dataset.data, columns=sklearn_dataset.feature_names)</span><br><span class="line">    df[<span class="string">&#x27;TARGET&#x27;</span>] = pd.Series(sklearn_dataset.target)</span><br><span class="line">    <span class="keyword">return</span> df</span><br><span class="line"></span><br><span class="line">df_boston = sklearn_to_df(datasets.load_boston())</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(df_boston.head())</span><br></pre></td></tr></table></figure><p>pymysqlè¯»å–mysqlæ•°æ®è½¬åŒ–ä¸ºdataframe</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pymysql</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">load_data_frame_from_mysql</span>():</span><br><span class="line">    conn = pymysql.connect(host=<span class="string">&quot;127.0.0.1&quot;</span>,</span><br><span class="line">                           port=<span class="number">3307</span>,</span><br><span class="line">                           user=<span class="string">&quot;utest&quot;</span>,</span><br><span class="line">                           password=<span class="string">&quot;123456xyq&quot;</span>,</span><br><span class="line">                           db=<span class="string">&quot;sakila&quot;</span>,</span><br><span class="line">                           charset=<span class="string">&quot;utf8&quot;</span>)</span><br><span class="line">    sql = <span class="string">&quot;SELECT * FROM sakila.payment&quot;</span></span><br><span class="line">    data_frame = pd.read_sql(sql, conn)</span><br><span class="line">    <span class="keyword">return</span> data_frame</span><br><span class="line">pdata = load_data_frame_from_mysql()</span><br><span class="line"><span class="built_in">print</span>(pdata.head())</span><br></pre></td></tr></table></figure><p>Imageå¤„ç†ä»£ç </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*-coding: utf-8 -*-</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    @Project: IntelligentManufacture</span></span><br><span class="line"><span class="string">    @File   : image_processing.py</span></span><br><span class="line"><span class="string">    @Author : panjq</span></span><br><span class="line"><span class="string">    @E-mail : pan_jinquan@163.com</span></span><br><span class="line"><span class="string">    @Date   : 2019-02-14 15:34:50</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> glob</span><br><span class="line"><span class="keyword">import</span> cv2</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">show_image</span>(<span class="params">title, image</span>):</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    è°ƒç”¨matplotlibæ˜¾ç¤ºRGBå›¾ç‰‡</span></span><br><span class="line"><span class="string">    :param title: å›¾åƒæ ‡é¢˜</span></span><br><span class="line"><span class="string">    :param image: å›¾åƒçš„æ•°æ®</span></span><br><span class="line"><span class="string">    :return:</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line">    <span class="comment"># plt.figure(&quot;show_image&quot;)</span></span><br><span class="line">    <span class="comment"># print(image.dtype)</span></span><br><span class="line">    plt.imshow(image)</span><br><span class="line">    plt.axis(<span class="string">&#x27;on&#x27;</span>)  <span class="comment"># å…³æ‰åæ ‡è½´ä¸º off</span></span><br><span class="line">    plt.title(title)  <span class="comment"># å›¾åƒé¢˜ç›®</span></span><br><span class="line">    plt.show()</span><br><span class="line"> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">cv_show_image</span>(<span class="params">title, image</span>):</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    è°ƒç”¨OpenCVæ˜¾ç¤ºRGBå›¾ç‰‡</span></span><br><span class="line"><span class="string">    :param title: å›¾åƒæ ‡é¢˜</span></span><br><span class="line"><span class="string">    :param image: è¾“å…¥RGBå›¾åƒ</span></span><br><span class="line"><span class="string">    :return:</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line">    channels=image.shape[-<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">if</span> channels==<span class="number">3</span>:</span><br><span class="line">        image = cv2.cvtColor(image, cv2.COLOR_RGB2BGR)  <span class="comment"># å°†BGRè½¬ä¸ºRGB</span></span><br><span class="line">    cv2.imshow(title,image)</span><br><span class="line">    cv2.waitKey(<span class="number">0</span>)</span><br><span class="line"> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">read_image</span>(<span class="params">filename, resize_height=<span class="literal">None</span>, resize_width=<span class="literal">None</span>, normalization=<span class="literal">False</span></span>):</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    è¯»å–å›¾ç‰‡æ•°æ®,é»˜è®¤è¿”å›çš„æ˜¯uint8,[0,255]</span></span><br><span class="line"><span class="string">    :param filename:</span></span><br><span class="line"><span class="string">    :param resize_height:</span></span><br><span class="line"><span class="string">    :param resize_width:</span></span><br><span class="line"><span class="string">    :param normalization:æ˜¯å¦å½’ä¸€åŒ–åˆ°[0.,1.0]</span></span><br><span class="line"><span class="string">    :return: è¿”å›çš„RGBå›¾ç‰‡æ•°æ®</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line"> </span><br><span class="line">    bgr_image = cv2.imread(filename)</span><br><span class="line">    <span class="comment"># bgr_image = cv2.imread(filename,cv2.IMREAD_IGNORE_ORIENTATION|cv2.IMREAD_COLOR)</span></span><br><span class="line">    <span class="keyword">if</span> bgr_image <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Warning:ä¸å­˜åœ¨:&#123;&#125;&quot;</span>, filename)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(bgr_image.shape) == <span class="number">2</span>:  <span class="comment"># è‹¥æ˜¯ç°åº¦å›¾åˆ™è½¬ä¸ºä¸‰é€šé“</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Warning:gray image&quot;</span>, filename)</span><br><span class="line">        bgr_image = cv2.cvtColor(bgr_image, cv2.COLOR_GRAY2BGR)</span><br><span class="line"> </span><br><span class="line">    rgb_image = cv2.cvtColor(bgr_image, cv2.COLOR_BGR2RGB)  <span class="comment"># å°†BGRè½¬ä¸ºRGB</span></span><br><span class="line">    <span class="comment"># show_image(filename,rgb_image)</span></span><br><span class="line">    <span class="comment"># rgb_image=Image.open(filename)</span></span><br><span class="line">    rgb_image = resize_image(rgb_image,resize_height,resize_width)</span><br><span class="line">    rgb_image = np.asanyarray(rgb_image)</span><br><span class="line">    <span class="keyword">if</span> normalization:</span><br><span class="line">        <span class="comment"># ä¸èƒ½å†™æˆ:rgb_image=rgb_image/255</span></span><br><span class="line">        rgb_image = rgb_image / <span class="number">255.0</span></span><br><span class="line">    <span class="comment"># show_image(&quot;src resize image&quot;,image)</span></span><br><span class="line">    <span class="keyword">return</span> rgb_image</span><br><span class="line"> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">fast_read_image_roi</span>(<span class="params">filename, orig_rect, ImreadModes=cv2.IMREAD_COLOR, normalization=<span class="literal">False</span></span>):</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    å¿«é€Ÿè¯»å–å›¾ç‰‡çš„æ–¹æ³•</span></span><br><span class="line"><span class="string">    :param filename: å›¾ç‰‡è·¯å¾„</span></span><br><span class="line"><span class="string">    :param orig_rect:åŸå§‹å›¾ç‰‡çš„æ„Ÿå…´è¶£åŒºåŸŸrect</span></span><br><span class="line"><span class="string">    :param ImreadModes: IMREAD_UNCHANGED</span></span><br><span class="line"><span class="string">                        IMREAD_GRAYSCALE</span></span><br><span class="line"><span class="string">                        IMREAD_COLOR</span></span><br><span class="line"><span class="string">                        IMREAD_ANYDEPTH</span></span><br><span class="line"><span class="string">                        IMREAD_ANYCOLOR</span></span><br><span class="line"><span class="string">                        IMREAD_LOAD_GDAL</span></span><br><span class="line"><span class="string">                        IMREAD_REDUCED_GRAYSCALE_2</span></span><br><span class="line"><span class="string">                        IMREAD_REDUCED_COLOR_2</span></span><br><span class="line"><span class="string">                        IMREAD_REDUCED_GRAYSCALE_4</span></span><br><span class="line"><span class="string">                        IMREAD_REDUCED_COLOR_4</span></span><br><span class="line"><span class="string">                        IMREAD_REDUCED_GRAYSCALE_8</span></span><br><span class="line"><span class="string">                        IMREAD_REDUCED_COLOR_8</span></span><br><span class="line"><span class="string">                        IMREAD_IGNORE_ORIENTATION</span></span><br><span class="line"><span class="string">    :param normalization: æ˜¯å¦å½’ä¸€åŒ–</span></span><br><span class="line"><span class="string">    :return: è¿”å›æ„Ÿå…´è¶£åŒºåŸŸROI</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line">    <span class="comment"># å½“é‡‡ç”¨IMREAD_REDUCEDæ¨¡å¼æ—¶ï¼Œå¯¹åº”rectä¹Ÿéœ€è¦ç¼©æ”¾</span></span><br><span class="line">    scale=<span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> ImreadModes == cv2.IMREAD_REDUCED_COLOR_2 <span class="keyword">or</span> ImreadModes == cv2.IMREAD_REDUCED_COLOR_2:</span><br><span class="line">        scale=<span class="number">1</span>/<span class="number">2</span></span><br><span class="line">    <span class="keyword">elif</span> ImreadModes == cv2.IMREAD_REDUCED_GRAYSCALE_4 <span class="keyword">or</span> ImreadModes == cv2.IMREAD_REDUCED_COLOR_4:</span><br><span class="line">        scale=<span class="number">1</span>/<span class="number">4</span></span><br><span class="line">    <span class="keyword">elif</span> ImreadModes == cv2.IMREAD_REDUCED_GRAYSCALE_8 <span class="keyword">or</span> ImreadModes == cv2.IMREAD_REDUCED_COLOR_8:</span><br><span class="line">        scale=<span class="number">1</span>/<span class="number">8</span></span><br><span class="line">    rect = np.array(orig_rect)*scale</span><br><span class="line">    rect = rect.astype(<span class="built_in">int</span>).tolist()</span><br><span class="line">    bgr_image = cv2.imread(filename,flags=ImreadModes)</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">if</span> bgr_image <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Warning:ä¸å­˜åœ¨:&#123;&#125;&quot;</span>, filename)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(bgr_image.shape) == <span class="number">3</span>:  <span class="comment">#</span></span><br><span class="line">        rgb_image = cv2.cvtColor(bgr_image, cv2.COLOR_BGR2RGB)  <span class="comment"># å°†BGRè½¬ä¸ºRGB</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        rgb_image=bgr_image <span class="comment">#è‹¥æ˜¯ç°åº¦å›¾</span></span><br><span class="line">    rgb_image = np.asanyarray(rgb_image)</span><br><span class="line">    <span class="keyword">if</span> normalization:</span><br><span class="line">        <span class="comment"># ä¸èƒ½å†™æˆ:rgb_image=rgb_image/255</span></span><br><span class="line">        rgb_image = rgb_image / <span class="number">255.0</span></span><br><span class="line">    roi_image=get_rect_image(rgb_image , rect)</span><br><span class="line">    <span class="comment"># show_image_rect(&quot;src resize image&quot;,rgb_image,rect)</span></span><br><span class="line">    <span class="comment"># cv_show_image(&quot;reROI&quot;,roi_image)</span></span><br><span class="line">    <span class="keyword">return</span> roi_image</span><br><span class="line"> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">resize_image</span>(<span class="params">image,resize_height, resize_width</span>):</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    :param image:</span></span><br><span class="line"><span class="string">    :param resize_height:</span></span><br><span class="line"><span class="string">    :param resize_width:</span></span><br><span class="line"><span class="string">    :return:</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line">    image_shape=np.shape(image)</span><br><span class="line">    height=image_shape[<span class="number">0</span>]</span><br><span class="line">    width=image_shape[<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">if</span> (resize_height <span class="keyword">is</span> <span class="literal">None</span>) <span class="keyword">and</span> (resize_width <span class="keyword">is</span> <span class="literal">None</span>):<span class="comment">#é”™è¯¯å†™æ³•ï¼šresize_height and resize_width is None</span></span><br><span class="line">        <span class="keyword">return</span> image</span><br><span class="line">    <span class="keyword">if</span> resize_height <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        resize_height=<span class="built_in">int</span>(height*resize_width/width)</span><br><span class="line">    <span class="keyword">elif</span> resize_width <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        resize_width=<span class="built_in">int</span>(width*resize_height/height)</span><br><span class="line">    image = cv2.resize(image, dsize=(resize_width, resize_height))</span><br><span class="line">    <span class="keyword">return</span> image</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">scale_image</span>(<span class="params">image,scale</span>):</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    :param image:</span></span><br><span class="line"><span class="string">    :param scale: (scale_w,scale_h)</span></span><br><span class="line"><span class="string">    :return:</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line">    image = cv2.resize(image,dsize=<span class="literal">None</span>, fx=scale[<span class="number">0</span>],fy=scale[<span class="number">1</span>])</span><br><span class="line">    <span class="keyword">return</span> image</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_rect_image</span>(<span class="params">image,rect</span>):</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    :param image:</span></span><br><span class="line"><span class="string">    :param rect: [x,y,w,h]</span></span><br><span class="line"><span class="string">    :return:</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line">    x, y, w, h=rect</span><br><span class="line">    cut_img = image[y:(y+ h),x:(x+w)]</span><br><span class="line">    <span class="keyword">return</span> cut_img</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">scale_rect</span>(<span class="params">orig_rect,orig_shape,dest_shape</span>):</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    å¯¹å›¾åƒè¿›è¡Œç¼©æ”¾æ—¶ï¼Œå¯¹åº”çš„rectangleä¹Ÿè¦è¿›è¡Œç¼©æ”¾</span></span><br><span class="line"><span class="string">    :param orig_rect: åŸå§‹å›¾åƒçš„rect=[x,y,w,h]</span></span><br><span class="line"><span class="string">    :param orig_shape: åŸå§‹å›¾åƒçš„ç»´åº¦shape=[h,w]</span></span><br><span class="line"><span class="string">    :param dest_shape: ç¼©æ”¾åå›¾åƒçš„ç»´åº¦shape=[h,w]</span></span><br><span class="line"><span class="string">    :return: ç»è¿‡ç¼©æ”¾åçš„rectangle</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line">    new_x=<span class="built_in">int</span>(orig_rect[<span class="number">0</span>]*dest_shape[<span class="number">1</span>]/orig_shape[<span class="number">1</span>])</span><br><span class="line">    new_y=<span class="built_in">int</span>(orig_rect[<span class="number">1</span>]*dest_shape[<span class="number">0</span>]/orig_shape[<span class="number">0</span>])</span><br><span class="line">    new_w=<span class="built_in">int</span>(orig_rect[<span class="number">2</span>]*dest_shape[<span class="number">1</span>]/orig_shape[<span class="number">1</span>])</span><br><span class="line">    new_h=<span class="built_in">int</span>(orig_rect[<span class="number">3</span>]*dest_shape[<span class="number">0</span>]/orig_shape[<span class="number">0</span>])</span><br><span class="line">    dest_rect=[new_x,new_y,new_w,new_h]</span><br><span class="line">    <span class="keyword">return</span> dest_rect</span><br><span class="line"> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">show_image_rect</span>(<span class="params">win_name,image,rect</span>):</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    :param win_name:</span></span><br><span class="line"><span class="string">    :param image:</span></span><br><span class="line"><span class="string">    :param rect:</span></span><br><span class="line"><span class="string">    :return:</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line">    x, y, w, h=rect</span><br><span class="line">    point1=(x,y)</span><br><span class="line">    point2=(x+w,y+h)</span><br><span class="line">    cv2.rectangle(image, point1, point2, (<span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>), thickness=<span class="number">2</span>)</span><br><span class="line">    cv_show_image(win_name, image)</span><br><span class="line"> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rgb_to_gray</span>(<span class="params">image</span>):</span><br><span class="line">    image = cv2.cvtColor(image, cv2.COLOR_RGB2GRAY)</span><br><span class="line">    <span class="keyword">return</span> image</span><br><span class="line"> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">save_image</span>(<span class="params">image_path, rgb_image,toUINT8=<span class="literal">True</span></span>):</span><br><span class="line">    <span class="keyword">if</span> toUINT8:</span><br><span class="line">        rgb_image = np.asanyarray(rgb_image * <span class="number">255</span>, dtype=np.uint8)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(rgb_image.shape) == <span class="number">2</span>:  <span class="comment"># è‹¥æ˜¯ç°åº¦å›¾åˆ™è½¬ä¸ºä¸‰é€šé“</span></span><br><span class="line">        bgr_image = cv2.cvtColor(rgb_image, cv2.COLOR_GRAY2BGR)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        bgr_image = cv2.cvtColor(rgb_image, cv2.COLOR_RGB2BGR)</span><br><span class="line">    cv2.imwrite(image_path, bgr_image)</span><br><span class="line"> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">combime_save_image</span>(<span class="params">orig_image, dest_image, out_dir,name,prefix</span>):</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    å‘½åæ ‡å‡†ï¼šout_dir/name_prefix.jpg</span></span><br><span class="line"><span class="string">    :param orig_image:</span></span><br><span class="line"><span class="string">    :param dest_image:</span></span><br><span class="line"><span class="string">    :param image_path:</span></span><br><span class="line"><span class="string">    :param out_dir:</span></span><br><span class="line"><span class="string">    :param prefix:</span></span><br><span class="line"><span class="string">    :return:</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line">    dest_path = os.path.join(out_dir, name + <span class="string">&quot;_&quot;</span>+prefix+<span class="string">&quot;.jpg&quot;</span>)</span><br><span class="line">    save_image(dest_path, dest_image)</span><br><span class="line"> </span><br><span class="line">    dest_image = np.hstack((orig_image, dest_image))</span><br><span class="line">    save_image(os.path.join(out_dir, <span class="string">&quot;&#123;&#125;_src_&#123;&#125;.jpg&quot;</span>.<span class="built_in">format</span>(name,prefix)), dest_image)</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;æœ¬åšå®¢çš„ç›®çš„ä¸»è¦æ˜¯ä¸ºäº†æ”¶é›†ä¸€äº›å¸¸ç”¨ä»£ç ï¼Œæˆ–è€…ä¸€äº›æœ‰æ„æ€çš„ä»£ç ï¼Œæ–¹ä¾¿åç»­çš„å·¥ä½œå­¦ä¹ ä½¿ç”¨ã€‚&lt;/p&gt;
&lt;p&gt;Sklearnçš„datasetè½¬ä¸ºdataframe&lt;/p&gt;
&lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;</summary>
      
    
    
    
    <category term="Snippet" scheme="https://yqstar.github.io/categories/Snippet/"/>
    
    
    <category term="Snippet" scheme="https://yqstar.github.io/tags/Snippet/"/>
    
    <category term="Python" scheme="https://yqstar.github.io/tags/Python/"/>
    
  </entry>
  
  <entry>
    <title>Windowsç³»ç»Ÿä½¿ç”¨Condaé…ç½®æ·±åº¦å­¦ä¹ ç¯å¢ƒ</title>
    <link href="https://yqstar.github.io/2022/05/01/Windows%E7%B3%BB%E7%BB%9F%E4%BD%BF%E7%94%A8Conda%E9%85%8D%E7%BD%AE%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E7%8E%AF%E5%A2%83/"/>
    <id>https://yqstar.github.io/2022/05/01/Windows%E7%B3%BB%E7%BB%9F%E4%BD%BF%E7%94%A8Conda%E9%85%8D%E7%BD%AE%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E7%8E%AF%E5%A2%83/</id>
    <published>2022-05-01T11:48:46.000Z</published>
    <updated>2022-06-03T02:14:57.699Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Condaç¯å¢ƒç®¡ç†"><a href="#Condaç¯å¢ƒç®¡ç†" class="headerlink" title="Condaç¯å¢ƒç®¡ç†"></a>Condaç¯å¢ƒç®¡ç†</h2><p>Condaæ˜¯ä¸€ä¸ªå¼€æºçš„è½¯ä»¶åŒ…ç®¡ç†ç³»ç»Ÿå’Œç¯å¢ƒç®¡ç†ç³»ç»Ÿï¼Œå¯ä»¥ç®¡ç†ä¸åŒçš„Pythonç‰ˆæœ¬ç¯å¢ƒï¼Œä¸åŒçš„ç¯å¢ƒä¹‹é—´æ˜¯äº’ç›¸éš”ç¦»ï¼Œäº’ä¸å½±å“çš„ã€‚</p><h3 id="æŸ¥çœ‹ç¯å¢ƒ"><a href="#æŸ¥çœ‹ç¯å¢ƒ" class="headerlink" title="æŸ¥çœ‹ç¯å¢ƒ"></a>æŸ¥çœ‹ç¯å¢ƒ</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹å½“å‰ç¯å¢ƒ</span></span><br><span class="line">conda info --<span class="built_in">env</span></span><br></pre></td></tr></table></figure><h3 id="å…‹éš†ç¯å¢ƒ"><a href="#å…‹éš†ç¯å¢ƒ" class="headerlink" title="å…‹éš†ç¯å¢ƒ"></a>å…‹éš†ç¯å¢ƒ</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å‡è®¾å·²æœ‰ç¯å¢ƒåä¸ºAï¼Œéœ€è¦ç”Ÿæˆçš„ç¯å¢ƒåä¸ºBï¼š</span></span><br><span class="line">conda create -n B --<span class="built_in">clone</span> A</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¦‚æœç‰¹æ®Šç¯å¢ƒä¸ºBaseï¼Œéœ€è¦é‡‡ç”¨ä»¥ä¸‹æ–¹å¼</span></span><br><span class="line">conda update conda</span><br><span class="line">conda create -n &lt;my_env&gt; --<span class="built_in">clone</span> root</span><br><span class="line">conda create -n torch_env --<span class="built_in">clone</span> root</span><br><span class="line">conda install pytorch=0.4.0 cuda90 -c pytorch</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç”¨äºå¤åˆ¶ç¯å¢ƒåˆ°æ–°çš„æœºå™¨</span></span><br><span class="line">conda list --explicit &gt; spec-file.txt</span><br><span class="line">conda create --name &lt;my_env&gt; --file spec-file.txt</span><br></pre></td></tr></table></figure><h3 id="åˆ›å»ºç¯å¢ƒ"><a href="#åˆ›å»ºç¯å¢ƒ" class="headerlink" title="åˆ›å»ºç¯å¢ƒ"></a>åˆ›å»ºç¯å¢ƒ</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ›å»ºä¸€ä¸ªç¯å¢ƒåä¸ºpy34ï¼ŒæŒ‡å®šPythonç‰ˆæœ¬æ˜¯3.4 </span></span><br><span class="line"><span class="comment">#ï¼ˆä¸ç”¨ç®¡æ˜¯3.4.xï¼Œcondaä¼šä¸ºæˆ‘ä»¬è‡ªåŠ¨å¯»æ‰¾3.4.xä¸­çš„æœ€æ–°ç‰ˆæœ¬ï¼‰ </span></span><br><span class="line">conda create --name py34 python=3.4 </span><br><span class="line"></span><br><span class="line"><span class="comment"># é€šè¿‡åˆ›å»ºç¯å¢ƒï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸åŒç‰ˆæœ¬çš„Python </span></span><br><span class="line">conda create --name py27 python=2.7</span><br></pre></td></tr></table></figure><h3 id="æ¿€æ´»ç¯å¢ƒ"><a href="#æ¿€æ´»ç¯å¢ƒ" class="headerlink" title="æ¿€æ´»ç¯å¢ƒ"></a>æ¿€æ´»ç¯å¢ƒ</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åœ¨windowsç¯å¢ƒä¸‹ä½¿ç”¨activateæ¿€æ´» </span></span><br><span class="line">activate py34</span><br><span class="line"></span><br><span class="line"><span class="comment"># åœ¨Linux &amp; Macä¸­ä½¿ç”¨source activateæ¿€æ´» </span></span><br><span class="line"><span class="built_in">source</span> activate py34 </span><br></pre></td></tr></table></figure><h3 id="é€€å‡ºç¯å¢ƒ"><a href="#é€€å‡ºç¯å¢ƒ" class="headerlink" title="é€€å‡ºç¯å¢ƒ"></a>é€€å‡ºç¯å¢ƒ</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åœ¨windowsç¯å¢ƒä¸‹ä½¿ç”¨</span></span><br><span class="line">deactivate &lt;my_env&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># åœ¨Linux &amp; Macä¸­ä½¿ç”¨</span></span><br><span class="line"><span class="built_in">source</span> deactivate &lt;my_env&gt;</span><br></pre></td></tr></table></figure><h3 id="åˆ é™¤ç¯å¢ƒ"><a href="#åˆ é™¤ç¯å¢ƒ" class="headerlink" title="åˆ é™¤ç¯å¢ƒ"></a>åˆ é™¤ç¯å¢ƒ</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å¦‚æœä½ ä¸æƒ³è¦è¿™ä¸ªåä¸ºpy34çš„ç¯å¢ƒï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤åˆ é™¤è¿™ä¸ªç¯å¢ƒã€‚ </span></span><br><span class="line">conda remove -n py34 --all </span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤æŸ¥çœ‹å·²æœ‰çš„ç¯å¢ƒåˆ—è¡¨ï¼Œç°åœ¨py34å·²ç»ä¸åœ¨è¿™ä¸ªåˆ—è¡¨é‡Œã€‚ </span></span><br><span class="line">conda info -e</span><br></pre></td></tr></table></figure><h3 id="é…ç½®é•œåƒ"><a href="#é…ç½®é•œåƒ" class="headerlink" title="é…ç½®é•œåƒ"></a>é…ç½®é•œåƒ</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ˜¾ç¤ºç›®å‰çš„channels </span></span><br><span class="line">conda config --show channels </span><br><span class="line"><span class="comment"># åˆ‡æ¢é»˜è®¤é•œåƒæº </span></span><br><span class="line">conda config --remove-key channels</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ é™¤æŒ‡å®šchannel </span></span><br><span class="line">conda config --remove channels_URL </span><br><span class="line"></span><br><span class="line"><span class="comment"># Windows ç”¨æˆ·æ— æ³•ç›´æ¥åˆ›å»ºåä¸º .condarc çš„æ–‡ä»¶ï¼Œä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ C:\Users\ç”¨æˆ·å\.condarc</span></span><br><span class="line">conda config --<span class="built_in">set</span> show_channel_urls <span class="built_in">yes</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¸­ç§‘å¤§é•œåƒæº </span></span><br><span class="line">conda config --add channels https://mirrors.ustc.edu.cn/anaconda/pkgs/main/ </span><br><span class="line">conda config --add channels https://mirrors.ustc.edu.cn/anaconda/pkgs/free/</span><br><span class="line">conda config --add channels https://mirrors.ustc.edu.cn/anaconda/cloud/conda-forge/ </span><br><span class="line">conda config --add channels https://mirrors.ustc.edu.cn/anaconda/cloud/msys2/ </span><br><span class="line">conda config --add channels https://mirrors.ustc.edu.cn/anaconda/cloud/bioconda/ </span><br><span class="line">conda config --add channels https://mirrors.ustc.edu.cn/anaconda/cloud/menpo/ </span><br><span class="line">conda config --add channels https://mirrors.ustc.edu.cn/anaconda/cloud/ </span><br><span class="line"> </span><br><span class="line"><span class="comment"># åŒ—äº¬å¤–å›½è¯­å¤§å­¦æº </span></span><br><span class="line">conda config --add channels https://mirrors.bfsu.edu.cn/anaconda/pkgs/main </span><br><span class="line">conda config --add channels https://mirrors.bfsu.edu.cn/anaconda/pkgs/free </span><br><span class="line">conda config --add channels https://mirrors.bfsu.edu.cn/anaconda/pkgs/r </span><br><span class="line">conda config --add channels https://mirrors.bfsu.edu.cn/anaconda/pkgs/pro </span><br><span class="line">conda config --add channels https://mirrors.bfsu.edu.cn/anaconda/pkgs/msys2</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¸…åæº </span></span><br><span class="line">conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main</span><br><span class="line">conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/free </span><br><span class="line">conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/r </span><br><span class="line">conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/pro </span><br><span class="line">conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/msys2 </span><br></pre></td></tr></table></figure><h2 id="Tensorflowç¯å¢ƒå®‰è£…"><a href="#Tensorflowç¯å¢ƒå®‰è£…" class="headerlink" title="Tensorflowç¯å¢ƒå®‰è£…"></a>Tensorflowç¯å¢ƒå®‰è£…</h2><p>æŸ¥çœ‹Tensorflowç‰ˆæœ¬å’Œå®‰è£…æŒ‡å®šç‰ˆæœ¬ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥è¯¢tensorflow-gpuçš„ç‰ˆæœ¬</span></span><br><span class="line">conda search tensorflow-gpu</span><br><span class="line"><span class="comment"># æŒ‡å®šç‰ˆæœ¬è¿›è¡Œå®‰è£…</span></span><br><span class="line">conda install tensorflow-gpu==1.13.1</span><br></pre></td></tr></table></figure><p><img src="/2022/05/01/Windows%E7%B3%BB%E7%BB%9F%E4%BD%BF%E7%94%A8Conda%E9%85%8D%E7%BD%AE%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E7%8E%AF%E5%A2%83/tf_install.jpg" alt="tf_install"></p><p>å®‰è£…è¿‡ç¨‹ä¸­ä¼šå®‰è£…cudatoolkit-10.0.130å’Œcudnn-7.6.5ã€‚</p><p><img src="/2022/05/01/Windows%E7%B3%BB%E7%BB%9F%E4%BD%BF%E7%94%A8Conda%E9%85%8D%E7%BD%AE%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E7%8E%AF%E5%A2%83/tf_install_info.jpg" alt="tf_install"></p><p>æ‰§è¡Œä¸‹è¿°å‘½ä»¤æŸ¥çœ‹tfç‰ˆæœ¬å’ŒGPUæ˜¯å¦ç”Ÿæ•ˆã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">æŸ¥çœ‹æ˜¯å¦å®‰è£…æˆåŠŸ</span><br><span class="line"><span class="keyword">import</span> tensorflow <span class="keyword">as</span> tf</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‰“å°Tensorflowç‰ˆæœ¬</span></span><br><span class="line"><span class="built_in">print</span>(tf.__version__)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‰“å°æ˜¯å¦æ”¯æŒGPU</span></span><br><span class="line"><span class="built_in">print</span>(tf.test.is_gpu_available())</span><br></pre></td></tr></table></figure><p>æ ¹æ®å›¾ç‰‡æ‰“å°ç»“æœï¼ŒæˆåŠŸå®‰è£…tf 1.13.1 ç‰ˆæœ¬ï¼ŒåŒæ—¶GPUå®‰è£…ç”Ÿæ•ˆã€‚</p><p><img src="/2022/05/01/Windows%E7%B3%BB%E7%BB%9F%E4%BD%BF%E7%94%A8Conda%E9%85%8D%E7%BD%AE%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E7%8E%AF%E5%A2%83/tf_version.jpg" alt="tf_version"></p><h2 id="Pytorchç¯å¢ƒå®‰è£…"><a href="#Pytorchç¯å¢ƒå®‰è£…" class="headerlink" title="Pytorchç¯å¢ƒå®‰è£…"></a>Pytorchç¯å¢ƒå®‰è£…</h2><p>æ‰§è¡Œä¸‹è¿°å‘½ä»¤å®‰è£…Pytorchã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">conda install pytorch==1.7.0 torchvision==0.8.0 torchaudio==0.7.0 cudatoolkit=10.1 -c pytorch</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œä¸‹è¿°å‘½ä»¤æŸ¥çœ‹torchç‰ˆæœ¬å’ŒGPUæ˜¯å¦ç”Ÿæ•ˆã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(torch.__version__)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(torch.cuda.is_available())</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æ ¹æ®å›¾ç‰‡æ‰“å°ç»“æœï¼ŒæˆåŠŸå®‰è£…Pytorch 1.7.0 ç‰ˆæœ¬ï¼ŒåŒæ—¶GPUå®‰è£…ç”Ÿæ•ˆã€‚</p><p><img src="/2022/05/01/Windows%E7%B3%BB%E7%BB%9F%E4%BD%BF%E7%94%A8Conda%E9%85%8D%E7%BD%AE%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E7%8E%AF%E5%A2%83/torch_version.jpg" alt="torch_version"></p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ul><li><p>More info: <a class="link" href="https://blog.csdn.net/zhayushui/article/details/80433768?utm_medium=distribute.pc_relevant_t0.none-task-blog-BlogCommendFromMachineLearnPai2-1.nonecase&amp;depth_1-utm_source=distribute.pc_relevant_t0.none-task-blog-BlogCommendFromMachineLearnPai2-1.nonecase">é˜¿å°”å‘goï¼šcondaå¸¸ç”¨å‘½ä»¤<i class="fas fa-external-link-alt"></i></a></p></li><li><p>More info: <a class="link" href="https://www.jianshu.com/p/edaa744ea47d">å–èŒå“¥ï¼šcondaçš„å®‰è£…ä¸ä½¿ç”¨<i class="fas fa-external-link-alt"></i></a></p></li><li><p>More info: <a class="link" href="https://www.cnblogs.com/liuhuacai/p/11684666.html">æ— èŠå°±çœ‹ä¹¦ï¼šTensorflow-gpu1.13.1 å’Œ Tensorflow-gpu2.0.0å…±å­˜ä¹‹å®‰è£…æ•™ç¨‹<i class="fas fa-external-link-alt"></i></a></p></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;Condaç¯å¢ƒç®¡ç†&quot;&gt;&lt;a href=&quot;#Condaç¯å¢ƒç®¡ç†&quot; class=&quot;headerlink&quot; title=&quot;Condaç¯å¢ƒç®¡ç†&quot;&gt;&lt;/a&gt;Condaç¯å¢ƒç®¡ç†&lt;/h2&gt;&lt;p&gt;Condaæ˜¯ä¸€ä¸ªå¼€æºçš„è½¯ä»¶åŒ…ç®¡ç†ç³»ç»Ÿå’Œç¯å¢ƒç®¡ç†ç³»ç»Ÿï¼Œå¯ä»¥ç®¡ç†ä¸åŒçš„Pythonç‰ˆæœ¬ç¯</summary>
      
    
    
    
    
    <category term="Conda" scheme="https://yqstar.github.io/tags/Conda/"/>
    
  </entry>
  
  <entry>
    <title>ä½¿ç”¨GithubPagesæ­å»ºä¸ªäººé™æ€åšå®¢</title>
    <link href="https://yqstar.github.io/2022/05/01/%E4%BD%BF%E7%94%A8GithubPages%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E9%9D%99%E6%80%81%E5%8D%9A%E5%AE%A2/"/>
    <id>https://yqstar.github.io/2022/05/01/%E4%BD%BF%E7%94%A8GithubPages%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E9%9D%99%E6%80%81%E5%8D%9A%E5%AE%A2/</id>
    <published>2022-05-01T02:14:29.000Z</published>
    <updated>2022-05-20T11:33:33.043Z</updated>
    
    <content type="html"><![CDATA[<h2 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h2><p><strong>GitHub Pages</strong> æ˜¯ä½¿ç”¨ GitHub å­˜å‚¨ä»“åº“æ‰˜ç®¡é™æ€ç½‘ç«™ï¼Œä½¿ç”¨ YAML å’Œ Markdown ç­‰æ ‡å‡†æŠ€æœ¯ï¼Œä»»ä½•äººéƒ½å¯ä»¥åœ¨å‡ åˆ†é’Ÿå†…ç”Ÿæˆå’Œç»´æŠ¤ç½‘ç«™ï¼Œä½†å®ƒä¸ä»…ä»…æ˜¯é™æ€æ–‡ä»¶çš„é›†åˆã€‚é€šè¿‡åˆ©ç”¨ Jekyll å’Œ Liquid ç­‰ç½‘ç«™ç”ŸæˆæŠ€æœ¯ï¼Œå¼€å‘äººå‘˜å¯å®šä¹‰å®Œæ•´é™æ€ç½‘ç«™çš„åŠ¨æ€æ¨¡æ¿ã€‚æ¯æ¬¡å°†æ›´æ”¹æäº¤åˆ°ä¸ç½‘ç«™å…³è”çš„æºä»£ç åˆ†æ”¯æ—¶ï¼Œéƒ½ä¼šä½¿ç”¨æºä»£ç åˆ†æ”¯çš„æœ€æ–°ä»£ç é…ç½®é‡æ–°ç”Ÿæˆé™æ€ç½‘é¡µï¼ŒGithub è‡ªåŠ¨å°†å…¶å‘å¸ƒåˆ°ç›®æ ‡ URLã€‚æ¬¢è¿å…³æ³¨ï¼š<a href="https://yqstar.github.io/">æˆ‘çš„åšå®¢</a>ã€‚</p><h2 id="ç¯å¢ƒé…ç½®"><a href="#ç¯å¢ƒé…ç½®" class="headerlink" title="ç¯å¢ƒé…ç½®"></a>ç¯å¢ƒé…ç½®</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">æ“ä½œç³»ç»Ÿï¼šWindows11 -&gt; WSL2 -&gt; Ubuntu 22.04 LTS</span><br><span class="line">Node.js: v16.15.0</span><br><span class="line">Npm: 8.5.5</span><br></pre></td></tr></table></figure><h2 id="æ“ä½œéƒ¨ç½²"><a href="#æ“ä½œéƒ¨ç½²" class="headerlink" title="æ“ä½œéƒ¨ç½²"></a>æ“ä½œéƒ¨ç½²</h2><h3 id="å®‰è£…NVM"><a href="#å®‰è£…NVM" class="headerlink" title="å®‰è£…NVM"></a>å®‰è£…NVM</h3><p>åœ¨å®‰è£…nvmä¹‹å‰ç®€å•ä»‹ç»ä¸‹nvmï¼Œnodejså’Œnpmä¹‹é—´çš„å…³ç³»ã€‚</p><ul><li>nvmï¼š<em>nodejs</em> çš„ç‰ˆæœ¬ç®¡ç†å·¥å…·ã€‚</li><li>nodejsï¼šé¡¹ç›®å¼€å‘æ‰€éœ€è¦çš„ä»£ç åº“ã€‚</li><li>npmï¼š<em>nodejs</em> åŒ…ç®¡ç†å·¥å…·ï¼Œ<em>npm</em> ç®¡ç†<em>nodejs</em>ä¸­çš„ç¬¬ä¸‰æ–¹æ’ä»¶ã€‚</li></ul><p>å‚è€ƒ <a class="link" href="https://github.com/nvm-sh/nvm">NPM-GITHUB<i class="fas fa-external-link-alt"></i></a>ï¼Œä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å®‰è£…nvmã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget -qO- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.1/install.sh | bash</span><br></pre></td></tr></table></figure><p>å®‰è£…è¿‡ç¨‹Infoæˆªå›¾å¦‚ä¸‹ï¼š</p><p><img src="/2022/05/01/%E4%BD%BF%E7%94%A8GithubPages%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E9%9D%99%E6%80%81%E5%8D%9A%E5%AE%A2/nvm_install.png" alt="NVMå®‰è£…æˆªå›¾"></p><p>åˆ¤æ–­nvmå®‰è£…æ˜¯å¦æˆåŠŸ,å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æŸ¥çœ‹nvmçš„ç‰ˆæœ¬ä¿¡æ¯ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nvm -v</span><br></pre></td></tr></table></figure><p><img src="/2022/05/01/%E4%BD%BF%E7%94%A8GithubPages%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E9%9D%99%E6%80%81%E5%8D%9A%E5%AE%A2/nvm_version.png" alt="NVMç‰ˆæœ¬æˆªå›¾"></p><h3 id="å®‰è£…NODEJS"><a href="#å®‰è£…NODEJS" class="headerlink" title="å®‰è£…NODEJS"></a>å®‰è£…NODEJS</h3><p>ä½¿ç”¨ <em>nvm install</em> å‘½ä»¤å¯ä»¥å®‰è£…æŒ‡å®šç‰ˆæœ¬çš„NodeJsï¼Œæœ¬æ¬¡å®‰è£…v16ç‰ˆæœ¬ï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nvm install 16</span><br></pre></td></tr></table></figure><p>é€šè¿‡ä¸‹è¿°å‘½ä»¤æŸ¥çœ‹nodeå’Œnpmçš„ç‰ˆæœ¬ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">node -v</span><br><span class="line">npm -v</span><br></pre></td></tr></table></figure><p>å¯æŸ¥çœ‹åˆ°Nodeå’Œnpmçš„ç‰ˆæœ¬ã€‚</p><p><img src="/2022/05/01/%E4%BD%BF%E7%94%A8GithubPages%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E9%9D%99%E6%80%81%E5%8D%9A%E5%AE%A2/npm_node_version.png" alt="NVMç‰ˆæœ¬æˆªå›¾"></p><h2 id="å®‰è£…Hexoå’Œé…ç½®"><a href="#å®‰è£…Hexoå’Œé…ç½®" class="headerlink" title="å®‰è£…Hexoå’Œé…ç½®"></a>å®‰è£…Hexoå’Œé…ç½®</h2><h3 id="å®‰è£…Hexoå‘½ä»¤è¡Œ"><a href="#å®‰è£…Hexoå‘½ä»¤è¡Œ" class="headerlink" title="å®‰è£…Hexoå‘½ä»¤è¡Œ"></a>å®‰è£…Hexoå‘½ä»¤è¡Œ</h3><p>Hexoæ˜¯ä¸€ä¸ªå¿«é€Ÿã€ç®€æ´ä¸”é«˜æ•ˆçš„åšå®¢æ¡†æ¶ï¼Œå®˜æ–¹æä¾›ä¸€ä¸ªå‘½ä»¤è¡Œå·¥å…·ï¼Œç”¨äºå¿«é€Ÿåˆ›å»ºé¡¹ç›®ã€é¡µé¢ã€ç¼–è¯‘ã€éƒ¨ç½²Hexoåšå®¢ï¼Œå®‰è£…å‘½ä»¤è¡Œå·¥å…·ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -g hexo-cli</span><br></pre></td></tr></table></figure><h3 id="åˆå§‹åŒ–æœ¬åœ°è¿è¡Œ"><a href="#åˆå§‹åŒ–æœ¬åœ°è¿è¡Œ" class="headerlink" title="åˆå§‹åŒ–æœ¬åœ°è¿è¡Œ"></a>åˆå§‹åŒ–æœ¬åœ°è¿è¡Œ</h3><p>æ¥ä¸‹æ¥æˆ‘ä»¬ä½¿ç”¨ Hexo å‘½ä»¤è¡Œåˆ›å»ºä¸€ä¸ªé¡¹ç›®ï¼Œå¹¶å°†å…¶åœ¨æœ¬åœ°è·‘èµ·æ¥ï¼Œæ•´ä½“è·‘é€šçœ‹çœ‹ã€‚</p><p>é¦–å…ˆä½¿ç”¨å¦‚ä¸‹å‘½ä»¤åˆ›å»ºé¡¹ç›®ï¼š<strong>hexo init {blog_name}</strong>ï¼Œè¿™é‡Œçš„ blog_name å°±æ˜¯åšå®¢åï¼Œæˆ‘è¿™é‡Œè¦åˆ›å»º <em>hexo_blog</em> çš„åšå®¢ï¼Œæˆ‘å°±æŠŠé¡¹ç›®å–åä¸º hexo_blog ï¼Œå‘½ä»¤å¦‚ä¸‹ï¼šhexo init hexo_blogã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">hexo init &#123;blog_name&#125;</span><br><span class="line"><span class="built_in">cd</span> &#123;blog_name&#125;</span><br><span class="line">npm install</span><br><span class="line">hexo server</span><br></pre></td></tr></table></figure><p>hexo_blog æ–‡ä»¶å¤¹ä¸‹å°±ä¼šå‡ºç° Hexo çš„åˆå§‹åŒ–æ–‡ä»¶ï¼ŒåŒ…æ‹¬ themesã€scaffoldsã€source ç­‰æ–‡ä»¶å¤¹ã€‚</p><p><img src="/2022/05/01/%E4%BD%BF%E7%94%A8GithubPages%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E9%9D%99%E6%80%81%E5%8D%9A%E5%AE%A2/hexo_init.png" alt="Hexoåˆå§‹åŒ–"></p><p>æ¥ä¸‹æ¥æˆ‘ä»¬é¦–å…ˆè¿›å…¥æ–°ç”Ÿæˆçš„æ–‡ä»¶å¤¹é‡Œé¢ï¼Œç„¶åè°ƒç”¨ Hexo çš„ generate å‘½ä»¤ï¼Œå°† Hexo ç¼–è¯‘ç”Ÿæˆ HTML ä»£ç ï¼Œå‘½ä»¤å¦‚ä¸‹ï¼šhexo generateå¯ä»¥çœ‹åˆ°è¾“å‡ºç»“æœé‡Œé¢åŒ…å«äº† jsã€cssã€font ç­‰å†…å®¹ï¼Œå¹¶å‘ç°ä»–ä»¬éƒ½å¤„åœ¨äº†é¡¹ç›®æ ¹ç›®å½•ä¸‹çš„ public æ–‡ä»¶å¤¹ä¸‹é¢äº†ã€‚</p><p>ç„¶åä½¿ç”¨ Hexo æä¾›çš„ server å‘½ä»¤æŠŠåšå®¢åœ¨æœ¬åœ°è¿è¡Œèµ·æ¥ï¼Œå‘½ä»¤å¦‚ä¸‹ï¼šhexo server è¿è¡Œä¹‹åå‘½ä»¤è¡Œè¾“å‡ºå¦‚ä¸‹ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">INFO  Start processing</span><br><span class="line">INFO  Hexois running at http://localhost:4000 . Press Ctrl+C to stop.</span><br></pre></td></tr></table></figure><p>æœ¬åœ° 4000 ç«¯å£ä¸Šå°±å¯ä»¥æŸ¥çœ‹åšå®¢ç«™ç‚¹ï¼Œå¦‚å›¾æ‰€ç¤ºï¼š</p><p><img src="/2022/05/01/%E4%BD%BF%E7%94%A8GithubPages%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E9%9D%99%E6%80%81%E5%8D%9A%E5%AE%A2/hexo_server.png" alt="Hexoåˆå§‹åŒ–"></p><h3 id="ä¸»é¢˜é…ç½®"><a href="#ä¸»é¢˜é…ç½®" class="headerlink" title="ä¸»é¢˜é…ç½®"></a>ä¸»é¢˜é…ç½®</h3><p>ç™»å½•å®˜ç½‘<a class="link" href="https://hexo.io/zh-cn/">Hexoå®˜ç½‘<i class="fas fa-external-link-alt"></i></a>,ç„¶åç‚¹å‡»ä¸»é¢˜é¡µé¢<a class="link" href="https://hexo.io/themes/">Themeä¸»é¢˜<i class="fas fa-external-link-alt"></i></a>ï¼Œé€‰æ‹©ä¸€ä¸ªå–œæ¬¢ä¸»é¢˜ï¼Œæˆ‘è¿™è¾¹é€‰æ‹©çš„ä¸»é¢˜æ˜¯<br><a class="link" href="https://keep-docs.xpoet.cn/usage-tutorial/configuration-guide.html#base-info">keepä¸»é¢˜<i class="fas fa-external-link-alt"></i></a>ã€‚<br>æ‰§è¡Œå®‰è£…å‘½ä»¤ï¼Œä¼šå°†ä¸»é¢˜æ–‡ä»¶å®‰è£…åœ¨node_modulesæ–‡ä»¶å¤¹ä¸­ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-theme-keep --save</span><br></pre></td></tr></table></figure><p><img src="/2022/05/01/%E4%BD%BF%E7%94%A8GithubPages%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E9%9D%99%E6%80%81%E5%8D%9A%E5%AE%A2/keep_theme_path.png" alt="ä¸»é¢˜å­˜æ”¾è·¯å¾„"></p><p>æ‰§è¡Œhexo serverå‘½ä»¤æ‰§è¡Œæœ¬åœ°æŸ¥çœ‹ã€‚</p><p>å¯ä»¥çœ‹å‡ºæ­¤æ—¶æ•°æ®å·²ç»æ›´æ–°æˆkeepä¸»é¢˜ã€‚</p><h2 id="éƒ¨ç½²åˆ°Github"><a href="#éƒ¨ç½²åˆ°Github" class="headerlink" title="éƒ¨ç½²åˆ°Github"></a>éƒ¨ç½²åˆ°Github</h2><p>æ‰§è¡Œéƒ¨ç½²åˆ°Githubéœ€è¦ä½¿ç”¨hexo-deployer-gitæ’ä»¶</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-deployer-git --save</span><br></pre></td></tr></table></figure><p>å®‰è£…å¥½hexo-deployer-gitåå¯ä»¥è¿›è¡Œæ–‡ä»¶çš„é…ç½®ã€‚<br>å…·ä½“é…ç½®å¦‚ä¸‹ï¼š</p><p><img src="/2022/05/01/%E4%BD%BF%E7%94%A8GithubPages%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E9%9D%99%E6%80%81%E5%8D%9A%E5%AE%A2/deploy_settings.png" alt="ä¸»é¢˜å­˜æ”¾è·¯å¾„"></p><p>åœ¨è¿™ä¹‹å‰éœ€è¦githubé…ç½®ç›¸åº”çš„ä»“åº“ï¼Œæˆ‘é…ç½®çš„ä»“åº“åä¸ºï¼šyqstar.github.io.</p><p><img src="/2022/05/01/%E4%BD%BF%E7%94%A8GithubPages%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E9%9D%99%E6%80%81%E5%8D%9A%E5%AE%A2/deploy_online.png" alt="çº¿ä¸Šéƒ¨ç½²"></p><p><img src="/2022/05/01/%E4%BD%BF%E7%94%A8GithubPages%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E9%9D%99%E6%80%81%E5%8D%9A%E5%AE%A2/deploy_github.png" alt="çº¿ä¸Šéƒ¨ç½²"></p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p>MoreInfo:<a class="link" href="https://github.com/xcodebuild/hexo-asset-image">hexo-asset-imageæ’ä»¶<i class="fas fa-external-link-alt"></i></a><br>MoreInfo:<a class="link" href="https://blog.csdn.net/fitnig/article/details/106522811">å¦‚ä½•ä½¿ç”¨æœ¬åœ°æ’å…¥å›¾ç‰‡<i class="fas fa-external-link-alt"></i></a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;åŸç†&quot;&gt;&lt;a href=&quot;#åŸç†&quot; class=&quot;headerlink&quot; title=&quot;åŸç†&quot;&gt;&lt;/a&gt;åŸç†&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;GitHub Pages&lt;/strong&gt; æ˜¯ä½¿ç”¨ GitHub å­˜å‚¨ä»“åº“æ‰˜ç®¡é™æ€ç½‘ç«™ï¼Œä½¿ç”¨ YAML å’Œ Markdown</summary>
      
    
    
    
    
  </entry>
  
</feed>
