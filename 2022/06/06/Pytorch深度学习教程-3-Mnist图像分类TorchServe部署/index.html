<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta name="google-site-verification" content="MmV_OLj--Ry5XArea1wMvMsWhdieJvLHUytRp0NkmBE" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="keywords" content="Hexo Theme Keep">
    <meta name="description" content="Hexo Theme Keep">
    <meta name="author" content="AiLab123">
    
    <title>
        
            Pytorchæ·±åº¦å­¦ä¹ æ•™ç¨‹(3):Mnistå›¾åƒåˆ†ç±»TorchServeéƒ¨ç½² |
        
        AiLab123
    </title>
    
<link rel="stylesheet" href="/css/style.css">

    <link rel="shortcut icon" href="/images/ai.svg">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/css/font-awesome.min.css">
    <script id="hexo-configurations">
    let KEEP = window.KEEP || {};
    KEEP.hexo_config = {"hostname":"yqstar.github.io","root":"/","language":"zh-CN","path":"search.json"};
    KEEP.theme_config = {"toc":{"enable":true,"number":true,"expand_all":true,"init_open":true},"style":{"primary_color":"#0066CC","avatar":"/images/ai.svg","favicon":"/images/ai.svg","article_img_align":"left","left_side_width":"260px","content_max_width":"920px","hover":{"shadow":false,"scale":false},"first_screen":{"enable":true,"background_img":"/images/bg.svg","description":"äººå¾€å¾€ä¼šå¯¹æœªçŸ¥çš„äº‹æƒ…äº§ç”Ÿææƒ§ï¼Œå› ä¸ºç»“å±€æ˜¯æœªçŸ¥çš„ã€‚"},"scroll":{"progress_bar":{"enable":false},"percent":{"enable":true}}},"local_search":{"enable":true,"preload":false},"code_copy":{"enable":true,"style":"mac"},"pjax":{"enable":true},"lazyload":{"enable":false},"version":"3.4.5"};
    KEEP.language_ago = {"second":"%s ç§’å‰","minute":"%s åˆ†é’Ÿå‰","hour":"%s å°æ—¶å‰","day":"%s å¤©å‰","week":"%s å‘¨å‰","month":"%s ä¸ªæœˆå‰","year":"%s å¹´å‰"};
  </script>
<meta name="generator" content="Hexo 6.1.0"><link rel="alternate" href="/atom.xml" title="AndrewYq" type="application/atom+xml">
</head>


<body>
<div class="progress-bar-container">
    

    
        <span class="pjax-progress-bar"></span>
        <span class="pjax-progress-icon">
            <i class="fas fa-circle-notch fa-spin"></i>
        </span>
    
</div>


<main class="page-container">

    

    <div class="page-main-content">

        <div class="page-main-content-top">
            <header class="header-wrapper">

    <div class="header-content">
        <div class="left">
            
            <a class="logo-title" href="/">
                AiLab123
            </a>
        </div>

        <div class="right">
            <div class="pc">
                <ul class="menu-list">
                    
                        <li class="menu-item">
                            <a class=""
                               href="/"
                            >
                                é¦–é¡µ
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/archives"
                            >
                                å½’æ¡£
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/categories"
                            >
                                åˆ†ç±»
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/tags"
                            >
                                æ ‡ç­¾
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/links"
                            >
                                å‹é“¾
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/about"
                            >
                                å…³äº
                            </a>
                        </li>
                    
                    
                        <li class="menu-item search search-popup-trigger">
                            <i class="fas fa-search"></i>
                        </li>
                    
                </ul>
            </div>
            <div class="mobile">
                
                    <div class="icon-item search search-popup-trigger"><i class="fas fa-search"></i></div>
                
                <div class="icon-item menu-bar">
                    <div class="menu-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="header-drawer">
        <ul class="drawer-menu-list">
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/">é¦–é¡µ</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/archives">å½’æ¡£</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/categories">åˆ†ç±»</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/tags">æ ‡ç­¾</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/links">å‹é“¾</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/about">å…³äº</a>
                </li>
            
        </ul>
    </div>

    <div class="window-mask"></div>

</header>


        </div>

        <div class="page-main-content-middle">

            <div class="main-content">

                
                    <div class="fade-in-down-animation">
    <div class="article-content-container">

        <div class="article-title">
            <span class="title-hover-animation">Pytorchæ·±åº¦å­¦ä¹ æ•™ç¨‹(3):Mnistå›¾åƒåˆ†ç±»TorchServeéƒ¨ç½²</span>
        </div>

        
            <div class="article-header">
                <div class="avatar">
                    <img src="/images/ai.svg">
                </div>
                <div class="info">
                    <div class="author">
                        <span class="name">AiLab123</span>
                        
                            <span class="author-label">AIè°ƒå‚å¸ˆ</span>
                        
                    </div>
                    <div class="meta-info">
                        <div class="article-meta-info">
    <span class="article-date article-meta-item">
        <i class="fas fa-edit"></i>&nbsp;
        <span class="pc">2022-06-06 18:05:23</span>
        <span class="mobile">2022-06-06 18:05</span>
    </span>
    
    
        <span class="article-tags article-meta-item">
            <i class="fas fa-tags"></i>&nbsp;
            <ul>
                
                    <li>
                        <a href="/tags/Pytorch-Tutorial/">Pytorch_Tutorial</a>&nbsp;
                    </li>
                
            </ul>
        </span>
    

    
    
        <span class="article-wordcount article-meta-item">
            <i class="fas fa-file-word"></i>&nbsp;<span>2.4k å­—</span>
        </span>
    
    
        <span class="article-min2read article-meta-item">
            <i class="fas fa-clock"></i>&nbsp;<span>11 åˆ†é’Ÿ</span>
        </span>
    
    
        <span class="article-pv article-meta-item">
            <i class="fas fa-eye"></i>&nbsp;<span id="busuanzi_value_page_pv"></span>
        </span>
    
</div>

                    </div>
                </div>
            </div>
        

        <div class="article-content markdown-body">
            <h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>ç»è¿‡å‰ <a href="https://yqstar.github.io/tags/Pytorch-Tutorial/">ä¸¤ç¯‡åšå®¢</a> å­¦ä¹ ï¼Œæˆ‘ä»¬å·²å¯ä½¿ç”¨CNNæ¨¡å‹å®ŒæˆMnistæ‰‹å†™æ•°å­—åˆ†ç±»æ¨¡å‹ï¼Œå¯¹äºç®—æ³•ä»æ•°æ®å¤„ç†ã€æ¨¡å‹æ„å»ºã€æ¨¡å‹è®­ç»ƒå’Œè¯„ä¼°é“¾è·¯æœ‰åˆæ­¥è®¤çŸ¥ã€‚ä½†å·¥ä¸šå¯èƒ½éœ€è¦éƒ¨ç½²ç¦»çº¿åœ¨çº¿æ¨¡å‹ç”¨äºæä¾›æ¨¡å‹æ¨ç†æœåŠ¡ï¼Œæ‰€è°“æ¨¡å‹æ¨ç†æœåŠ¡æ˜¯æŒ‡åœ¨ç³»ç»Ÿé…ç½®è®­ç»ƒå®Œæˆæœºå™¨å­¦ä¹ æ¨¡å‹ï¼Œä»¥ä¾¿å…¶å¯æ¥å—æ–°çš„è¾“å…¥å¹¶å°†æ¨ç†ç»“æœè¿”å›ç»™ç³»ç»Ÿã€‚</p>
<p>å…¶æ¬¡ï¼Œè™½ç„¶å¾ˆå¤šå¤§å‚éƒ½ä¼šæœ‰å°è£…å¥½éƒ¨ç½²å¹³å°ä¾›ç®—æ³•äººå‘˜ä¾¿æ·é…ç½®ï¼Œä½†æ˜¯å­¦ä¹ ä¸­å¯¹äºå®Œæ•´çš„å·¥ç¨‹é“¾è·¯å¼€å‘å¯¹äºä¸ªäººèƒ½åŠ›å»ºè®¾ä¹Ÿæ˜¯éå¸¸é‡è¦çš„ï¼Œè€Œä¸æ˜¯ä»…ä»…ä½œä¸ºä¸€é¢—èºä¸é’‰ï¼Œå¦‚ä½•å®ç°ä»Demoæ¨¡å‹è½¬æ¢æˆçº¿ä¸Šæ¨¡å‹æ¨ç†æœåŠ¡éƒ¨ç½²ï¼Œå¯¹äºä¸ªäººçš„æ­£å‘åé¦ˆä¹Ÿæ˜¯éå¸¸æœ‰æ„ä¹‰çš„ã€‚</p>
<p>é‚£ä¹ˆé’ˆå¯¹ <em>PyTorch</em> è®­ç»ƒå¥½ Demo æ¨¡å‹ï¼Œå¦‚ä½•éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒç”¨äºæä¾›æ¨¡å‹æ¨ç†æœåŠ¡å‘¢ï¼Ÿéƒ¨ç½²å½¢å¼éå¸¸å¤šæ ·ï¼Œå…¶ä¸­ TorchServe æ˜¯ <a class="link" target="_blank" rel="noopener" href="https://pytorch.org/serve/index.html">PyTorchå¼€æºé¡¹ç›®<i class="fas fa-external-link-alt"></i></a> éƒ¨åˆ†ï¼Œæ˜¯AWSå’ŒFacebookåˆä½œå¼€å‘çš„ç”¨äºéƒ¨ç½²Pytorchçš„æ¨¡å‹ï¼Œå¯¹äºç®—æ³•å·¥ç¨‹å¸ˆæ˜¯ç›¸å½“å‹å¥½çš„ã€‚æœ¬ç« ä»‹ç»å¦‚ä½•ä½¿ç”¨TorchServeå®ŒæˆPyTorchæ¨¡å‹çš„éƒ¨ç½²å’Œè°ƒç”¨ã€‚</p>
<h2 id="TorchServeç®€ä»‹"><a href="#TorchServeç®€ä»‹" class="headerlink" title="TorchServeç®€ä»‹"></a>TorchServeç®€ä»‹</h2><p>Torchserveæ˜¯PyTorchçš„é¦–é€‰æ¨¡å‹éƒ¨ç½²è§£å†³æ–¹æ¡ˆã€‚å®ƒå…è®¸ä¸ºæ¨¡å‹å…¬å¼€ä¸€ä¸ªå¯ä¾›ç›´æ¥è®¿é—®æˆ–è€…åº”ç”¨ç¨‹åºè®¿é—®çš„WebAPIï¼Œå€ŸåŠ©TorchServeï¼ŒPyTorchç”¨æˆ·å¯ä»¥æ›´å¿«åœ°å°†å…¶æ¨¡å‹åº”ç”¨äºç”Ÿäº§ï¼Œè€Œæ— éœ€ç¼–å†™è‡ªå®šä¹‰ä»£ç ï¼Œæ­¤å¤–ï¼ŒTorchServeå°†å·¥ç¨‹å¼€å‘å’Œç®—æ³•å¼€å‘è¿›è¡Œè§£è€¦ï¼Œç®—æ³•å·¥ç¨‹å¸ˆä¸»è¦å®Œæˆæ•°æ®Processå’Œæ¨¡å‹æ„å»ºè¿™ä¸€æ“…é•¿é¢†åŸŸï¼Œå…¶ä»–çš„å¤šæ¨¡å‹æœåŠ¡ã€A/Bæµ‹è¯•çš„ç‰ˆæœ¬æ§åˆ¶ã€ç›‘è§†æŒ‡æ ‡ä»¥åŠåº”ç”¨ç¨‹åºé›†æˆRESTfuléƒ½å·²å°è£…å¥½ã€‚</p>
<blockquote>
<p>TorchServe is a performant, flexible and easy to use tool for serving PyTorch eager mode and torschripted models.</p>
</blockquote>
<p>å®˜ç½‘ä»‹ç»å¯çœ‹å‡ºï¼šTorchServeæ˜¯ä¸€æ¬¾æ€§èƒ½å¥½ã€çµæ´»æ€§å¥½ã€æ˜“ä½¿ç”¨çš„å·¥å…·ï¼Œå…¶æ¬¡å¯éƒ¨ç½²æ¨¡å‹ç±»å‹æ˜¯Pytorchçš„Eageræ¨¡å¼å’ŒScriptæ¨¡å¼æ¨¡å‹ã€‚</p>
<p>TorchServeæ¡†æ¶ä¸»è¦åˆ†ä¸ºå››ä¸ªéƒ¨åˆ†ï¼šFrontendæ˜¯TorchServeçš„è¯·æ±‚å’Œå“åº”çš„å¤„ç†éƒ¨åˆ†ï¼›WorkerProcess æŒ‡çš„æ˜¯ä¸€ç»„è¿è¡Œçš„æ¨¡å‹å®ä¾‹ï¼Œå¯ä»¥ç”±ç®¡ç†APIè®¾å®šè¿è¡Œçš„æ•°é‡ï¼›Model Storeæ˜¯æ¨¡å‹å­˜å‚¨åŠ è½½çš„åœ°æ–¹ï¼›Backendç”¨äºç®¡ç†Worker Processï¼Œå…·ä½“å¯å‚è€ƒä¸‹å›¾é‡Œã€‚</p>
<p><img src="/2022/06/06/Pytorch%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E6%95%99%E7%A8%8B-3-Mnist%E5%9B%BE%E5%83%8F%E5%88%86%E7%B1%BBTorchServe%E9%83%A8%E7%BD%B2/ts_frame.png" alt="ts_frame"></p>
<h2 id="ç¯å¢ƒå®‰è£…"><a href="#ç¯å¢ƒå®‰è£…" class="headerlink" title="ç¯å¢ƒå®‰è£…"></a>ç¯å¢ƒå®‰è£…</h2><p>æœ¬äººä½¿ç”¨ Windows11+WSL2+Ubuntu ç¯å¢ƒè¿›è¡Œéƒ¨ç½²ã€‚</p>
<h3 id="Condaé…ç½®"><a href="#Condaé…ç½®" class="headerlink" title="Condaé…ç½®"></a>Condaé…ç½®</h3><p><a class="link" target="_blank" rel="noopener" href="https://github.com/pytorch/serve">å®˜ç½‘è¦æ±‚<i class="fas fa-external-link-alt"></i></a>ï¼šPython Version &gt;= 3.8ï¼Œæœ¬æ–‡ä½¿ç”¨Condaç®¡ç†æ·±åº¦å­¦ä¹ ç¯å¢ƒï¼Œå…·ä½“ä½¿ç”¨å¯å‚è€ƒä¹‹å‰çš„åšæ–‡ï¼š<a href="https://yqstar.github.io/2022/05/01/Windows%E7%B3%BB%E7%BB%9F%E4%BD%BF%E7%94%A8Conda%E9%85%8D%E7%BD%AE%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E7%8E%AF%E5%A2%83/">æ·±åº¦å­¦ä¹ ç®¡ç†é…ç½®</a>ã€‚</p>
<p><img src="/2022/06/06/Pytorch%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E6%95%99%E7%A8%8B-3-Mnist%E5%9B%BE%E5%83%8F%E5%88%86%E7%B1%BBTorchServe%E9%83%A8%E7%BD%B2/python_version.png" alt="python_version"></p>
<p>å¯ä½¿ç”¨ä¸‹è¿°å‘½ä»¤åˆ›å»ºCondaçš„Pythonç¯å¢ƒï¼ˆpythonç‰ˆæœ¬ä¸º3.8ï¼Œç¯å¢ƒåä¸ºts_ENVï¼‰å’Œæ¿€æ´»æŒ‡å®šç¯å¢ƒ(ts_env)ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">conda create --name ts_env python=3.8</span><br><span class="line">conda activate ts_env</span><br></pre></td></tr></table></figure>
<h3 id="TSæºç å®‰è£…"><a href="#TSæºç å®‰è£…" class="headerlink" title="TSæºç å®‰è£…"></a>TSæºç å®‰è£…</h3><p>å¯å‚è€ƒå®˜ç½‘TSå®‰è£…<a class="link" target="_blank" rel="noopener" href="https://pytorch.org/serve/torchserve_on_wsl.html">æ–‡æ¡£<i class="fas fa-external-link-alt"></i></a>ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/pytorch/serve.git</span><br><span class="line"><span class="built_in">cd</span> serve</span><br><span class="line"></span><br><span class="line">./ts_scripts/setup_wsl_ubuntu</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$HOME</span>/.local/bin:<span class="variable">$PATH</span></span><br><span class="line">python ./ts_scripts/install_from_src.py</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;export PATH=$HOME/.local/bin:$PATH&#x27;</span> &gt;&gt; ~/.bashrc</span><br><span class="line"><span class="built_in">source</span> ~/.bashrc</span><br></pre></td></tr></table></figure>
<h2 id="æ¨¡å‹æ‰“åŒ…"><a href="#æ¨¡å‹æ‰“åŒ…" class="headerlink" title="æ¨¡å‹æ‰“åŒ…"></a>æ¨¡å‹æ‰“åŒ…</h2><p>TorchServe çš„ä¸€ä¸ªå…³é”®ç‰¹æ€§æ˜¯èƒ½å¤Ÿå°†æ‰€æœ‰æ¨¡å‹å·¥ä»¶æ‰“åŒ…åˆ°å•ä¸ªæ¨¡å‹å­˜æ¡£æ–‡ä»¶ä¸­ã€‚å®ƒæ˜¯ä¸€ä¸ªå•ç‹¬çš„å‘½ä»¤è¡Œç•Œé¢ (CLI)ï¼Œtorch-model-archiverï¼Œå¯ä»¥ä½¿ç”¨ state_dict è·å–æ¨¡å‹æ£€æŸ¥ç‚¹æˆ–æ¨¡å‹å®šä¹‰æ–‡ä»¶ï¼Œå¹¶å°†å®ƒä»¬æ‰“åŒ…æˆ .mar æ–‡ä»¶ã€‚ ç„¶åï¼Œä»»ä½•ä½¿ç”¨ TorchServe çš„äººéƒ½å¯ä»¥é‡æ–°åˆ†å‘å’Œæä¾›è¯¥æ–‡ä»¶ã€‚å®ƒåŒ…å«ä»¥ä¸‹æ¨¡å‹å·¥ä»¶ï¼šåœ¨ torchscript æˆ–æ¨¡å‹å®šä¹‰æ–‡ä»¶çš„æƒ…å†µä¸‹çš„æ¨¡å‹æ£€æŸ¥ç‚¹æ–‡ä»¶å’Œåœ¨æ€¥åˆ‡æ¨¡å¼çš„æƒ…å†µä¸‹çš„ state_dict æ–‡ä»¶ï¼Œä»¥åŠæœåŠ¡æ¨¡å‹å¯èƒ½éœ€è¦çš„å…¶ä»–å¯é€‰èµ„äº§ã€‚ CLI åˆ›å»ºä¸€ä¸ª .mar æ–‡ä»¶ï¼ŒTorchServe çš„æœåŠ¡å™¨ CLI ä½¿ç”¨è¯¥æ–‡ä»¶ä¸ºæ¨¡å‹æä¾›æœåŠ¡ã€‚</p>
<p>torch-model-archiver å‘½ä»¤æ¥æ‰“åŒ…æ¨¡å‹ï¼Œéœ€è¦æä¾›ä»¥ä¸‹ä¸‰ä¸ªæ–‡ä»¶ã€‚</p>
<p>ç¬¬ 1 æ­¥ï¼šåˆ›å»ºä¸€ä¸ªæ–°çš„æ¨¡å‹æ¶æ„æ–‡ä»¶ï¼Œå…¶ä¸­åŒ…å«ä» torch.nn.modules æ‰©å±•çš„æ¨¡å‹ç±»ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†mnistæ¨¡å‹æ–‡ä»¶mnist_model.pyæ–‡ä»¶ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">from</span> torch <span class="keyword">import</span> nn</span><br><span class="line"><span class="keyword">import</span> torch.nn.functional <span class="keyword">as</span> F</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ„å»ºç½‘ç»œ</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MnistClassificationNet</span>(nn.Module):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">super</span>().__init__()</span><br><span class="line">        self.conv1 = nn.Conv2d(in_channels=<span class="number">1</span>, out_channels=<span class="number">32</span>, kernel_size=<span class="number">3</span>)</span><br><span class="line">        self.conv2 = nn.Conv2d(in_channels=<span class="number">32</span>, out_channels=<span class="number">64</span>, kernel_size=<span class="number">3</span>)</span><br><span class="line">        self.max_pool2d = nn.MaxPool2d(kernel_size=<span class="number">2</span>)</span><br><span class="line">        self.dropout = nn.Dropout2d(p=<span class="number">0.25</span>)</span><br><span class="line">        <span class="comment"># self.relu = nn.ReLU()</span></span><br><span class="line">        self.fc1 = nn.Linear(in_features=<span class="number">9216</span>, out_features=<span class="number">128</span>)</span><br><span class="line">        self.fc2 = nn.Linear(in_features=<span class="number">128</span>, out_features=<span class="number">10</span>)</span><br><span class="line">        self.log_softmax = nn.LogSoftmax(dim=<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, x</span>):</span><br><span class="line">        x = self.conv1(x)</span><br><span class="line">        x = F.relu(x)</span><br><span class="line">        x = self.conv2(x)</span><br><span class="line">        x = F.relu(x)</span><br><span class="line">        x= self.max_pool2d(x)</span><br><span class="line">        x = self.dropout(x)</span><br><span class="line">        x = x.view(-<span class="number">1</span>, <span class="number">9216</span>)</span><br><span class="line">        x = self.fc1(x)</span><br><span class="line">        x = F.relu(x)</span><br><span class="line">        x = self.fc2(x)</span><br><span class="line">        x= self.log_softmax(x)</span><br><span class="line">        <span class="keyword">return</span> x</span><br></pre></td></tr></table></figure>
<p>ç¬¬ 2 æ­¥ï¼šä½¿ç”¨ <a href="https://yqstar.github.io/2022/05/11/Pytorchç³»åˆ—è‡ªå­¦æ•™ç¨‹-2-æ·±åº¦å­¦ä¹ â€œHello-Worldâ€ä¹‹Mnistå›¾åƒåˆ†ç±»/">mnist_sd</a> è®­ç»ƒ MNIST æ•°å­—è¯†åˆ«æ¨¡å‹å¹¶ä¿å­˜æ¨¡å‹çš„çŠ¶æ€å­—å…¸ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">torch.save(model.state_dict(), <span class="string">&quot;./checkpoints/model_pth/mnist_sd.pt&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>ç¬¬ 3 æ­¥ï¼šç¼–å†™è‡ªå®šä¹‰å¤„ç†ç¨‹åºä»¥åœ¨æ‚¨çš„æ¨¡å‹ä¸Šè¿è¡Œæ¨ç†ã€‚ åœ¨æ­¤ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬æ·»åŠ äº†ä¸€ä¸ª mnist_handler.py æ–‡ä»¶ï¼Œå®ƒä½¿ç”¨ä¸Šè¿°æ¨¡å‹å¯¹è¾“å…¥ç°åº¦å›¾åƒè¿›è¡Œæ¨ç†å¹¶è¯†åˆ«å›¾åƒä¸­çš„æ•°å­—ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> torchvision <span class="keyword">import</span> transforms</span><br><span class="line"><span class="keyword">from</span> ts.torch_handler.image_classifier <span class="keyword">import</span> ImageClassifier</span><br><span class="line"><span class="keyword">from</span> torch.profiler <span class="keyword">import</span> ProfilerActivity</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MNISTDigitClassifier</span>(<span class="title class_ inherited__">ImageClassifier</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    MNISTDigitClassifier handler class. This handler extends class ImageClassifier from image_classifier.py, a</span></span><br><span class="line"><span class="string">    default handler. This handler takes an image and returns the number in that image.</span></span><br><span class="line"><span class="string">    Here method postprocess() has been overridden while others are reused from parent class.</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    image_processing = transforms.Compose([</span><br><span class="line">        transforms.ToTensor()</span><br><span class="line">        <span class="comment"># transforms.Normalize((0.1307,), (0.3081,))</span></span><br><span class="line">    ])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">super</span>(MNISTDigitClassifier, self).__init__()</span><br><span class="line">        self.profiler_args = &#123;</span><br><span class="line">            <span class="string">&quot;activities&quot;</span> : [ProfilerActivity.CPU],</span><br><span class="line">            <span class="string">&quot;record_shapes&quot;</span>: <span class="literal">True</span>,</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">postprocess</span>(<span class="params">self, data</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;The post process of MNIST converts the predicted output response to a label.</span></span><br><span class="line"><span class="string">        Args:</span></span><br><span class="line"><span class="string">            data (list): The predicted output from the Inference with probabilities is passed</span></span><br><span class="line"><span class="string">            to the post-process function</span></span><br><span class="line"><span class="string">        Returns:</span></span><br><span class="line"><span class="string">            list : A list of dictionaries with predictions and explanations is returned</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">return</span> data.argmax(<span class="number">1</span>).tolist()</span><br><span class="line">        <span class="comment"># return data.tolist()</span></span><br></pre></td></tr></table></figure>
<p>ç¬¬ 4 æ­¥ï¼šä½¿ç”¨ torch-model-archiver ç¨‹åºåˆ›å»ºä¸€ä¸ª Torch æ¨¡å‹å­˜æ¡£ä»¥å­˜æ¡£ä¸Šè¿°æ–‡ä»¶ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">$ torch-model-archiver -h</span><br><span class="line">usage: torch-model-archiver [-h] --model-name MODEL_NAME  --version MODEL_VERSION_NUMBER</span><br><span class="line">                      --model-file MODEL_FILE_PATH --serialized-file MODEL_SERIALIZED_PATH</span><br><span class="line">                      --handler HANDLER [--runtime &#123;python,python2,python3&#125;]</span><br><span class="line">                      [--export-path EXPORT_PATH] [-f] [--requirements-file]</span><br><span class="line"></span><br><span class="line">Model Archiver Tool</span><br><span class="line"></span><br><span class="line">optional arguments:</span><br><span class="line">  -h, --<span class="built_in">help</span>            show this <span class="built_in">help</span> message and <span class="built_in">exit</span></span><br><span class="line">  --model-name MODEL_NAME</span><br><span class="line">                        Exported model name. Exported file will be named as</span><br><span class="line">                        model-name.mar and saved <span class="keyword">in</span> current working directory</span><br><span class="line">                        <span class="keyword">if</span> no --export-path is specified, <span class="keyword">else</span> it will be</span><br><span class="line">                        saved under the <span class="built_in">export</span> path</span><br><span class="line">  --serialized-file SERIALIZED_FILE</span><br><span class="line">                        Path to .pt or .pth file containing state_dict <span class="keyword">in</span></span><br><span class="line">                        <span class="keyword">case</span> of eager mode or an executable ScriptModule</span><br><span class="line">                        <span class="keyword">in</span> <span class="keyword">case</span> of TorchScript.</span><br><span class="line">  --model-file MODEL_FILE</span><br><span class="line">                        Path to python file containing model architecture.</span><br><span class="line">                        This parameter is mandatory <span class="keyword">for</span> eager mode models.</span><br><span class="line">                        The model architecture file must contain only one</span><br><span class="line">                        class definition extended from torch.nn.modules.</span><br><span class="line">  --handler HANDLER     TorchServe<span class="string">&#x27;s default handler name  or handler python</span></span><br><span class="line"><span class="string">                        file path to handle custom TorchServe inference logic.</span></span><br><span class="line"><span class="string">  --extra-files EXTRA_FILES</span></span><br><span class="line"><span class="string">                        Comma separated path to extra dependency files.</span></span><br><span class="line"><span class="string">  --runtime &#123;python,python2,python3&#125;</span></span><br><span class="line"><span class="string">                        The runtime specifies which language to run your</span></span><br><span class="line"><span class="string">                        inference code on. The default runtime is</span></span><br><span class="line"><span class="string">                        RuntimeType.PYTHON. At the present moment we support</span></span><br><span class="line"><span class="string">                        the following runtimes python, python2, python3</span></span><br><span class="line"><span class="string">  --export-path EXPORT_PATH</span></span><br><span class="line"><span class="string">                        Path where the exported .mar file will be saved. This</span></span><br><span class="line"><span class="string">                        is an optional parameter. If --export-path is not</span></span><br><span class="line"><span class="string">                        specified, the file will be saved in the current</span></span><br><span class="line"><span class="string">                        working directory.</span></span><br><span class="line"><span class="string">  --archive-format &#123;tgz,default&#125;</span></span><br><span class="line"><span class="string">                        The format in which the model artifacts are archived.</span></span><br><span class="line"><span class="string">                        &quot;tgz&quot;: This creates the model-archive in &lt;model-name&gt;.tar.gz format.</span></span><br><span class="line"><span class="string">                        If platform hosting requires model-artifacts to be in &quot;.tar.gz&quot;</span></span><br><span class="line"><span class="string">                        use this option.</span></span><br><span class="line"><span class="string">                        &quot;no-archive&quot;: This option creates an non-archived version of model artifacts</span></span><br><span class="line"><span class="string">                        at &quot;export-path/&#123;model-name&#125;&quot; location. As a result of this choice,</span></span><br><span class="line"><span class="string">                        MANIFEST file will be created at &quot;export-path/&#123;model-name&#125;&quot; location</span></span><br><span class="line"><span class="string">                        without archiving these model files</span></span><br><span class="line"><span class="string">                        &quot;default&quot;: This creates the model-archive in &lt;model-name&gt;.mar format.</span></span><br><span class="line"><span class="string">                        This is the default archiving format. Models archived in this format</span></span><br><span class="line"><span class="string">                        will be readily hostable on TorchServe.</span></span><br><span class="line"><span class="string">  -f, --force           When the -f or --force flag is specified, an existing</span></span><br><span class="line"><span class="string">                        .mar file with same name as that provided in --model-</span></span><br><span class="line"><span class="string">                        name in the path specified by --export-path will</span></span><br><span class="line"><span class="string">                        overwritten</span></span><br><span class="line"><span class="string">  -v, --version         Model&#x27;</span>s version.</span><br><span class="line">  -r, --requirements-file</span><br><span class="line">                        Path to requirements.txt file containing a list of model specific python</span><br><span class="line">                        packages to be installed by TorchServe <span class="keyword">for</span> seamless model serving.</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">torch-model-archiver --model-name mnist --version 1.0 --model-file mnist_model.py --serialized-file mnist_sd.pt --export-path ./model_store --handler mnist_handler.py -f</span><br></pre></td></tr></table></figure>
<h2 id="æ¨¡å‹éƒ¨ç½²"><a href="#æ¨¡å‹éƒ¨ç½²" class="headerlink" title="æ¨¡å‹éƒ¨ç½²"></a>æ¨¡å‹éƒ¨ç½²</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">$ torchserve --<span class="built_in">help</span></span><br><span class="line">usage: torchserve [-h] [-v | --version]</span><br><span class="line">                          [--start]</span><br><span class="line">                          [--stop]</span><br><span class="line">                          [--ts-config TS_CONFIG]</span><br><span class="line">                          [--model-store MODEL_STORE]</span><br><span class="line">                          [--workflow-store WORKFLOW_STORE]</span><br><span class="line">                          [--models MODEL_PATH1 MODEL_NAME=MODEL_PATH2... [MODEL_PATH1 MODEL_NAME=MODEL_PATH2... ...]]</span><br><span class="line">                          [--log-config LOG_CONFIG]</span><br><span class="line"></span><br><span class="line">torchserve</span><br><span class="line"></span><br><span class="line">mandatory arguments:</span><br><span class="line">  --model-store MODEL_STORE</span><br><span class="line">                        Model store location <span class="built_in">where</span> models can be loaded</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">optional arguments:</span><br><span class="line">  -h, --<span class="built_in">help</span>            show this <span class="built_in">help</span> message and <span class="built_in">exit</span></span><br><span class="line">  -v, --version         Return TorchServe Version</span><br><span class="line">  --start               Start the model-server</span><br><span class="line">  --stop                Stop the model-server</span><br><span class="line">  --ts-config TS_CONFIG</span><br><span class="line">                        Configuration file <span class="keyword">for</span> TorchServe</span><br><span class="line"></span><br><span class="line">  --models MODEL_PATH1 MODEL_NAME=MODEL_PATH2... [MODEL_PATH1 MODEL_NAME=MODEL_PATH2... ...]</span><br><span class="line">                        Models to be loaded using [model_name=]model_location</span><br><span class="line">                        format. Location can be a HTTP URL, a model archive</span><br><span class="line">                        file or directory contains model archive files <span class="keyword">in</span></span><br><span class="line">                        MODEL_STORE.</span><br><span class="line">  --log-config LOG_CONFIG</span><br><span class="line">                        Log4j configuration file <span class="keyword">for</span> TorchServe</span><br><span class="line">  --ncs, --no-config-snapshots         </span><br><span class="line">                        Disable snapshot feature</span><br><span class="line">  --workflow-store WORKFLOW_STORE</span><br><span class="line">                        Workflow store location <span class="built_in">where</span> workflow can be loaded. Defaults to model-store</span><br></pre></td></tr></table></figure>
<h3 id="å¯åŠ¨torchserveæœåŠ¡"><a href="#å¯åŠ¨torchserveæœåŠ¡" class="headerlink" title="å¯åŠ¨torchserveæœåŠ¡"></a>å¯åŠ¨torchserveæœåŠ¡</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">torchserve --start --ncs --model-store model_store --models mnist.mar</span><br></pre></td></tr></table></figure>
<p>æ¨¡å‹å¯åŠ¨æ—¥å¿—å¦‚ä¸‹æˆªå›¾ï¼š</p>
<p><img src="/2022/06/06/Pytorch%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E6%95%99%E7%A8%8B-3-Mnist%E5%9B%BE%E5%83%8F%E5%88%86%E7%B1%BBTorchServe%E9%83%A8%E7%BD%B2/ts_start.png" alt="ts_start"></p>
<h3 id="æ¨ç†å¥åº·æ£€æŸ¥API"><a href="#æ¨ç†å¥åº·æ£€æŸ¥API" class="headerlink" title="æ¨ç†å¥åº·æ£€æŸ¥API"></a>æ¨ç†å¥åº·æ£€æŸ¥API</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl http://localhost:8080/ping</span><br></pre></td></tr></table></figure>
<p>å¦‚æœserveræ­£å¸¸è¿è¡Œ, å“åº”ä¼šå¦‚æˆªå›¾æ‰€ç¤ºï¼š</p>
<p><img src="/2022/06/06/Pytorch%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E6%95%99%E7%A8%8B-3-Mnist%E5%9B%BE%E5%83%8F%E5%88%86%E7%B1%BBTorchServe%E9%83%A8%E7%BD%B2/ts_ping.png" alt="ts_ping"></p>
<h3 id="æ¨ç†"><a href="#æ¨ç†" class="headerlink" title="æ¨ç†"></a>æ¨ç†</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl http://127.0.0.1:8080/predictions/mnist -T ./data/test.png</span><br></pre></td></tr></table></figure>
<p>test.pngä¸ºæ•°å­—ä¸º0çš„å›¾ç‰‡ï¼Œé€šè¿‡ä¸Šè¿°çš„è°ƒç”¨æ¨ç†ï¼Œå¯ä»¥çœ‹å‡ºç»“æœæ˜¯èƒ½æ­£å¸¸è¿”å›çš„ï¼Œæ˜¯å¯ä»¥ä½œä¸ºä¸‹æ¸¸åº”ç”¨è°ƒç”¨ã€‚</p>
<p><img src="/2022/06/06/Pytorch%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E6%95%99%E7%A8%8B-3-Mnist%E5%9B%BE%E5%83%8F%E5%88%86%E7%B1%BBTorchServe%E9%83%A8%E7%BD%B2/ts_infer.png" alt="ts_infer"></p>
<h3 id="åœæ­¢torchserveæœåŠ¡"><a href="#åœæ­¢torchserveæœåŠ¡" class="headerlink" title="åœæ­¢torchserveæœåŠ¡"></a>åœæ­¢torchserveæœåŠ¡</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">torchserve --start</span><br></pre></td></tr></table></figure>
<h2 id="æ¢ç´¢"><a href="#æ¢ç´¢" class="headerlink" title="æ¢ç´¢"></a>æ¢ç´¢</h2><p><a class="link" target="_blank" rel="noopener" href="https://github.com/yqstar/Awesome_Pytorch_Tutorial/tree/master/Pytorch_Lesson3">å®Œæ•´ä»£ç <i class="fas fa-external-link-alt"></i></a>å·²ä¸Šä¼ Githubï¼Œæœ‰éœ€è¦çš„å¯ä»¥è‡ªè¡Œä¸‹è½½ä»£ç ï¼Œå¦‚æœå¯¹ä½ æœ‰å¸®åŠ©ï¼Œè¯·Starï¼Œå“ˆå“ˆå“ˆå“ˆï¼</p>
<p>åˆ°æ­¤ä¸ºæ­¢ï¼Œå·²ç»å¯ä»¥ä½¿ç”¨è‡ªå·±æ•°æ®ç©è€å„ç§Demoï¼Œå¿«ï¼ˆè‹¦ï¼‰ä¹ï¼ˆé€¼ï¼‰åœ°è¿›è¡Œç‚¼ä¸¹ä¹‹è·¯ã€‚é“è·¯é˜»ä¸”é•¿ï¼Œè¡Œåˆ™å°†è‡³ï¼Œä½†è¡Œå¥½äº‹è«é—®å‰ç¨‹ã€‚</p>
<ul>
<li>é™¤äº†ä½¿ç”¨TorchServeéƒ¨ç½²æ¨¡å‹ï¼Œè¿˜æœ‰å…¶ä»–çš„è§£å†³æ–¹æ¡ˆå—ï¼Ÿ</li>
<li>é™¤äº†ä½¿ç”¨æä¾›è¿™ç§Web APIçš„å½¢å¼ï¼Œæ˜¯å¦å¯ä»¥æ„å»ºä¸€ä¸ªGUIçš„å½¢å¼æä¾›å‘¢ï¼Ÿä¾‹å¦‚ PYQT5 ï¼Ÿè¿™é‡Œæ”¾ä¸€å¼ PYQT5çš„å›¾ï¼Œåé¢ä¼šå¡«å‘ã€‚</li>
</ul>
<p><img src="/2022/06/06/Pytorch%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E6%95%99%E7%A8%8B-3-Mnist%E5%9B%BE%E5%83%8F%E5%88%86%E7%B1%BBTorchServe%E9%83%A8%E7%BD%B2/pyqt_demo.png" alt="pyqt_demo"></p>
<p>æ­£å¦‚ï¼Œäººå¾€å¾€ä¼šå¯¹æœªçŸ¥çš„äº‹æƒ…äº§ç”Ÿææƒ§ï¼Œå› ä¸ºç»“å±€æ˜¯æœªçŸ¥çš„ã€‚æ‰€ä»¥å½“ä¸€åˆ‡ä¸å†æœªçŸ¥çš„æ—¶å€™ï¼Œé‚£ä¹ˆæ˜¯ä¸æ˜¯å°±ä¸ä¼šäº§ç”Ÿææƒ§å‘¢ï¼Ÿ</p>
<h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p>More info: <a class="link" target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/344364948">Chengluï¼šå¦‚ä½•éƒ¨ç½²PyTorchæ¨¡å‹<i class="fas fa-external-link-alt"></i></a><br>More info: <a class="link" target="_blank" rel="noopener" href="https://github.com/pytorch/serve">TorchServe<i class="fas fa-external-link-alt"></i></a><br>More info: <a class="link" target="_blank" rel="noopener" href="https://github.com/pytorch/serve/tree/master/examples/image_classifier/mnist">TorchServe_Mnist Example<i class="fas fa-external-link-alt"></i></a><br>More info: <a class="link" target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_41977938/article/details/122258595">éšä¾¿å†™ç‚¹ç¬”è®°<i class="fas fa-external-link-alt"></i></a><br>More info: <a class="link" target="_blank" rel="noopener" href="https://blog.csdn.net/Chris_zhangrx/article/details/117380516">PyTorch Eager mode and Script mode<i class="fas fa-external-link-alt"></i></a><br>More info: <a class="link" target="_blank" rel="noopener" href="https://cceyda.github.io/blog/huggingface/torchserve/streamlit/ner/2020/10/09/huggingface_streamlit_serve.html">Self-host your ğŸ¤—HuggingFace Transformer NER model with Torchserve + Streamlit<i class="fas fa-external-link-alt"></i></a><br>More info: <a class="link" target="_blank" rel="noopener" href="https://ceshiren.com/t/topic/20770">TorchServeæ­å»ºcodeBERTåˆ†ç±»æ¨¡å‹æœåŠ¡<i class="fas fa-external-link-alt"></i></a><br>More info: <a class="link" target="_blank" rel="noopener" href="https://blog.csdn.net/qq_15821487/article/details/122684773">torchserveræ¨¡å‹æœ¬åœ°éƒ¨ç½²å’Œdockeréƒ¨ç½²<i class="fas fa-external-link-alt"></i></a></p>

        </div>

        
            <div class="post-copyright-info">
                <div class="article-copyright-info-container">
    <ul>
        <li>æœ¬æ–‡æ ‡é¢˜ï¼šPytorchæ·±åº¦å­¦ä¹ æ•™ç¨‹(3):Mnistå›¾åƒåˆ†ç±»TorchServeéƒ¨ç½²</li>
        <li>æœ¬æ–‡ä½œè€…ï¼šAiLab123</li>
        <li>åˆ›å»ºæ—¶é—´ï¼š2022-06-06 18:05:23</li>
        <li>
            æœ¬æ–‡é“¾æ¥ï¼šhttps://yqstar.github.io/2022/06/06/Pytorchæ·±åº¦å­¦ä¹ æ•™ç¨‹-3-Mnistå›¾åƒåˆ†ç±»TorchServeéƒ¨ç½²/
        </li>
        <li>
            ç‰ˆæƒå£°æ˜ï¼šæœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a class="license" target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">BY-NC-SA</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼
        </li>
    </ul>
</div>

            </div>
        

        
            <ul class="post-tags-box">
                
                    <li class="tag-item">
                        <a href="/tags/Pytorch-Tutorial/">#Pytorch_Tutorial</a>&nbsp;
                    </li>
                
            </ul>
        

        
            <div class="article-nav">
                
                    <div class="article-prev">
                        <a class="prev"
                           rel="prev"
                           href="/2022/06/12/Pytorch%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E6%95%99%E7%A8%8B-4-%E5%BA%8F%E5%88%97%E6%A8%A1%E5%9E%8B/"
                        >
                            <span class="left arrow-icon flex-center">
                              <i class="fas fa-chevron-left"></i>
                            </span>
                            <span class="title flex-center">
                                <span class="post-nav-title-item">Pytorchæ·±åº¦å­¦ä¹ æ•™ç¨‹(4):åºåˆ—æ¨¡å‹</span>
                                <span class="post-nav-item">ä¸Šä¸€ç¯‡</span>
                            </span>
                        </a>
                    </div>
                
                
                    <div class="article-next">
                        <a class="next"
                           rel="next"
                           href="/2022/05/29/Pytorch%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E6%95%99%E7%A8%8B-2-%E2%80%9CHello-World%E2%80%9D%E4%B9%8BMnist%E5%9B%BE%E5%83%8F%E5%88%86%E7%B1%BB/"
                        >
                            <span class="title flex-center">
                                <span class="post-nav-title-item">Pytorchæ·±åº¦å­¦ä¹ æ•™ç¨‹(2):â€œHello Worldâ€ä¹‹Mnistå›¾åƒåˆ†ç±»</span>
                                <span class="post-nav-item">ä¸‹ä¸€ç¯‡</span>
                            </span>
                            <span class="right arrow-icon flex-center">
                              <i class="fas fa-chevron-right"></i>
                            </span>
                        </a>
                    </div>
                
            </div>
        

        
    </div>
</div>


                
            </div>

        </div>

        <div class="page-main-content-bottom">
            <footer class="footer">
    <div class="info-container">
        <div class="copyright-info info-item">
            &copy;
            
              <span>2020</span>
              -
            
            2022&nbsp;<i class="fas fa-heart icon-animate"></i>&nbsp;<a href="/">AiLab123</a>
        </div>
        
            <script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
            <div class="website-count info-item">
                
                    <span id="busuanzi_container_site_uv">
                        è®¿é—®äººæ•°&nbsp;<span id="busuanzi_value_site_uv"></span>&ensp;
                    </span>
                
                
                    <span id="busuanzi_container_site_pv">
                        æ€»è®¿é—®é‡&nbsp;<span id="busuanzi_value_site_pv"></span>
                    </span>
                
            </div>
        
        <div class="theme-info info-item">
            ç”± <a target="_blank" href="https://hexo.io">Hexo</a> é©±åŠ¨&nbsp;|&nbsp;ä¸»é¢˜&nbsp;<a class="theme-version" target="_blank" href="https://github.com/XPoet/hexo-theme-keep">Keep v3.4.5</a>
        </div>
        
        
    </div>
</footer>

        </div>
    </div>

    
        <div class="post-tools">
            <div class="post-tools-container">
    <ul class="tools-list">
        <!-- TOC aside toggle -->
        
            <li class="tools-item page-aside-toggle">
                <i class="fas fa-outdent"></i>
            </li>
        

        <!-- go comment -->
        
    </ul>
</div>

        </div>
    

    <div class="right-bottom-side-tools">
        <div class="side-tools-container">
    <ul class="side-tools-list">
        <li class="tools-item tool-font-adjust-plus flex-center">
            <i class="fas fa-search-plus"></i>
        </li>

        <li class="tools-item tool-font-adjust-minus flex-center">
            <i class="fas fa-search-minus"></i>
        </li>

        <li class="tools-item tool-expand-width flex-center">
            <i class="fas fa-arrows-alt-h"></i>
        </li>

        <li class="tools-item tool-dark-light-toggle flex-center">
            <i class="fas fa-moon"></i>
        </li>

        <!-- rss -->
        
            <li class="tools-item rss flex-center">
                <a class="flex-center"
                   href="/atom.xml"
                   target="_blank"
                >
                    <i class="fas fa-rss"></i>
                </a>
            </li>
        

        

        <li class="tools-item tool-scroll-to-bottom flex-center">
            <i class="fas fa-arrow-down"></i>
        </li>
    </ul>

    <ul class="exposed-tools-list">
        <li class="tools-item tool-toggle-show flex-center">
            <i class="fas fa-cog fa-spin"></i>
        </li>
        
            <li class="tools-item tool-scroll-to-top flex-center">
                <i class="arrow-up fas fa-arrow-up"></i>
                <span class="percent"></span>
            </li>
        
    </ul>
</div>

    </div>

    
        <aside class="page-aside">
            <div class="post-toc-wrap">
    <div class="post-toc">
        <ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AE%80%E4%BB%8B"><span class="nav-number">1.</span> <span class="nav-text">ç®€ä»‹</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#TorchServe%E7%AE%80%E4%BB%8B"><span class="nav-number">2.</span> <span class="nav-text">TorchServeç®€ä»‹</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%8E%AF%E5%A2%83%E5%AE%89%E8%A3%85"><span class="nav-number">3.</span> <span class="nav-text">ç¯å¢ƒå®‰è£…</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Conda%E9%85%8D%E7%BD%AE"><span class="nav-number">3.1.</span> <span class="nav-text">Condaé…ç½®</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#TS%E6%BA%90%E7%A0%81%E5%AE%89%E8%A3%85"><span class="nav-number">3.2.</span> <span class="nav-text">TSæºç å®‰è£…</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%A8%A1%E5%9E%8B%E6%89%93%E5%8C%85"><span class="nav-number">4.</span> <span class="nav-text">æ¨¡å‹æ‰“åŒ…</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%A8%A1%E5%9E%8B%E9%83%A8%E7%BD%B2"><span class="nav-number">5.</span> <span class="nav-text">æ¨¡å‹éƒ¨ç½²</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%90%AF%E5%8A%A8torchserve%E6%9C%8D%E5%8A%A1"><span class="nav-number">5.1.</span> <span class="nav-text">å¯åŠ¨torchserveæœåŠ¡</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8E%A8%E7%90%86%E5%81%A5%E5%BA%B7%E6%A3%80%E6%9F%A5API"><span class="nav-number">5.2.</span> <span class="nav-text">æ¨ç†å¥åº·æ£€æŸ¥API</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8E%A8%E7%90%86"><span class="nav-number">5.3.</span> <span class="nav-text">æ¨ç†</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%81%9C%E6%AD%A2torchserve%E6%9C%8D%E5%8A%A1"><span class="nav-number">5.4.</span> <span class="nav-text">åœæ­¢torchserveæœåŠ¡</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%8E%A2%E7%B4%A2"><span class="nav-number">6.</span> <span class="nav-text">æ¢ç´¢</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8F%82%E8%80%83"><span class="nav-number">7.</span> <span class="nav-text">å‚è€ƒ</span></a></li></ol>
    </div>
</div>
        </aside>
    

    <div class="image-viewer-container">
    <img src="">
</div>


    
        <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
          <span class="search-input-field-pre">
            <i class="fas fa-keyboard"></i>
          </span>
            <div class="search-input-container">
                <input autocomplete="off"
                       autocorrect="off"
                       autocapitalize="off"
                       placeholder="æœç´¢..."
                       spellcheck="false"
                       type="search"
                       class="search-input"
                >
            </div>
            <span class="popup-btn-close">
                <i class="fas fa-times"></i>
            </span>
        </div>
        <div id="search-result">
            <div id="no-result">
                <i class="fas fa-spinner fa-pulse fa-5x fa-fw"></i>
            </div>
        </div>
    </div>
</div>

    

</main>



<script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/utils.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/main.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/header-shrink.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/back2top.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/dark-light-toggle.js"></script>


    <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/local-search.js"></script>



    <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/code-copy.js"></script>




<div class="post-scripts pjax">
    
        <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/left-side-toggle.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/libs/anime.min.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/toc.js"></script>
    
</div>


    <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/libs/pjax.min.js"></script>
<script>
    window.addEventListener('DOMContentLoaded', () => {
        window.pjax = new Pjax({
            selectors: [
                'head title',
                '.page-container',
                '.pjax'
            ],
            history: true,
            debug: false,
            cacheBust: false,
            timeout: 0,
            analytics: false,
            currentUrlFullReload: false,
            scrollRestoration: false,
            // scrollTo: true,
        });

        document.addEventListener('pjax:send', () => {
            KEEP.utils.pjaxProgressBarStart();
        });

        document.addEventListener('pjax:complete', () => {
            KEEP.utils.pjaxProgressBarEnd();
            window.pjax.executeScripts(document.querySelectorAll('script[data-pjax], .pjax script'));
            KEEP.refresh();
        });
    });
</script>



</body>
</html>
